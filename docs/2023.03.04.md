# 今日调测

## 游戏内订单支付

游戏内记录订单 -> 携认证信息跳转钱包手动支付 -> 游戏通过链上数据同步确认订单发放货品 -> 携登录认证信息跳回游戏确认收到货品

注：支付通过附言交易发送，便于监控、事后统计分析

## 游戏内掉落Gas

游戏内掉落Gas奖励 -> 游戏发送交易上链 -> 跳转钱包发现钱包余额增加，可查看交易流水

注：奖励通过附言交易发送，便于监控、事后统计分析

## 游戏内掉落NFT

注：原有 prop.order 因零确认机制已废除而无法正常工作，改为通过 prop.send 发送事先铸造的NFT

1. 通过 prop.query "[['cid','CordOfChickIOS']]" 查询自己名下所有藏品，形成NFT内存表备用
2. 通过配置表按照某种规则掉落NFT, 然后通过 prop.send 发送到用户地址，同时更新NFT内存表

## NFT带入游戏

游戏通过特定的认证接口，根据用户区块链地址查询用户NFT列表。为确保隐私性，用户将为每一个游戏分配一个单独地址，集中存放该游戏相关的全部道具
游戏将用户的NFT列表映射到用户背包，如果用户将已经映射的NFT进行了转移，将会从背包中扣除。

## 游戏核销NFT

通过既有的核销流程进行。用户核销NFT后，将得到能和指定游戏对接的电子卡，用于在游戏中进行兑付。

## 其他

_ReceiveFriendRank 此处有报错

## 初期诉求

1. 用户在进入游戏前，就可以在钱包内查看游戏详情、商城道具列表等信息

鸡小德需要提供游戏详情图文，预先登记商城道具数字版权，铸造相关数字藏品，作为普通发售或众筹用途。普通发售的道具可直接在游戏中使用，众筹道具有一个核销并换取游戏道具的流程。

2. 用户可以在鸡小德内下单购买道具，然后回到钱包内支付。鸡小德有能力接收并处理订单支付通知

3. 钱包和鸡小德的交叉认证

钱包用户可以携带认证信息，直接登录游戏，但该认证信息不能携带敏感信息，如钱包登录令牌等
出于安全性考虑，鸡小德用户无法凭借游戏内认证直接登录钱包，只能携带必要信息(如GameId/InnerId)跳转钱包，再由钱包独立完成认证流程

4. 确权

用户进入游戏后，可以在背包中列表查看所拥有的、由鸡小德签发的上链道具，并可以在游戏内正常使用
如果要对这些道具进行熔铸、转让、拍卖处理，必须跳转回钱包操作
用户在钱包内对上述道具进行的各项处理，将在游戏内同步体现(最终一致性)，换个角度看，主网是消息发布者，游戏是消息订阅者
