var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ObjectBase=function(e){function t(){var t=e.call(this)||this;return t._time=0,ProcessManager.AddProcess(t._Process.bind(t)),t}return __extends(t,e),t.prototype.Trigger=function(e){void 0===e&&(e=null)},t.prototype.SkillTrigger=function(){if(UnitManager.CurrentRole.SkillStatus){var e=UnitManager.CurrentRole;return e.HandleAction({1:[new ActionObj_s(ActionEnum_s.Recover,e.ItemRecoverLife)]}),!1}return!0},t.prototype.Destroy=function(){},t.prototype.creatTip=function(e,t){CheckpointManager.CurrentCheckpoint.Isbubble&&(null==this._tip&&(this._tip=new MaoPaoTip,this.addChild(this._tip)),this._tip.setData(e,t),this._tip.IsVisibled=!0)},t.prototype.getMaoPaoTipMsg=function(e){var t=[],i=RES.getRes("eventtip_json");return Object.keys(i).map(function(e){t.push(i[e])}),StringMgr.GetText(t[e].desc)},t.prototype._Process=function(e){null!=this._tip&&(this._time+=e,this._time%5e3<=2500?this._tip.IsVisibled=!0:this._time%5e3>2500&&(this._tip.IsVisibled=!1))},t.prototype.removeTip=function(){if(this._tip){try{this._tip.parent.removeChild(this._tip)}catch(e){console.log(this._tip.parent,this._tip),console.log(e)}this._tip=null,this._time=0}},t}(egret.DisplayObjectContainer);__reflect(ObjectBase.prototype,"ObjectBase");var AWindow=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._UpdataText(),GameEvent.AddEventListener(EventType.LanguageChange,this._UpdataText,this)},t.prototype._UpdataText=function(){},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(AWindow.prototype,"AWindow");var TopPromptPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isMovie=!1,t._isCreated=!1,t.skinName="resource/game_skins/TopPromptPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),t._instance=this},t.prototype.ShowPrompt=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._resName=t,this._desText=e,null==t?(this.skin.currentState="noIma",this._noImaLabel.text=this._desText,this.Show(e,t)):(this.skin.currentState="haveIma",this._image.source=this._resName,this._haveImaLabel.text=this._desText,this.Show(e,t))},t.prototype.Show=function(e,t){return this._isMovie?void 0:this._isCreated?void(this.IsVisibled=!0):void(this.IsVisibled=!0)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._Movie()):(Main.Instance.WindowTopLayer.removeChild(this),this._isMovie=!1))},enumerable:!0,configurable:!0}),t.prototype._Movie=function(){this._isMovie=!0,egret.Tween.removeTweens(this),this.y=-this.height;var e=egret.Tween.get(this);e.to({y:0},500).call(this._Appear.bind(this))},t.prototype._Appear=function(){egret.Tween.removeTweens(this);var e=egret.Tween.get(this);e.wait(2e3).call(this._Hide.bind(this))},t.prototype._Hide=function(){egret.Tween.removeTweens(this);var e=egret.Tween.get(this);e.to({y:-this.height},500).call(this._HideEnd.bind(this))},t.prototype._HideEnd=function(){egret.Tween.removeTweens(this),this.IsVisibled=!1},t}(eui.Component);__reflect(TopPromptPage.prototype,"TopPromptPage");var Main=function(e){function t(){var t=e.apply(this,arguments)||this;return t._isResourceLoadEnd=!1,t._isThemeLoadEnd=!1,t._isInBackground=!1,t._isStartBattle=!1,t}return __extends(t,e),Object.defineProperty(t,"IsOfficialVersion",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsLocationDebug",{get:function(){return t.IsOfficialVersion?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNeedDebugLog",{get:function(){return t.IsOfficialVersion?!1:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNeedNetDebug",{get:function(){return t.IsOfficialVersion||!t.IsLocationDebug?!0:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsPlayMusic",{get:function(){return t.IsOfficialVersion?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsUseCDN",{get:function(){return t.IsOfficialVersion?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.ImageLoader.crossOrigin="anonymous",RES.setMaxLoadingThread(8),this._gameLayer=new egret.DisplayObjectContainer,this._windowBottomLayer=new egret.DisplayObjectContainer,this._windowBottomLayer.width=640,this._windowBottomLayer.height=1136,this._windowTopLayer=new egret.DisplayObjectContainer,this._windowTopLayer.width=640,this._windowTopLayer.height=1136,t._topLayer=new egret.DisplayObjectContainer,t._topLayer.width=640,t._topLayer.height=1136,this._debugLayer=new egret.DisplayObjectContainer,this._debugLayer.touchEnabled=!1,this._debugLayer.touchChildren=!1,this.stage.addChild(this._gameLayer),this.stage.addChild(this._windowTopLayer),this.stage.addChild(t._topLayer),this.stage.addChild(this._debugLayer),this._InitDebug();var i=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this._OnConfigComplete,this),RES.loadConfig(t.CDNURL+"resource/default.res.json",t.CDNURL+"resource/"),this._AddFunction(),this._LoadGonggao()},Object.defineProperty(t,"GonggaoJson",{get:function(){return t._gonggaoJson},enumerable:!0,configurable:!0}),t.prototype._AddFunction=function(){Array.prototype.random=function(){return 0==this.length?null:1==this.length?this[0]:this[Math.random()*this.length|0]}},t.prototype._OnConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this._OnConfigComplete,this);var i=new eui.Theme(t.CDNURL+"resource/default.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this._OnThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._OnResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this._OnResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this._OnItemLoadError,this),RES.loadGroup("loading")},t.prototype._OnThemeLoadComplete=function(){this._isThemeLoadEnd=!0,this._CreateScene()},t.prototype._OnResourceLoadComplete=function(e){"loading"==e.groupName&&(StringMgr.Language=StringMgr.CN,this._loadingView=new LoadingUI,this._gameLayer.addChild(this._loadingView),RES.loadGroup("config")),"config"==e.groupName?(RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this._OnResourceProgress,this),RES.loadGroup("gameloading")):"gameloading"==e.groupName?(this._isResourceLoadEnd=!0,RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this._OnResourceProgress,this),this._CreateScene()):"game"==e.groupName&&(t.GameResLoad=!0,RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._OnResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this._OnResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this._OnItemLoadError,this),this._isStartBattle&&(null!=WindowManager.WaitPage()&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1),this.StarBattle()))},t.prototype._OnItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype._OnResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this._OnResourceLoadComplete(e)},t.prototype._OnResourceProgress=function(e){"gameloading"==e.groupName&&this._loadingView.SetProgress(e.itemsLoaded,e.itemsTotal)},t.prototype._LoadGonggao=function(){this._isThemeLoadEnd&&this._isResourceLoadEnd&&this._CheckWeihu()},t.prototype._loadGonggaoEnd=function(e){var i=JSON.parse(e.target.data);t._gonggaoJson=i,this._isThemeLoadEnd&&this._isResourceLoadEnd&&this._CheckWeihu()},t.prototype._CheckWeihu=function(){if(null!=t._gonggaoJson){var e=t._gonggaoJson.fuwuqiweihu;if(e.isshow)return void PromptManager.ShowWeihu()}this.StartCreateScene()},t.prototype._CreateScene=function(){this._isThemeLoadEnd&&this._isResourceLoadEnd&&(t._instance=this,LoginMgr.Login(this._CheckWeihu.bind(this)))},t.prototype.StartCreateScene=function(){if(LoginMgr.LoginSuccess&&this._isResourceLoadEnd&&!t.IsCreated){t.IsCreated=!0,SkillManager.Init(),UnitManager.Init(),ItemManager.Init(),CheckpointManager.Init(),AchievementManager.Init(),IntegralManager.Init(),MapManager.Init(),SoundManager.PlayBackgroundMusic(),ProcessManager.Init(),this._loadingView.Destroy(),this._gameLayer.removeChild(this._loadingView);var e=ImagePool.GetImage("tongyong_di_jpg");this._windowBottomLayer.addChild(e),WindowManager.StarWindow().IsVisibled=!0,RollingNoticeManager.Init(),ProcessManager.AddProcess(this._Process.bind(this))}},t.prototype.StarBattle=function(){return this._isStartBattle=!0,t.GameResLoad?(null==this._game?this._game=new Game:(WindowManager.EndWindow()&&WindowManager.EndWindow().IsVisibled&&(WindowManager.EndWindow().IsVisibled=!1),this._game.StarBattle()),void this.GameLayer.addChild(this._game)):(ResReadyMgr.IsReady("game"),void(WindowManager.WaitPage().IsVisibled=!0))},t.prototype.BattleEnd=function(){null!=this._game&&this.GameLayer.contains(this._game)&&this.GameLayer.removeChild(this._game),ResReadyMgr.LoadGroup()},t.prototype._Process=function(e){var t=!1;this._isInBackground!=t&&(this._isInBackground=t,t?SoundManager.YinYue=!1:SoundManager.YinYue=WindowManager.StarWindow().MusicStatus)},Object.defineProperty(t.prototype,"IsResourceLoadEnd",{get:function(){return this._isResourceLoadEnd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GameLayer",{get:function(){return this._gameLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WindowBottomLayer",{get:function(){return this._windowBottomLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WindowTopLayer",{get:function(){return this._windowTopLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TopLayer",{get:function(){return t._topLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DebugLayer",{get:function(){return this._debugLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MainTopLayer",{get:function(){return t._topLayer},enumerable:!0,configurable:!0}),t.prototype._InitDebug=function(){t.IsNeedDebugLog&&(t._debugStr="",t._debugText=new egret.TextField,t._debugText.width=640,t._debugText.height=1136,t._debugText.textColor=0,t._debugText.touchEnabled=!1,t._debugText.stroke=1,t._debugText.strokeColor=16777215,t._debugText.bold=!0,t._debugText.fontFamily="微软雅黑",this._debugLayer.addChild(t._debugText),t.AddDebug("Debug文本初始化完成:"+t.AppVersion))},t.AddDebug=function(e){console.log(e),t.IsNeedDebugLog&&(t._debugStr+=e+"\n",t._debugText.text=t._debugStr,t._debugText.scrollV=Math.max(t._debugText.numLines-37,1))},t}(eui.UILayer);Main.AppVersion="2.5.0",Main.ResVersion="2.5.7",Main.CDNURL=Main.IsUseCDN?"https://jxdcdn.173kw.com/res"+Main.ResVersion+"/":"",Main.GameResLoad=!1,Main.IsCreated=!1,__reflect(Main.prototype,"Main");var AirBox=function(e){function t(){var t=e.call(this)||this;return t._image=new eui.Image("daoju_zhifeiji_png"),t.addChild(t._image),t._image.x=-27,t._image.y=-30,t.creatTip(t.getMaoPaoTipMsg(0),1),t._tip&&(t._tip.y=-20),t}return __extends(t,e),t.prototype.Trigger=function(t){try{this.parent.removeChild(this),this.removeTip()}catch(i){console.log(i)}var n=e.prototype.SkillTrigger.call(this);n&&t.ChangeStatus(2),ObjectPool.getPool("RandomChest").returnObject(this)},t.prototype.onInit=function(){return this},t.prototype.onReturn=function(){return this},t}(ObjectBase);__reflect(AirBox.prototype,"AirBox");var BombBox=function(e){function t(){var t=e.call(this)||this;return t._image=new eui.Image("daoju_dilei_png"),t.addChild(t._image),t._image.x=-25,t._image.y=-27,t.creatTip(t.getMaoPaoTipMsg(1),1),t._tip&&(t._tip.y=-20),t}return __extends(t,e),t.prototype.Trigger=function(t){try{this.parent.removeChild(this),this.removeTip()}catch(i){console.log(i)}var n=e.prototype.SkillTrigger.call(this);n&&t.ChangeStatus(3),ObjectPool.getPool("RandomChest").returnObject(this)},t.prototype.onInit=function(){return this},t.prototype.onReturn=function(){return this},t}(ObjectBase);__reflect(BombBox.prototype,"BombBox");var DynamicMap=function(e){function t(){var t=e.call(this)||this;return t._imageSet=[],t}return __extends(t,e),t.prototype.AddImage=function(e){this.addChild(e),this._imageSet.push(e)},t.prototype.RemoveMap=function(){if(null!=this.parent)try{this.parent.removeChild(this)}catch(e){console.log(e)}for(;this._imageSet.length>0;){var t=this._imageSet.shift();ImagePool.ReturnPool(t)}},Object.defineProperty(t.prototype,"MapData",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Difficulty",{get:function(){return this._difficulty},set:function(e){this._difficulty=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){for(var e=this._imageSet.length-1;e>0;e--){var t=this._imageSet[e];if(null==t.isheight)return t.y+t.height-8}return this._imageSet[this._imageSet.length-1].y+this._imageSet[this._imageSet.length-1].height-8},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"posiX",{get:function(){return this._imageSet[this._imageSet.length-1].x},enumerable:!0,configurable:!0}),t}(eui.Group);__reflect(DynamicMap.prototype,"DynamicMap");var Gold=function(e){function t(){var t=e.call(this)||this;return t._goldImage=new eui.Image("jinbi_png"),t._goldImage.x=-12,t._goldImage.y=-10,t.addChild(t._goldImage),t._movie=new egret.MovieClip,t._movie.movieClipData=MovieManager.GetMovieClipData("disappera_json","disappera_png","disappear"),t._movie.stop(),t}return __extends(t,e),t.prototype.Trigger=function(){Game.Instance.AddGoldNum(),this._Disappear()},t.prototype._Disappear=function(){this.addChild(this._movie);try{this.removeChild(this._goldImage)}catch(e){console.log(e)}this._movie.addEventListener(egret.Event.COMPLETE,this._MovieEnd,this),this._movie.gotoAndPlay(1,1),SoundManager.PlayGoldMusic()},t.prototype._MovieEnd=function(){try{this.parent.removeChild(this)}catch(e){console.log(e)}this._movie.removeEventListener(egret.Event.COMPLETE,this._MovieEnd,this),ObjectPool.getPool("Gold").returnObject(this)},t.prototype.onInit=function(){return this},t.prototype.onReturn=function(){this.addChild(this._goldImage);try{this.removeChild(this._movie)}catch(e){console.log(e)}return this},t}(ObjectBase);__reflect(Gold.prototype,"Gold");var LuckyChest=function(e){function t(){var t=e.call(this)||this;return t._image=new eui.Image("daoju_shengmingzq_png"),t.addChild(t._image),t._image.x=0,t._image.y=0,t.creatTip(t.getMaoPaoTipMsg(2),1),t._tip&&(t._tip.y=-20),t}return __extends(t,e),t.prototype.Trigger=function(t){try{this.parent.removeChild(this),this.removeTip()}catch(i){console.log(this.parent,this),console.log(i)}var n=e.prototype.SkillTrigger.call(this);n&&t.ChangeStatus(1),ObjectPool.getPool("LuckyChest").returnObject(this)},t.prototype.onInit=function(){return this},t.prototype.onReturn=function(){return this},Object.defineProperty(t.prototype,"Direction",{get:function(){return this.direction},set:function(e){this.direction=e,0==this.direction?(this._image.source="daoju_shengmingzq_png",this._image.x=-26,this._image.y=-35,this._image.scaleX=1):1==this.direction?(this._image.source="daoju_shengmingzq_png",this._image.x=-8,this._image.y=-45,this._image.scaleX=1):(this._image.source="daoju_shengmingzq_png",this._image.x=8,this._image.y=-45,this._image.scaleX=-1)},enumerable:!0,configurable:!0}),t}(ObjectBase);__reflect(LuckyChest.prototype,"LuckyChest");var Map=function(e){function t(t){var i=e.call(this)||this;return i._mapIma=t,i._jsonData=t.MapData,i.Height=t.Height,i}return __extends(t,e),Object.defineProperty(t.prototype,"jsonData",{get:function(){return this._jsonData},enumerable:!0,configurable:!0}),t.prototype.CreateMap=function(){this._movieSet=[],this._movieFramSet=[],this._roadSet=[],this._enterDoorSet=[],this._outDoorSet=[];for(var e=(this._jsonData.mapcount,this._jsonData.mapresname,this._jsonData.resheight,this._jsonData.roadcount),t=0;e>t;t++){var i=this._jsonData.road[t].roaddata;this._roadSet.push(new Road(i,this)),this._roadSet[t].ID=t}this._mapIma.x=0,this._mapIma.y=0,this._mapIma.cacheAsBitmap=!0,this.addChild(this._mapIma);for(var n=this._jsonData.house,t=0;t<n.length;t++){var a=ArmaturePool.GetMovieArmature(MapManager.SceneJsonData.house.res+"_json",MapManager.SceneJsonData.house.res+"_png",MapManager.SceneJsonData.house.res);a.play(-1);var r=n[t];a.x=r[0],a.y=r[1],this.addChild(a),this._movieFramSet.push(a)}for(var o=this._jsonData.balloon,t=0;t<o.length;t++){var s=ArmaturePool.GetMovieArmature(MapManager.SceneJsonData.balloon+"_json",MapManager.SceneJsonData.balloon+"_png",MapManager.SceneJsonData.balloon);s.play(-1);var r=o[t];s.x=r[0],s.y=r[1],this.addChild(s),this._movieFramSet.push(s)}},Object.defineProperty(t.prototype,"RoadCount",{get:function(){return this._roadSet.length},enumerable:!0,configurable:!0}),t.prototype.GetRoad=function(e){return e>=this._roadSet.length?null:this._roadSet[e]},t.prototype.Destroy=function(){if(this._mapIma.cacheAsBitmap=!1,this._mapIma.RemoveMap(),null!=this._enterDoorSet)for(var e=this._enterDoorSet.length-1;e>=0;e--){this._enterDoorSet[e].stop();var t=this._enterDoorSet[e].name;this._enterDoorSet[e].movieClipData=MovieManager.GetMovieClipData(t+"_idle_json",t+"_idle_png",t+"_idle"),ArmaturePool.ReturnMoviePool(this._enterDoorSet[e]),this._enterDoorSet.splice(e,1)}if(null!=this._outDoorSet)for(var i=this._outDoorSet.length-1;i>=0;i--){this._outDoorSet[i].stop();var t=this._outDoorSet[i].name;this._outDoorSet[i].movieClipData=MovieManager.GetMovieClipData(t+"_idle_json",t+"_idle_png",t+"_idle"),ArmaturePool.ReturnMoviePool(this._outDoorSet[i]),this._outDoorSet.splice(i,1)}if(null!=this._movieSet)for(var n=0;n<this._movieSet.length;n++)ArmaturePool.ReturnPool(this._movieSet[n]);if(null!=this._movieFramSet)for(var n=0;n<this._movieFramSet.length;n++)ArmaturePool.ReturnMoviePool(this._movieFramSet[n]);for(var a=0;a<this._roadSet.length;a++)this._roadSet[a].Destroy()},t.prototype.AddEnterDoor=function(e){null==this._enterDoorSet&&(this._enterDoorSet=[]),this._enterDoorSet.push(e)},t.prototype.AddOutDoor=function(e){null==this._outDoorSet&&(this._outDoorSet=[]),this._outDoorSet.push(e)},t.prototype.EnterDoorOpen=function(e){if(null!=this._enterDoorSet){for(var i=0;i<this._enterDoorSet.length;i++)if(this._enterDoorSet[i][t.DoorType]==e){var n=this._enterDoorSet[i].name;this._enterDoorSet[i].stop(),this._enterDoorSet[i].movieClipData=MovieManager.GetMovieClipData(n+"_open_json",n+"_open_png",n+"_open"),this._enterDoorSet[i].play(1)}SoundManager.PlayMusic(SoundManager.Door_Music)}},t.prototype.OutDoorOpen=function(e){if(null!=this._outDoorSet)for(var i=0;i<this._outDoorSet.length;i++)if(this._outDoorSet[i][t.DoorType]==e){var n=this._outDoorSet[i].name;this._outDoorSet[i].stop(),this._outDoorSet[i].movieClipData=MovieManager.GetMovieClipData(n+"_open_json",n+"_open_png",n+"_open"),this._outDoorSet[i].play(1)}},t.prototype.AddObject=function(e,t,i){for(var n=0;n<this._roadSet.length;n++)this._roadSet[n]!=i&&this._roadSet[n].GroupNum<=t&&this._roadSet[n].AddObject(e)},t.prototype.GoldSort=function(){for(var e=0;e<this._roadSet.length;e++)this._roadSet[e].GoldSort()},Object.defineProperty(t.prototype,"Height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);Map.DoorType="DOORTYPE",__reflect(Map.prototype,"Map");var MapManager=function(){function e(){}return e.Init=function(){e.SetSceneIndex(2001),ProcessManager.AddProcess(e._Process.bind(e))},e.SetSceneIndex=function(t){var i=RES.getRes("sceneRes_json");e.SceneJsonData=i[t]},e.GetMap=function(){var t=e._mapSet.shift(),i=null==CheckpointManager.CurrentCheckpoint?3:CheckpointManager.CurrentCheckpoint.Difficulty;return null==t&&(t=new Map(RoadManager.Inistence().ceateMapType(i,!1,this._ceshiMapNum[0],this._ceshiMapNum[1]))),t},e.creatAllMap=function(){if(CheckpointManager.IsEndless||CheckpointManager.IsDailyActive){Game._isInitMap=!1;for(var t=1;11>t;t++)e._CreatedMapByDifficulty(t,10,!0);return Game._isInitMap=!0,void(Game._isInitArm&&Game._isInitMap&&Game._isStarReturn&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1))}e._mapSet=[];for(var i=null==CheckpointManager.CurrentCheckpoint?3:CheckpointManager.CurrentCheckpoint.Difficulty,n=null==CheckpointManager.CurrentCheckpoint?20:Math.ceil(CheckpointManager.CurrentCheckpoint.PassTime/5),t=0;n>t;t++){var a=null;a=0==t?RoadManager.Inistence().ceateMapType(i,!0,this._ceshiMapNum[0],this._ceshiMapNum[1]):RoadManager.Inistence().ceateMapType(i,!1,this._ceshiMapNum[0],this._ceshiMapNum[1]);var r=new Map(a);e._mapSet.push(r)}Game._isInitMap=!0,Game._isInitArm&&Game._isInitMap&&Game._isStarReturn&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1)},e._Process=function(e){},e._CreatedMap=function(){e._firstMapDic=[],e._mapDictionary=[];for(var t=1;11>t;t++){for(var i=[],n=0;3>n;n++){var a=RoadManager.Inistence().ceateMapType(t,!0,this._ceshiMapNum[0],this._ceshiMapNum[1]),r=new Map(a);i.push(r)}e._firstMapDic[t]=i}for(var t=1;11>t;t++)e._CreatedMapByDifficulty(t,1,!1)},e._CreatedMapByDifficulty=function(t,i,n){for(var a=[],r=0;i>r;r++){var o=RoadManager.Inistence().ceateMapType(t,!1,this._ceshiMapNum[0],this._ceshiMapNum[1]),s=new Map(o);a.push(s)}e._mapDictionary[t]=a},e.GetNewMap=function(t,i){void 0===i&&(i=!1);var n=null;if(i)if(null==e._firstMapDic[t]||0==e._firstMapDic[t].length){var a=RoadManager.Inistence().ceateMapType(t,!0,this._ceshiMapNum[0],this._ceshiMapNum[1]);n=new Map(a)}else{var r=e._firstMapDic[t],o=Math.random()*r.length|0;n=r[o],r.splice(o,1)}else{(null==e._mapDictionary[t]||0==e._mapDictionary[t].length)&&e._CreatedMapByDifficulty(t,1,!0);var r=e._mapDictionary[t],o=Math.random()*r.length|0;n=r[o],r.splice(o,1)}return n},e}();MapManager.Horizontal=10,MapManager.Vertical=18,MapManager.RoadSize=60,MapManager.MapCount=13,MapManager.IsUpdateMap=!0,MapManager.SceneJsonData=null,MapManager._mapSet=[],MapManager._mapDictionary=[],MapManager._firstMapDic=[],MapManager._timer=0,MapManager._ceshiMapNum=[null,null],MapManager._mapNum=10,MapManager._huancenMapSet=[],__reflect(MapManager.prototype,"MapManager");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?n(a):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var RandomChest=function(e){function t(){var t=e.call(this)||this;return t._movie=new egret.MovieClip,t._movie.movieClipData=MovieManager.GetMovieClipData("randombox_json","randombox_png","box"),t._movie.x=0,t._movie.y=0,t.addChild(t._movie),t._movie.play(-1),t.creatTip(t.getMaoPaoTipMsg(3),1),t._tip&&(t._tip.y=-50),t}return __extends(t,e),t.prototype.Trigger=function(t){try{this.parent.removeChild(this),this.removeTip()}catch(i){console.log(i)}var n=e.prototype.SkillTrigger.call(this);n&&t.ChangeStatus(0),ObjectPool.getPool("RandomChest").returnObject(this)},t.prototype.onInit=function(){return this._movie.play(-1),this},t.prototype.onReturn=function(){return this._movie.stop(),this},Object.defineProperty(t.prototype,"Direction",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),t}(ObjectBase);__reflect(RandomChest.prototype,"RandomChest");var Road=function(){function e(e,t){this._isCreate=!1,this._map=t,this._roadSet=[],this._typeSet=[],this._groupSet=[],this._doorTypeSet=[],this._groupNum=e.type;for(var i=e.data,n=0;n<i.length;n++){var a=new egret.Point(i[n][0],i[n][1]),r=i[n][2],o=i[n][3],s=i[n][4];this._roadSet.push(a),this._typeSet.push(r),this._groupSet.push(o),this._doorTypeSet.push(s)}}return Object.defineProperty(e.prototype,"MoveRoad",{get:function(){return this._roadSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RoadType",{get:function(){return this._typeSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GroupSet",{get:function(){return this._groupSet},enumerable:!0,configurable:!0}),e.prototype.AddObject=function(e){null==this._itemSet&&(this._itemSet=[]),this._itemSet.push(e)},Object.defineProperty(e.prototype,"ObjectSet",{get:function(){return this._itemSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DoorTypeSet",{get:function(){return this._doorTypeSet},enumerable:!0,configurable:!0}),e.prototype.SpliceObject=function(e){null!=this._itemSet&&(0>e||e>=this._itemSet.length||this._itemSet.splice(e,1))},e.prototype.Destroy=function(){if(null!=this._itemSet){for(var e=0;e<this._itemSet.length;e++)this._itemSet[e].Destroy(),null!=this._itemSet[e].parent&&this._itemSet[e].parent.contains(this._itemSet[e])&&this._itemSet[e].parent.removeChild(this._itemSet[e]);this._itemSet=[]}},Object.defineProperty(e.prototype,"GroupNum",{get:function(){return this._groupNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),e.prototype.GoldSort=function(){if(!(null==this._itemSet||this._itemSet.length<2))for(var e=0;e<this._itemSet.length-1;e++){for(var t=e,i=e+1;i<this._itemSet.length;i++)this._itemSet[i].y<this._itemSet[t].y&&(t=i);if(e!=t){var n=this._itemSet[e];this._itemSet[e]=this._itemSet[t],this._itemSet[t]=n}}},Object.defineProperty(e.prototype,"IsCreateRole",{get:function(){return this._isCreate},set:function(e){this._isCreate=e},enumerable:!0,configurable:!0}),e}();__reflect(Road.prototype,"Road");var RoadManager=function(e){function t(){var t=e.call(this)||this;return t._jsonKuai=null,t._dataKuaiRes=[],t._jsonKuaiPosi=null,t._dataKuaiPosi=[],t._jsonRoadMap=null,t._roadFenZhiArr=[],t._lastType=[],t._cenjiArr=[],t._houseArr=[],t._ballArr=[],t._roadImaArr=[],t._huiheImaArr=[],t._endRoadFenZhiTypeArr=[],t._roadPosiArr=[],t._endReturnGameData=null,t._oriX=[312],t._oriY=[0],t._difficultyLevel=0,t._roadNum=1,t._redImaArr=[],t._kuaiRes="",t.loadJson(),t}return __extends(t,e),t.Inistence=function(){return null==t._inistence&&(t._inistence=new t),t._inistence},t.prototype.loadJson=function(){this._jsonKuai=RES.getRes("roadType_json"),this._dataKuaiRes=[];for(var e=0;e<this._jsonKuai.road.length;e++)for(var t=0;t<this._jsonKuai.road.length;t++)if(this._jsonKuai.road[t].type==e+1){this._dataKuaiRes.push(this._jsonKuai.road[t]);break}this._jsonKuaiPosi=RES.getRes("kuaiPosi_json")},t.prototype.ceateMapType=function(e,t,i,n){void 0===e&&(e=10),void 0===t&&(t=!1),void 0===i&&(i=null),void 0===n&&(n=null),this.removeMap(),this._difficultyLevel=e,1==t&&(n=null),this._kuaiRes="k",CheckpointManager.CurrentCheckpoint&&(this._kuaiRes=CheckpointManager.CurrentCheckpoint.RoadRes),2005==UnitManager.CurrentRole.Scene&&UnitManager.CurrentRole.IsSceneStart&&(this._kuaiRes="hy"),this.setNanDuMap(t,n,i),this.jiexiJson(),this.creatJumpRoad(t);var a=new DynamicMap;return this.createMapRes(a),a.MapData=this._endReturnGameData,a.Difficulty=e,a},t.prototype.setNanDuMap=function(e,t,i){var n=[],a=["road1-1_json","road1-2_json","road1-3_json","road1-4_json","road1-5_json","road1-6_json","road1-7_json","road1-8_json"],r=["road2-1_json","road2-2_json","road2-3_json","road2-4_json","road2-5_json","road2-6_json","road2-7_json","road2-8_json"],o=["road3-1_json","road3-2_json","road3-3_json","road3-4_json","road3-5_json","road3-6_json"],s=["road4-1_json","road4-2_json","road4-3_json"],u=["road5-1_json","road5-2_json","road5-3_json"];n=[a,r,o,s,u];var l=[0,0,0,0,0];this._difficultyLevel>=1&&(l=[1,0,0,0,0]),this._difficultyLevel>=3&&(l=[.3,.7,0,0,0]),this._difficultyLevel>=5&&(l=[.2,.3,.5,0,0]),this._difficultyLevel>=7&&(l=[.1,.2,.3,.4,0]),this._difficultyLevel>=9&&(l=[0,.1,.2,.3,.4]);for(var h=0,c=1*Math.random(),_=0,d=1,p=0;p<l.length;p++){if(0==p){if(c<=l[p]){h=Math.floor(Math.random()*n[p].length),d=p+1;break}}else if(c>_&&c<=_+l[p]){h=Math.floor(Math.random()*n[p].length),d=p+1;break}_+=l[p]}if(5==d&&(d=4),e)do h=Math.floor(Math.random()*a.length),d=1;while(0==h);null!=t&&(h=t,d=i),this._jsonRoadMap=RES.getRes(n[d-1][h])},t.prototype.jiexiJson=function(){this._roadNum=this._jsonRoadMap.roadNum,this._houseArr=this._jsonRoadMap.house,this._ballArr=this._jsonRoadMap.balloon,this._oriX=this._jsonRoadMap.posiX,this._cenjiArr=this._jsonRoadMap.cenji,this._endRoadFenZhiTypeArr=this._jsonRoadMap.roadType;var e=this._jsonRoadMap.road;this._roadFenZhiArr=[];for(var t=0;t<e.length;t++){var i=[];this._roadFenZhiArr[t]=new Array,this._roadFenZhiArr[t].allRoadId=e[t].allRoadId,this._roadFenZhiArr[t].lastType=e[t].lastType,this._roadFenZhiArr[t].kuaiType=e[t].kuaiType,this._roadFenZhiArr[t].ifCanJump=e[t].ifCanJump,this._roadFenZhiArr[t].changeKuaiId=[];for(var n=0;n<e[t].kuaiType.length;n++){var a=e[t].kuaiType[n],r=0;n>0&&(r=e[t].kuaiType[n-1]),t>0&&0==n&&(r=e[t-1].kuaiType[e[t-1].kuaiType.length-1]);for(var o=0;o<a.num;o++){var s=[],u=a.type;if(a.der.length){s=RoadPackage.Instance.creatLine(a.type,a.der[0],!1,!1);var l=this.creatEndKuaiJson(a.der,a.type,s[0],a.doorID,a.intersect,this._roadFenZhiArr[t].ifCanJump);i.push(l);var h=this.creatEndKuaiJson(a.der,a.type,s[1],a.doorID,a.intersect,this._roadFenZhiArr[t].ifCanJump);i.push(h),s=RoadPackage.Instance.creatLine(a.type,a.der[1],!0,!1);var c=this.creatEndKuaiJson(a.der,a.type,s[1],a.doorID,a.intersect,this._roadFenZhiArr[t].ifCanJump);i.push(c)}else{s=RoadPackage.Instance.creatLine(a.type,a.der,!1,!1),0==r||0!=r.der||1!=r.type&&7!=r.type||2!=a.type||(s=RoadPackage.Instance.creatLine(a.type,a.der,!0,!1)),1!=u||0==a.der||1!=r.type&&2!=r.type&&0!=r.type&&7!=r.type||(r.der.length&&a.der!=r.der[r.der.length-1]||!r.der.length&&a.der!=r.der)&&(0==o&&(u=0),s=RoadPackage.Instance.creatLine(u,a.der,!1,!1));var l=this.creatEndKuaiJson(a.der,u,s[0],a.doorID,a.intersect,this._roadFenZhiArr[t].ifCanJump);if(i.push(l),2==a.type){var h=this.creatEndKuaiJson(a.der,a.type,s[1],a.doorID,a.intersect,this._roadFenZhiArr[t].ifCanJump);i.push(h)}}}}this._roadFenZhiArr[t].changeKuaiId=i}},t.prototype.creatJumpRoad=function(e){for(var t=.5,i=0,n=[],a=0;a<this._cenjiArr.length;a++)for(var r=3;r<this._roadFenZhiArr[this._cenjiArr[a][0]].changeKuaiId.length-1;r++)if(1==this._roadFenZhiArr[this._cenjiArr[a][0]].changeKuaiId[r].type){var o=this._cenjiArr[a][0],s=this._roadFenZhiArr[o].changeKuaiId.length,u=this._roadFenZhiArr[o].changeKuaiId[r],l=this._roadFenZhiArr[o].changeKuaiId[r-1],h=this._roadFenZhiArr[o].changeKuaiId[r-2],c=this._roadFenZhiArr[o].changeKuaiId[r+1],_=!0;if(r>=s-3){_=!1;break}if((l.der!=u.der||c.der!=u.der||h.der!=u.der||2==l.type&&3!=l.kuaiId)&&(_=!1),-1!=u.intersect&&0==u.ifCanJump&&(_=!1),e&&10>r&&(_=!1),_){for(var d=0;d<this._cenjiArr[a].length;d++)this._roadFenZhiArr[this._cenjiArr[a][d]].changeKuaiId[r].jugdeState=1,this._roadFenZhiArr[this._cenjiArr[a][d]].changeKuaiId[r].posiCenJi=a,this._roadFenZhiArr[this._cenjiArr[a][d]].changeKuaiId[r].PosiKuai=r;i+=1,n.push(this._roadFenZhiArr[this._cenjiArr[a][0]].changeKuaiId[r])}}var p=i*(1*this._difficultyLevel/18+31/90)*(1*this._difficultyLevel/18+31/90)|0,g=i*(1*this._difficultyLevel/18+31/90)*(1*this._difficultyLevel/18+31/90)|0;
1>g&&(g=1);var m=0,f=0,v=0,y=0;do{var S=Math.floor(100*Math.random()),b=Math.floor(1*Math.random());0!=m&&(S=t>v/m?Math.floor(100*t)-2:Math.floor(100*t)+2);var M=0;M=100*t>=S?b>this._difficultyLevel*(-4/90)+85/90?1:2:b>this._difficultyLevel*(-4/90)+85/90?3:4;for(var I=Math.random()*n.length|0,C=0,k=n[I].posiCenJi,w=n[I].PosiKuai,d=0;d<this._cenjiArr[k].length;d++){for(var R=0,P=0,T=this._cenjiArr[k][d],u=this._roadFenZhiArr[T].changeKuaiId[w],x=0;M>x&&1==this._roadFenZhiArr[T].changeKuaiId[w+x].jugdeState;x++){var G=RoadPackage.Instance.creatLine(4,u.der,!1,!1);this._roadFenZhiArr[T].changeKuaiId[w+x].type=4,this._roadFenZhiArr[T].changeKuaiId[w+x].kuaiId=G[0],this._roadFenZhiArr[T].changeKuaiId[w+x].jugdeState=0,P+=1}if(M>P)for(var x=1;M-P>x&&1==this._roadFenZhiArr[T].changeKuaiId[w-x].jugdeState;x++){var G=RoadPackage.Instance.creatLine(4,u.der,!1,!1);this._roadFenZhiArr[T].changeKuaiId[w-x].type=4,this._roadFenZhiArr[T].changeKuaiId[w-x].kuaiId=G[0],this._roadFenZhiArr[T].changeKuaiId[w-x].jugdeState=0,R+=1}C=P+R}w-=R;var E=0;0!=C&&(m+=1,f+=C,1==C?(E=C,v+=1):2==C?(E=C+1,v+=1):3==C?(E=C+Math.floor(2*Math.random()+1),y+=1):4==C&&(E=C+2,y+=1));var A=0;do if(A+=1,w-A>=0)for(var d=0;d<this._cenjiArr[k].length;d++)this._roadFenZhiArr[this._cenjiArr[k][d]].changeKuaiId[w-A].jugdeState=0;while(4>A);A=0;do if(A+=1,w+A<=this._roadFenZhiArr[this._cenjiArr[k][0]].changeKuaiId.length)for(var d=0;d<this._cenjiArr[k].length;d++)this._roadFenZhiArr[this._cenjiArr[k][d]].changeKuaiId[w+A].jugdeState=0;while(E>A);n=this.canJumpRoadSet,i=n.length}while(0!=i&&p>f);this.SetJumpOtherRoadType()},Object.defineProperty(t.prototype,"canJumpRoadSet",{get:function(){for(var e=[],t=0;t<this._cenjiArr.length;t++)for(var i=3;i<this._roadFenZhiArr[this._cenjiArr[t][0]].changeKuaiId.length-1;i++)if(1==this._roadFenZhiArr[this._cenjiArr[t][0]].changeKuaiId[i].type){var n=this._cenjiArr[t][0],a=this._roadFenZhiArr[n].changeKuaiId[i];1==a.jugdeState&&e.push(this._roadFenZhiArr[this._cenjiArr[t][0]].changeKuaiId[i])}return e},enumerable:!0,configurable:!0}),t.prototype.SetJumpOtherRoadType=function(){for(var e=0;e<this._roadFenZhiArr.length;e++)for(var t=0;t<this._roadFenZhiArr[e].changeKuaiId.length;t++){var i=this._roadFenZhiArr[e].changeKuaiId[t],n=null,a=null;if(t-1>=0&&(n=this._roadFenZhiArr[e].changeKuaiId[t-1]),t+1<this._roadFenZhiArr[e].changeKuaiId.length&&(a=this._roadFenZhiArr[e].changeKuaiId[t+1]),5==i.type){var r=RoadPackage.Instance.creatLine(5,i.der,!1,!1);i.kuaiId=r[0]}else if(6==i.type){var r=RoadPackage.Instance.creatLine(3,i.der,!1,!1);i.kuaiId=r[0]}else if(7==i.type){var r=RoadPackage.Instance.creatLine(0,i.der,!1,!1);i.kuaiId=r[0]}else if(4==i.type){if(n&&1==n.type||n&&0==n.type){var r=RoadPackage.Instance.creatLine(3,n.der,!1,!1);this._roadFenZhiArr[e].changeKuaiId[t-1].type=3,this._roadFenZhiArr[e].changeKuaiId[t-1].kuaiId=r[0]}if(a&&1==a.type){var r=RoadPackage.Instance.creatLine(0,a.der,!1,!1);this._roadFenZhiArr[e].changeKuaiId[t+1].type=0,this._roadFenZhiArr[e].changeKuaiId[t+1].kuaiId=r[0]}if(n&&2==n.type&&3==n.kuaiId){var r=RoadPackage.Instance.creatLine(n.der,n.der,!1,!0);this._roadFenZhiArr[e].changeKuaiId[t-1].type=n.type,this._roadFenZhiArr[e].changeKuaiId[t-1].kuaiId=r[1]}}this._roadFenZhiArr[e].changeKuaiId[t]=i}},t.prototype.creatEndKuaiJson=function(e,t,i,n,a,r){var o={der:e,type:t,kuaiId:i,doorID:n,intersect:a,ifCanJump:r,jugdeState:0};return o},t.prototype.createMapRes=function(e){for(var t=0;t<this._roadFenZhiArr.length;t++){this._roadImaArr[t]=new Array;for(var i=0;i<this._roadFenZhiArr[t].changeKuaiId.length;i++){var n=this.creatRoadIma(t,i,this._roadFenZhiArr[t].lastType[0]);this._roadImaArr[t].push(n[0])}}for(var a=0;a<this._cenjiArr.length;a++)for(var r=-1,o=0;o<this._roadImaArr[this._cenjiArr[a][0]].length;o++)for(var s=0;s<this._cenjiArr[a].length;s++)r=this._cenjiArr[a][s],e.AddImage(this._roadImaArr[r][o]),-1!=this._roadFenZhiArr[r].changeKuaiId[o].intersect&&r!=this._roadFenZhiArr[r].changeKuaiId[o].intersect[0]&&(this._roadImaArr[r][o].visible=!1);for(var a=0;a<this._huiheImaArr.length;a++)this._huiheImaArr[a].isheight=!1,e.AddImage(this._huiheImaArr[a]);this.jisuanPosi(),this._endReturnGameData={road:[],roadcount:this._roadNum,resheight:e.Height-8,house:this._houseArr,balloon:this._ballArr,posiX:e.posiX};for(var o=0;o<this._roadPosiArr.length;o++){for(var u={roaddata:{type:1,data:[]}},a=0;a<this._roadPosiArr[o].length;a++)u.roaddata.data.push(this._roadPosiArr[o][a]);this._endReturnGameData.road.push(u)}for(var a=0;a<this._endRoadFenZhiTypeArr.length;a++)for(var o=0;o<this._endRoadFenZhiTypeArr[a].length;o++){var l=this._endRoadFenZhiTypeArr[a][o];if(5==this._roadFenZhiArr[l].changeKuaiId[0].type){this._endReturnGameData.road[a].roaddata.type=this._roadFenZhiArr[l].allRoadId;break}}},t.prototype.jisuanPosi=function(){for(var e=-1,t=-1,i=0;i<this._endRoadFenZhiTypeArr.length;i++){this._roadPosiArr[i]=[],e=-1,t=-1;for(var n=0;n<this._endRoadFenZhiTypeArr[i].length;n++)for(var a=this._endRoadFenZhiTypeArr[i][n],r=0;r<this._roadImaArr[a].length;r++){var o=1,s=[],u=[],l=0,h=!0;if(1==this._roadImaArr[a][r].type)t!=this._roadImaArr[a][r].der?(o=1,s=-1==t?this._roadImaArr[a][r].topPosi:this._roadImaArr[a][r].cenPosi,6==e&&(h=!1)):e=1;else if(2==this._roadImaArr[a][r].type)if("_1"==this._roadImaArr[a][r].res)if(t=3,o=1,this._roadImaArr[a][r].der.length){s=this._roadImaArr[a][r-1].cenPosi,u=[this._roadImaArr[a][r-1].x+s[0],this._roadImaArr[a][r-1].y+s[1]];var c=[u[0],u[1],o,this._roadImaArr[a][r].roadID,l];this._roadPosiArr[i].push(c),s=this._roadImaArr[a][r+1].cenPosi,u=[this._roadImaArr[a][r+1].x+s[0],this._roadImaArr[a][r+1].y+s[1]]}else this._roadImaArr[a][r-1].der==this._roadImaArr[a][r].der?(s=this._roadImaArr[a][r-1].cenPosi,u=[this._roadImaArr[a][r-1].x+s[0],this._roadImaArr[a][r-1].y+s[1]]):(s=this._roadImaArr[a][r+1].cenPosi,u=[this._roadImaArr[a][r+1].x+s[0],this._roadImaArr[a][r+1].y+s[1]]);else o=e;else if(5==this._roadImaArr[a][r].type)o=6,s=this._roadImaArr[a][r].cenPosi;else if(6==this._roadImaArr[a][r].type){if(0==i&&0==n&&0==r){s=this._roadImaArr[a][r].topPosi,u=[this._roadImaArr[a][r].x+s[0],this._roadImaArr[a][r].y+s[1]];var c=[u[0],u[1],o,this._roadImaArr[a][r].roadID,l];this._roadPosiArr[i].push(c)}o=4,s=this._roadImaArr[a][r].buttomPosi,l=this._roadImaArr[a][r].doorID}else if(7==this._roadImaArr[a][r].type){o=5,s=this._roadImaArr[a][r].topPosi;var _=this._roadImaArr[a][r].doorID.toString().split(".");l=parseInt(_[0])}else if(0==this._roadImaArr[a][r].type){o=3,s=this._roadImaArr[a][r].topPosi,r>0&&(1==this._roadImaArr[a][r-1].type||0==this._roadImaArr[a][r-1].type||2==this._roadImaArr[a][r-1].type)&&(o=1,s=this._roadImaArr[a][r].cenPosi);var d=0,p=0;n>0&&(p=this._endRoadFenZhiTypeArr[i][n-1]),0!=p&&0==r&&(d=this._roadImaArr[p][this._roadImaArr[p].length-1]),0==d||1!=d.type&&0!=d.type&&2!=d.type||(o=1,s=this._roadImaArr[a][r].cenPosi)}else if(3==this._roadImaArr[a][r].type){if(r-1>=0&&4==this._roadImaArr[a][r-1].type){o=3,s=this._roadImaArr[a][r].topPosi,u=[this._roadImaArr[a][r].x+s[0],this._roadImaArr[a][r].y+s[1]];var g=[u[0],u[1],o,this._roadImaArr[a][r].roadID,l];this._roadPosiArr[i].push(g),e=o}o=2,s=this._roadImaArr[a][r].buttomPosi}else if(4==this._roadImaArr[a][r].type){if(2==this._roadImaArr[a][r-1].type){o=2,s=this._roadImaArr[a][r-1].buttomPosi,u=[this._roadImaArr[a][r-1].x+s[0],this._roadImaArr[a][r-1].y+s[1]];var g=[u[0],u[1],o,this._roadImaArr[a][r-1].roadID,l];this._roadPosiArr[i].push(g)}if(2==this._roadImaArr[a][r+1].type){o=3,s=this._roadImaArr[a][r+1].topPosi,u=[this._roadImaArr[a][r+1].x+s[0],this._roadImaArr[a][r+1].y+s[1]];var g=[u[0],u[1],o,this._roadImaArr[a][r+1].roadID,l];this._roadPosiArr[i].push(g)}o=e,t=this._roadImaArr[a][r].der}if(3!=t&&(u=[this._roadImaArr[a][r].x+s[0],this._roadImaArr[a][r].y+s[1]]),u[0]&&(e!=o||t!=this._roadImaArr[a][r].der)&&h){var c=[u[0],u[1],o,this._roadImaArr[a][r].roadID,l];this._roadPosiArr[i].push(c)}e=o,t=this._roadImaArr[a][r].der.length?this._roadImaArr[a][r].der[1]:this._roadImaArr[a][r].der,r+1<this._roadImaArr[a].length&&2==this._roadImaArr[a][r].type&&0==this._roadImaArr[a][r+1].der&&(t=0)}}if(5==this._roadPosiArr[0][this._roadPosiArr[0].length-1][2])for(var o=1,l=0,m=this._endRoadFenZhiTypeArr.length-1,f=this._endRoadFenZhiTypeArr[m].length-1,a=this._endRoadFenZhiTypeArr[m][f],v=this._roadImaArr[a].length-1,s=this._roadImaArr[a][v].topPosi,u=[this._roadImaArr[a][v].x+s[0],this._roadImaArr[a][v].y+s[1]],c=[u[0],u[1],o,this._roadImaArr[a][v].roadID,l],i=0;i<this._roadPosiArr.length;i++)this._roadPosiArr[i].push(c)},t.prototype.creatRoadIma=function(e,t,i){var n=this._roadFenZhiArr[e].changeKuaiId[t],a=null;t>0&&(a=this._roadFenZhiArr[e].changeKuaiId[t-1]);var r=this._dataKuaiRes[n.kuaiId-1].res,o=ImagePool.GetImage(this._kuaiRes+r+"_png"),s=this._jsonKuaiPosi[r];if(o.topPosi=[s[2],s[3]],o.buttomPosi=[s[4],s[5]],o.cenPosi=[s[6],s[7]],o.type=n.type,o.roadID=this._roadFenZhiArr[e].allRoadId,o.doorID=n.doorID,o.der=n.der,o.res=r,0==t){if(o.x=312,o.y=0,-1!=i){var u=this._roadFenZhiArr[i].changeKuaiId.length-1,l=this._roadFenZhiArr[i].changeKuaiId[u],h=RoadPackage.Instance.setPosi(n.kuaiId,l.kuaiId);o.x=this._roadImaArr[i][u].x+h[0],o.y=this._roadImaArr[i][u].y+h[1]}}else{var c=RoadPackage.Instance.setPosi(n.kuaiId,a.kuaiId);o.x=this._roadImaArr[e][t-1].x+c[0],o.y=this._roadImaArr[e][t-1].y+c[1]}if(7==n.type){var _=n.doorID.toString().split(".");o.x=this._oriX[parseInt(_[0])-1][parseInt(_[1])-1][0],o.y=this._oriX[parseInt(_[0])-1][parseInt(_[1])-1][1]}else if(5==n.type){var d=ImagePool.GetImage("huihedian_png");0!=n.der?d.x=o.x+4:d.x=o.x-2,d.y=o.y,this._huiheImaArr.push(d)}return[o]},t.prototype.removeMap=function(){this._roadImaArr=[],this._redImaArr=[],this._huiheImaArr=[],this._roadFenZhiArr=[],this._lastType=[],this._cenjiArr=[],this._endRoadFenZhiTypeArr=[],this._roadPosiArr=[],this._endReturnGameData=null,this._oriX=[312],this._oriY=[0],this._roadNum=1},t}(egret.DisplayObjectContainer);__reflect(RoadManager.prototype,"RoadManager");var RoadPackage=function(){function e(){}return e.prototype.creatLine=function(e,t,i,n){return void 0===i&&(i=null),void 0===n&&(n=null),0==e?this.creatLineStrart(t):1==e?this.creatLineCenter(t):2==e?this.creatZheJiao(t,i,n):3==e?this.creatLineEnd(t):4==e?this.creatLineJump(t):5==e?this.creatHuiHe(t):this.creatLineCenter(t)},e.prototype.creatLineStrart=function(e){return 0==e?[1]:1==e?[9]:2==e?[11]:null},e.prototype.creatLineCenter=function(e){if(0==e){var t=2*Math.random()|0;return 0==t?[2]:[21]}if(1==e){var t=2*Math.random()|0;return 0==t?[6]:[20]}if(2==e){var t=2*Math.random()|0;return 0==t?[5]:[19]}},e.prototype.creatZheJiao=function(e,t,i){if(void 0===t&&(t=!0),void 0===i&&(i=0),t&&0==i){if(1==e)return[3,15];if(2==e)return[3,4]}else if(0==t&&0==i){if(1==e)return[10,3];if(2==e)return[12,3]}else if(0==t&&1==i){if(1==e)return[10,17];if(2==e)return[12,17]}},e.prototype.creatLineEnd=function(e){return 0==e?[13]:2==e?[7]:1==e?[18]:void 0},e.prototype.creatLineJump=function(e){return 0==e?[14]:1==e?[8]:2==e?[16]:void 0},e.prototype.creatHuiHe=function(e){return 0==e?[2]:[7]},e.prototype.setPosi=function(e,t){return 1==t?3==e?[0,30]:[0,31]:2==t?3==e?[0,30]:[0,31]:21==t?3==e?[0,30]:[0,31]:3==t?2==e?[0,48]:21==e?[0,48]:4==e?[0,37]:13==e?[0,48]:15==e?[-5,37]:[0,31]:4==t?[16,15]:5==t?2==e?[6,20]:21==e?[6,20]:[22,15]:19==t?2==e?[6,20]:21==e?[6,20]:[22,15]:6==t?10==e?[-16,15]:2==e?[6,20]:21==e?[6,20]:[-22,15]:20==t?10==e?[-16,15]:2==e?[6,20]:21==e?[6,20]:[-22,15]:7==t?8==e?[-22,15]:2==e?[6,20]:21==e?[6,20]:[22,15]:8==t?10==e?[-16,15]:[-22,15]:9==t?10==e?[-16,15]:[-22,15]:10==t?[0,15]:11==t?[22,15]:12==t?3==e?[5,15]:[5,15]:13==t?[0,31]:14==t?[0,31]:15==t?10==e?[-16,15]:[-22,15]:16==t?[22,15]:17==t?[0,48]:18==t?8==e?[-22,15]:2==e?[6,20]:21==e?[6,20]:[22,15]:void 0},e}();RoadPackage.Instance=new RoadPackage,__reflect(RoadPackage.prototype,"RoadPackage");var Scene=function(e){function t(){var t=e.call(this)||this;return t.width=640,t.height=1136,t}return __extends(t,e),t.prototype.CreateScene=function(){var e=640,t=1136;this._imageSet=[],this._bridSet=[];for(var i=MapManager.SceneJsonData,n=Math.ceil(2*Math.random())+1,a=0;n>a;a++){var r=Math.floor(Math.random()*i.mountain.length),o=ImagePool.GetImage(i.mountain[r].res),s=Math.floor(Math.random()*(t-300))+300;o.y=s,o.x=i.mountain[r].posiX,this._imageSet.push(o),this.addChild(o)}for(var u=Math.ceil(2*Math.random())+2,a=0;u>a;a++){var r=Math.floor(Math.random()*i.cloud.length),l=ImagePool.GetImage(i.cloud[r].res),h=Math.floor(Math.random()*t);l.y=h,l.x=i.cloud[r].posiX,this._imageSet.push(l),this.addChild(l)}for(var c=Math.random()>.5?10-Math.ceil(3*Math.random()):10+Math.ceil(3*Math.random()),a=0;c>a;a++){var r=Math.floor(Math.random()*i.bird.length),_=ImagePool.GetImage(i.bird[r]);_.x=Math.floor(Math.random()*e),_.y=Math.floor(Math.random()*t)+this.y,this._bridSet.push(_),Game.Instance.TopLayer.addChild(_)}for(var d=Math.ceil(5*Math.random())+15,a=0;d>a;a++){var r=Math.floor(Math.random()*i.tree.length),p=ImagePool.GetImage(i.tree[r]);p.x=Math.floor(Math.random()*e),p.y=Math.floor(Math.random()*t),this._imageSet.push(p),this.addChild(p)}},t.prototype.Destroy=function(){for(var e=0;e<this._bridSet.length;e++)Game.Instance.TopLayer.removeChild(this._bridSet[e]),ImagePool.ReturnPool(this._bridSet[e]);for(var e=0;e<this._imageSet.length;e++)this.removeChild(this._imageSet[e]),ImagePool.ReturnPool(this._imageSet[e])},t}(egret.DisplayObjectContainer);__reflect(Scene.prototype,"Scene");var Facade=function(){function e(){this.timerOfExpired=0,this.timerOfResent=0,this.timerOfActive=0,this.huancunSet=[],this.notifyHandles={},this._connectIng=!1,this._time=0,this._connNum=0,this._ifHaveWaitPage=!0,this.SocketInit(NetManager.IndexServerInfo.host,NetManager.IndexServerInfo.port),ProcessManager.AddProcess(this._Process.bind(this))}return e.prototype.trace=function(e){},e.instance=function(){return e._inst||(e._inst=new e),e._inst},e.prototype.SocketInit=function(t,i){var n=this;this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect());var a="https";Main.IsLocationDebug&&(a="http"),this.socket=io.connect(a+"://"+t+":"+i,{forceNew:!0}),this.socket.on("notify",function(e){n.notifyHandles[e.type]?n.notifyHandles[e.type](e):n.notifyHandles["default"]&&n.notifyHandles["default"](e)}),this.watch(function(e){});var r=this;this.socket.on("connect",function(){if(0==this._ifHaveWaitPage&&WindowManager.WaitPage()&&(this._ifHaveWaitPage=!0,WindowManager.WaitPage().IsVisibled=!1),e.instance()._connectIng=!1,e.instance()._time=0,e.instance()._connNum=0,this.huancunSet&&this.huancunSet.length>0){var t=this.huancunSet.shift();this.fetch(t[0],t[1])}LoginMgr.RealLogin()}.bind(this)),this.socket.on("disconnect",function(){r.waitConnectFun()}),this.socket.on("close",function(){r.waitConnectFun()}),this.socket.on("error",function(){r.socket.disconnect()}),this.socket.on("active",function(e){r.timerOfExpired=0})},e.prototype.fetch=function(e,t){var i=this;if(!this.socket.connected){var n=!1;if(this.huancunSet&&this.huancunSet.length>0)for(var a=0;a<this.huancunSet.length;a++)if(this.huancunSet[a][0]==e){n=!0;break}return 0==n&&this.huancunSet.push([e,t]),void this.waitConnectFun()}var r={};e.reduce(function(e,t){return e+t},"").split("&").map(function(e){var t=e.split("=");r[t[0]]=t[1]});var o=r.func.split(".");o.length>1&&(r.control=o[0],r.func=o[1]),this.socket.emit("req",r,function(e){i.timerOfExpired=0,null!=e&&null!=t&&t(e)})},e.prototype.waitConnectFun=function(){0==e.instance()._connectIng&&(e.instance()._time=0),e.instance()._connectIng=!0,this.socket.connect()},e.prototype._Process=function(t){if(e.instance()._connectIng){var i=e.instance()._connNum>=3?15e3:3e3;if(e.instance()._time+=t,e.instance()._time>=i)if(e.instance()._time-=i,e.instance()._connNum+=1,e.instance()._connNum<6)try{e.instance().socket.connect()}catch(n){console.error(n)}else e.instance()._connectIng=!1,e.instance()._connNum=0,e.instance()._time=0,0==this._ifHaveWaitPage&&WindowManager.WaitPage()&&(this._ifHaveWaitPage=!0,WindowManager.WaitPage().IsVisibled=!1),PromptManager.ShowWeihu()}},e.prototype.notify=function(e){var t=e.func.split(".");t.length>1&&(e.control=t[0],e.func=t[1]),this.socket.emit("notify",e)},e.prototype.watch=function(e,t){return void 0===t&&(t="default"),this.notifyHandles[t]=e,this},e}();__reflect(Facade.prototype,"Facade");var JsonpReq=function(){function e(){}return e.process=function(t){e.startLoader(t)},e.startLoader=function(t){t.addEventListener(egret.Event.COMPLETE,e.onComplete,this),t.load(t._request)},e.onComplete=function(t){e.OnGetComplete(t.target.data)},e.OnGetComplete=function(e){var t=e;t=JSON.parse(e),NetManager.OnGetComplete(t)},e}();__reflect(JsonpReq.prototype,"JsonpReq");var NetManager=function(){function e(){}return Object.defineProperty(e,"IndexServerInfo",{get:function(){return Main.IsLocationDebug?{host:"127.0.0.1",port:9901}:{host:"w.gamegold.xin",port:9901}},enumerable:!0,configurable:!0}),e.SendRequest=function(t,i,n){void 0===i&&(i=null),void 0===n&&(n=!0),Main.IsNeedNetDebug&&(Facade.instance().fetch(t,i),null==e._errorCodeSet&&e._InitErrorCode())},e._NextSend=function(){e._currentNetCon=null,e._reconnectionTime=0,e._requestFirstSet.length>0?e._currentNetCon=e._requestFirstSet.shift():e._requestSecondSet.length>0&&(e._currentNetCon=e._requestSecondSet.shift()),null!=e._currentNetCon&&e._GetData(e._currentNetCon.ReqSet,e._currentNetCon.CompleteFun)},e._GetData=function(t,i){void 0===i&&(i=null);var n="";n=""==e.ServerUrl?e.IndexServer+"/index.html?":"https://"+e.ServerUrl+":"+e.ServerPort+"/index.html?";var a,r="";if(a=r,null!=t)for(var o=0;o<t.length;o++)r+=t[o],a+=t[o];var s=n+r;a=n+a,e._currentSendUrl=s;var u=new egret.URLLoader;u.dataFormat=egret.URLLoaderDataFormat.TEXT;var l=new egret.URLRequest(s);l.method=egret.URLRequestMethod.GET,u._request=l,JsonpReq.process(u),e._timer=0},e.OnGetComplete=function(t){if(null==t)e._NextSend();else if(null!=e._currentNetCon.CompleteFun)try{t.code!=e.SuccessCode,e._currentNetCon.CompleteFun(t),e._NextSend()}catch(i){Main.AddDebug("消息处理出错,发送链接："+e._currentSendUrl),Main.AddDebug(i),e._NextSend()}},e.Process=function(t){if(null!=e._currentNetCon){var i=15e3;e._timer+=t,e._timer>=i&&(console.log("消息处理超时,链接："+e._currentSendUrl),e._NextSend())}},e._InitErrorCode=function(){e._errorCodeSet=[]},e}();NetManager.IndexServer=Main.IsLocationDebug?"http://127.0.0.1:9901":"http://w.gamegold.xin:9901",NetManager.ServerUrl="",NetManager.ServerPort="",NetManager.SuccessCode=0,NetManager._requestFirstSet=[],NetManager._requestSecondSet=[],NetManager._currentNetCon=null,NetManager._timer=0,NetManager._reconnectionTime=0,__reflect(NetManager.prototype,"NetManager");var NetContent=function(){function e(e,t){this._reqSet=e,this._completeFun=t}return Object.defineProperty(e.prototype,"ReqSet",{get:function(){return this._reqSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CompleteFun",{get:function(){return this._completeFun},enumerable:!0,configurable:!0}),e}();__reflect(NetContent.prototype,"NetContent");var NetNumber=function(){function e(){}return Object.defineProperty(e,"Logoin",{get:function(){return"index.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameEnd",{get:function(){return 1001},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UseItem",{get:function(){return 1002},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BuyItem",{get:function(){return"shop.BuyShopItem"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PlayerInfomation",{get:function(){return 1005},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BuyGold",{get:function(){return"shop.BuyItem"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChangeRoleOrTheme",{get:function(){return 1009},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShareEnd",{get:function(){return 1010},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SendHelloNum",{get:function(){return 3004},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FriendInfor",{get:function(){return 3005},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FriendUserStatus",{get:function(){return 3010},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Ranking",{get:function(){return 9e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DayRanking",{get:function(){return 9001},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FriendRanking",{get:function(){return 9002},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AchievementList",{get:function(){return"task.list"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AchGetBonus",{get:function(){return"task.getBonus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointList",{get:function(){return"gate.query"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointStar",{get:function(){return"gate.start"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointEnd",{get:function(){return"gate.end"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointRaid",{get:function(){return"gate.sweep"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReceivePhysical",{get:function(){return"1"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleList",{get:function(){return"role.list"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upRole",{get:function(){return"role.upgrade"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RaidReward",{get:function(){return"gate.getSweepBonus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AchievementComplete",{get:function(){return"2001"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AchievementUpdate",{get:function(){return"2002"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Guide",{get:function(){return"5001"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GuideBonus",{get:function(){return"5002"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShareFirstBonus",{get:function(){return"5003"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GuideInfo",{get:function(){return"checkGuide"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GuideFinish",{get:function(){return"guide.finish"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShareTimeUpdate",{get:function(){return"3006"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VIPCheck",{get:function(){return"vip.checkValid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DayGift",{get:function(){return"vip.draw"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PlayGift",{get:function(){return"getGift"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VipDayGift",{get:function(){return"vip.drawDaily"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FirstChargeGift",{get:function(){return"vip.drawFirstPurchaseBonus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityInfo",{get:function(){return"activity.getInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityRankList",{get:function(){return"activity.getList"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityScore",{get:function(){return 6e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityGetBonus",{get:function(){return"activity.getBonus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UserStatusUpdate",{get:function(){return"4"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StartCatch",{get:function(){return"gate.startCatch"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EndCatch",{get:function(){return"gate.catch"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SendHello",{get:function(){return"sendHello"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetNoticeList",{get:function(){return"mail.getList"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SendNoticeRead",{get:function(){return"mail.read"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetSlaveList",{get:function(){return"social.getSlaveList"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StartEscape",{get:function(){return"gate.startEscape"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EscapeEnd",{get:function(){return"gate.escape"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BuyTimes",{get:function(){return"3150"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveList",{get:function(){return"3106"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveCatch",{get:function(){return"3101"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveCatchEnd",{get:function(){return"3121"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveEscape",{get:function(){return"3103"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveEscapeEnd",{get:function(){return"3123"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveRansom",{get:function(){return"3104"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveRelease",{get:function(){return"3105"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveLash",{get:function(){return"3102"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveFood",{get:function(){return"3107"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveAvenge",{get:function(){return"3108"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlavePraise",{get:function(){return"3110"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveFawn",{get:function(){return"3109"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveFawnWatch",{get:function(){return"3111"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HeartBeat",{get:function(){return"heartbeat"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetDailyActiveInfo",{get:function(){return"dailyactivity.getInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AddDailyActiveProp",{get:function(){return"dailyactivity.addProp"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DailyActiveButtonVisible",{get:function(){return"4102"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DailyActiveRank",{get:function(){return"dailyactivity.getList"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RollingNotice",{get:function(){return"2"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upRoleSkill",{get:function(){return"role.skill"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReceiveBonus",{get:function(){return"7001"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReceiveShareScenceBonus",{get:function(){return"7002"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActiveInfo",{get:function(){return"task.getInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActiveBonus",{get:function(){return"getFesGift"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NinjaSceneUnlock",{get:function(){return"role.unlockedScene"},enumerable:!0,configurable:!0}),e}();__reflect(NetNumber.prototype,"NetNumber");var AchievementDetailPage=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._isVisibled=!1,t.skinName="resource/game_skins/AchievementDetail.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._rewardButton.visible=!0,this._shareButton.visible=!1,this._desLabel.text="",this._conditionLabel.text="",this._rewardLabel.text="",this._conditionLabel.bold=!0,this._rewardLabel.bold=!0,this._desLabel.bold=!0,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._rewardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRewardClick,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnShareClick,this),this._isCreated=!0,null!=this._achievement&&this.ShowPage(this._achievement)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="chengjiu2_di"+e+"_png",this._getedImage.source="chengjiu2_yihuode"+e+"_png",this._rewardButton.skinName=SkinCreateMgr.CreateButton("chengjiu2_fenxiang_l"+e+"_png","chengjiu2_fenxiang_a"+e+"_png"),this._shareButton.skinName=SkinCreateMgr.CreateButton("chengjiu2_fenxiang1_l"+e+"_png","chengjiu2_fenxiang1_a"+e+"_png"),this.updataButton()},t.prototype._OnCloseClick=function(){this.IsVisibled=!1},t.prototype._OnRewardClick=function(){return this._achievement.IsCompleted?void this._OnShareClick():void PromptManager.CreatCenterTip(!1,!0,"成就未完成")},t.prototype._OnShareClick=function(){if(!this._achievement.IsCompleted)return void PromptManager.CreatCenterTip(!1,!0,"成就未完成");if(Main.IsLocationDebug)return void this._GetBonus();var e=this._achievement.ShareContent;0==e.length?(window.shareCont=FBSDKMgr.Share(),window.share()):(window.shareCont=FBSDKMgr.Share(e[0],e[1]),window.share()),this._GetBonus()},t.prototype._GetBonus=function(){AchievementManager.AchievementGetBonus(this._achievement.ID),this._achievement.Status=2,this._rewardButton.visible=1==this._achievement.Status,this._shareButton.visible=2==this._achievement.Status,this._getedImage.visible=2==this._achievement.Status},t.prototype.ShowPage=function(e){if(this._achievement=e,!this._isCreated)return void(this.IsVisibled=!0);var t=StringMgr.LanguageSuffix,i=RES.getRes(this._achievement.ImageRes+"_jpg");if(RES.getRes(this._achievement.ImageRes+t+"_png")&&(i=RES.getRes(this._achievement.ImageRes+t+"_png")),this._achImage.texture=i,this._nameLabel.text=this._achievement.Name,this._desLabel.text=this._achievement.Description,this._conditionLabel.text=this._achievement.ConditionDesc,this._rewardImage.texture=RES.getRes(this._achievement.RewardImageRes),this._rewardLabel.text=this._achievement.RewardDesc,this.updataButton(),this._getedImage.visible=2==this._achievement.Status,this._achImage.filters=[],this._achievement.IsCompleted){var n=this._achievement.Rarity;if(0!=n){var a=1==n?"acmenteffects_1":"acmenteffects_2";this._effectArm=ArmaturePool.GetArmature(a+"_json",a+"texture_json",a+"texture_png",a),this._effectArm.display.x=100,this._effectArm.display.y=100,this._effectArm.display.scaleX=1,this._effectArm.display.scaleY=1,this._effectGroup.addChild(this._effectArm.display),this._effectArm.animation.play(a,0),this._movieName=a}}else this._achImage.filters=[FilterManage.HuiDu];this.IsVisibled=!0},t.prototype.updataButton=function(){this._rewardButton.visible=1==this._achievement.Status,this._shareButton.visible=2==this._achievement.Status},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.TopLayer.addChild(this):(Main.Instance.TopLayer.removeChild(this),null!=this._effectArm&&(this._effectGroup.removeChild(this._effectArm.display),this._effectArm.animation.stop(this._movieName),ArmaturePool.ReturnPool(this._effectArm),this._effectArm=null)))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(AchievementDetailPage.prototype,"AchievementDetailPage");var AchievementInfo=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t.skinName="resource/game_skins/AchievementSkins.exml",t.width=170,t.height=238,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._nameLabel.bold=!0,this._label.bold=!0,this._isCreated=!0,null!=this._achievement&&this.SetData(this._achievement),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),this.PlayMovie(),GameEvent.AddEventListener(EventType.AchieveUpdata,this.Updata,this)},t.prototype._OnClick=function(){WindowManager.AchievementDetailPage().ShowPage(this._achievement)},t.prototype.SetData=function(e){if(null!=e&&(this._achievement=e,this._isCreated)){this.Updata();var t=this._achievement.Rarity;if(0!=t){var i=1==t?"acmenteffects_1":"acmenteffects_2";this._effectArm=ArmaturePool.GetArmature(i+"_json",i+"texture_json",i+"texture_png",i),this._effectArm.display.x=65,this._effectArm.display.y=65,this._effectArm.display.scaleX=.65,this._effectArm.display.scaleY=.65,MovieManager.RemoveArmature(this._effectArm),this._movieName=i
}}},t.prototype.Updata=function(){var e=StringMgr.LanguageSuffix,t=RES.getRes(this._achievement.ImageRes+"_jpg");RES.getRes(this._achievement.ImageRes+e+"_png")&&(t=RES.getRes(this._achievement.ImageRes+e+"_png")),this._image.texture=t,this._nameLabel.text="No."+this._achievement.ID;var i=StringMgr.GetText("achievementtext1");this._achievement.IsCompleted&&(i=this._achievement.CompleteTime+StringMgr.GetText("achievementtext2")),this._label.text=i,this._image.filters=[],this._achievement.IsCompleted||(this._image.filters=[FilterManage.HuiDu]),this._redIma.visible=1==this._achievement.Status?!0:!1},t.prototype.PlayMovie=function(){this._achievement.IsCompleted&&null!=this._effectArm&&(this._effectGroup.addChild(this._effectArm.display),MovieManager.ADDArmature(this._effectArm),this._effectArm.animation.play(this._movieName,0))},t.prototype.StopMovie=function(){this._achievement.IsCompleted&&null!=this._effectArm&&(this._effectGroup.contains(this._effectArm.display)&&this._effectGroup.removeChild(this._effectArm.display),MovieManager.RemoveArmature(this._effectArm),this._effectArm.animation.stop(this._movieName))},t}(eui.Component);__reflect(AchievementInfo.prototype,"AchievementInfo");var AchievementTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._isMovie=!1,t.skinName="resource/game_skins/AchievementTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){if(e.prototype.createChildren.call(this),this._label.bold=!0,this.height=148,this.x=0,this.y=-this.height,this._isCreated=!0,null!=this._resName){var t=this._resName;this._resName="",this.Show(t,this._desText)}},t.prototype.Show=function(e,t){if(!this._isMovie){if(!this._isCreated)return this._resName=e,this._desText=t,void(this.IsVisibled=!0);e!=this._resName&&(this._image.texture=RES.getRes(e),this._resName=e),this._label.text=t,this.IsVisibled=!0}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._Movie()):(Main.Instance.WindowTopLayer.removeChild(this),this._isMovie=!1))},enumerable:!0,configurable:!0}),t.prototype._Movie=function(){this._isMovie=!0,egret.Tween.removeTweens(this),this.y=-this.height;var e=egret.Tween.get(this);e.to({y:0},500).call(this._Appear.bind(this))},t.prototype._Appear=function(){egret.Tween.removeTweens(this);var e=egret.Tween.get(this);e.wait(2e3).call(this._Hide.bind(this))},t.prototype._Hide=function(){egret.Tween.removeTweens(this);var e=egret.Tween.get(this);e.to({y:-this.height},500).call(this._HideEnd.bind(this))},t.prototype._HideEnd=function(){egret.Tween.removeTweens(this),this.IsVisibled=!1},t}(eui.Component);__reflect(AchievementTip.prototype,"AchievementTip");var AchievementWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/AchievementPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._SetAchievementData(),GameEvent.AddEventListener(EventType.AchieveUpdata,this._Updata,this)},t.prototype._SetAchievementData=function(){this._achInfoSet=[];for(var e=AchievementManager.AchievementSet,t=0;t<e.length;t++){var i=e[t],n=new AchievementInfo;n.SetData(i),n.x=t%3==0?0:t%3==1?n.width+10:2*n.width+20,n.y=Math.floor(t/3)*n.height+18*Math.floor(t/3),this._achGroup.addChild(n),this._achInfoSet.push(n)}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){if(this._isVisibled!=e){this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),AchievementManager.GetAchievementData()):Main.Instance.WindowBottomLayer.removeChild(this);for(var t=0;t<this._achInfoSet.length;t++)e?this._achInfoSet[t].PlayMovie():this._achInfoSet[t].StopMovie()}},enumerable:!0,configurable:!0}),t.prototype._Updata=function(){for(var e=0;e<this._achInfoSet.length;e++)this._achInfoSet[e].Updata()},t.prototype._UpdataText=function(){if(this._achInfoSet)for(var e=0;e<this._achInfoSet.length;e++)this._achInfoSet[e].Updata()},t}(AWindow);AchievementWindow.IsOpenStar=!1,__reflect(AchievementWindow.prototype,"AchievementWindow");var ActiveBonusWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._groupSet=[],t._imageSet=[],t._countLabelSet=[],t.skinName="resource/game_skins/PlayGiftWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this);for(var t=0;5>t;t++)this._groupSet.push(this["_gourp"+t]),this._imageSet.push(this["_image"+t]),this._countLabelSet.push(this["_countLabel"+t]),this._groupSet[t].visible=!1;null!=this._bonus&&this.Show(this._name,this._bonus)},t.prototype._OnClick=function(){this.IsVisibled=!1},t.prototype.Show=function(e,t){if(!this._isCreated)return this._bonus=t,this._name=e,void(this.IsVisibled=!0);this.IsVisibled=!0,this._bonus=null;var e="";if(this._nameLabel.text=e,null!=t){for(var i=0;i<this._groupSet.length;i++)this._groupSet[i].visible=!1;for(var n=0,i=0;i<t.length&&5>i;i++){this._groupSet[i].visible=!0;var a=t[i],r=a.type;if("M"==r)this._imageSet[n].source="fenxiang_jinbi_png",this._countLabelSet[n].text=a.num;else if("I"==r||"C"==r){var o=ItemManager.GetItemByID(ItemManager.GetXID(r,a.id));null!=o&&(this._imageSet[n].source=o.ImageRes,this._countLabelSet[n].text=a.num,ItemManager.AddItem(ItemManager.GetXID(r,a.id),a.num))}else"A"==r?(this._imageSet[n].source="fenxiang_daoju_tili_png",this._countLabelSet[n].text=a.num):"D"==r?(this._imageSet[n].source="fenxiang_jifen_png",this._countLabelSet[n].text=a.num):"V"==r&&(this._imageSet[n].source="fenxiang_daoju_viptian_png",this._countLabelSet[n].text=a.num);n+=1}if(n>0&&6>n)for(var s=[[[265,529]],[[194,529],[336,529]],[[122,529],[265,529],[407,529]],[[194,464],[336,464],[194,592],[363,593]],[[122,464],[265,464],[407,464],[194,592],[336,592]]],u=s[n-1],i=0;i<u.length;i++)this._groupSet[i].x=u[i][0],this._groupSet[i].y=u[i][1]}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.MainTopLayer.addChild(this):Main.MainTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(ActiveBonusWindow.prototype,"ActiveBonusWindow");var GuoQingActiveWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/GuoQingSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._button1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick1,this),this._button2.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick2,this),this._image1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnenRoleDetail,this),this._image2.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnenRoleDetail,this)},t.prototype._UpdataText=function(){this._textLabel.text=StringMgr.GetText("guoqinguitext1")},t.prototype._OnCloseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},t.prototype._OnenRoleDetail=function(e){SoundManager.PlayButtonMusic();var t=WindowManager.RoleDetailWindow(),i=e.target==this._image1?UnitManager.GetRole(UnitManager.ZuoZuID):UnitManager.GetRole(UnitManager.XiaoYingID);t.UpdataShow(i),t.IsVisibled=!0},t.prototype._OnButtonClick1=function(){SoundManager.PlayButtonMusic();var e=UnitManager.GetRole(UnitManager.MingRenID),t=UnitManager.GetRole(UnitManager.ZuoZuID);e.Level>=3&&!t.IsHave&&NetManager.SendRequest(["func="+NetNumber.ActiveBonus+"&type=3"],this._ReceiveActiveBonus.bind(this))},t.prototype._OnButtonClick2=function(){SoundManager.PlayButtonMusic();var e=UnitManager.GetRole(UnitManager.XiaoYingID),t=ActiveManager.GuoQingValue;!e.IsHave&&t>=100&&NetManager.SendRequest(["func="+NetNumber.ActiveBonus+"&type=2"],this._ReceiveActiveBonus.bind(this))},t.prototype._ReceiveActiveBonus=function(e){var t=e.code;if(t==NetManager.SuccessCode&&null!=e.data&&null!=e.data.bonus){var i=StringMgr.GetText("guoqinguitext2");null!=WindowManager.ActiveBonusWindow()?this._ShowActiveGift([i,e.data.bonus]):WindowManager.SetWindowFunction(this._ShowActiveGift,[i,e.data.bonus],WindowManager.ActiveBonusWindow)}},t.prototype._ShowActiveGift=function(e){WindowManager.ActiveBonusWindow().Show(e[0],e[1]),WindowManager.GuoQingActiveWindow()._UpdateShow()},t.prototype._UpdateShow=function(){var e=UnitManager.GetRole(UnitManager.MingRenID),t=UnitManager.GetRole(UnitManager.ZuoZuID),i=UnitManager.GetRole(UnitManager.XiaoYingID),n=ActiveManager.GuoQingValue,a=StringMgr.GetText("guoqinguitext3");this._label1.text=a+e.Level+"/3",this._label2.text=a+n+"/100RMB";var r=UnitManager.FuwuduanTime;r>=1507478400?(this._button1.enabled=!1,this._button1.visible=!0,this._button2.enabled=!1,this._button2.visible=!0,this._getImage1.visible=!1,this._getImage2.visible=!1):1506787200>r?(this._button1.enabled=!1,this._button1.visible=!0,this._button2.enabled=!1,this._button2.visible=!0,this._getImage1.visible=!1,this._getImage2.visible=!1):(null!=t&&(!t.IsHave&&e.Level>=3?(this._button1.enabled=!0,this._button1.visible=!0,this._getImage1.visible=!1,ItemManager.GetItemCount(t.Pieceid)>=10&&(this._button1.enabled=!1,this._button1.visible=!1,this._getImage1.visible=!0)):e.Level<3?(this._button1.enabled=!1,this._button1.visible=!0,this._getImage1.visible=!1):(this._button1.enabled=!1,this._button1.visible=!1,this._getImage1.visible=!0)),null!=i&&(!i.IsHave&&n>=100?(this._button2.enabled=!0,this._button2.visible=!0,this._getImage2.visible=!1,ItemManager.GetItemCount(i.Pieceid)>=10&&(this._button2.enabled=!1,this._button2.visible=!1,this._getImage2.visible=!0)):100>n?(this._button2.enabled=!1,this._button2.visible=!0,this._getImage2.visible=!1):(this._button2.enabled=!1,this._button2.visible=!1,this._getImage2.visible=!0)))},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._UpdateShow()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(GuoQingActiveWindow.prototype,"GuoQingActiveWindow");var GuoQingSceneWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/GuoQingSceneSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._button1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this._button2.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this._button3.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this._getButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnGetButtonClick,this)},t.prototype._OnCloseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},t.prototype._OnButtonClick=function(){return SoundManager.PlayButtonMusic(),this.IsVisibled=!1,null!=WindowManager.GuoQingActiveWindow()?void this._OpenGuoQingActive():void WindowManager.SetWindowFunction(this._OpenGuoQingActive.bind(this))},t.prototype._OpenGuoQingActive=function(){WindowManager.GuoQingActiveWindow().IsVisibled=!0},t.prototype._OnGetButtonClick=function(){if(SoundManager.PlayButtonMusic(),!UnitStatusMgr.IsUnlockNinjaScene){var e=UnitManager.GetRole(UnitManager.MingRenID),t=UnitManager.GetRole(UnitManager.ZuoZuID),i=UnitManager.GetRole(UnitManager.XiaoYingID),n=Math.floor((new Date).getTime()/1e3);1507478400>n&&!UnitStatusMgr.IsUnlockNinjaScene&&e.IsHave&&t.IsHave&&i.IsHave&&NetManager.SendRequest(["func="+NetNumber.NinjaSceneUnlock],this._ReceiveUnlock.bind(this))}},t.prototype._ReceiveUnlock=function(e){var t=e.code;if(t!=NetManager.SuccessCode){var i="";return 102==t?i=StringMgr.GetText("guoqinguitext4"):(t=103)&&(i=StringMgr.GetText("guoqinguitext5")),void PromptManager.CreatCenterTip(!1,!1,i)}var n="changjinghuode_cj_huoying_png";null!=WindowManager.RoleGetPage()?this._ShowGetWinodw([n]):WindowManager.SetWindowFunction(this._ShowGetWinodw.bind(this),[n])},t.prototype._ShowGetWinodw=function(e){WindowManager.RoleGetPage().ShowImage(e[0]),this.IsVisibled=!1},t.prototype._UpdateShow=function(){var e=UnitManager.GetRole(UnitManager.MingRenID),t=UnitManager.GetRole(UnitManager.ZuoZuID),i=UnitManager.GetRole(UnitManager.XiaoYingID),n=Math.floor((new Date).getTime()/1e3);this._image1.visible=e.IsHave,this._button1.visible=!this._image1.visible,this._image2.visible=t.IsHave,this._button2.visible=!this._image2.visible,this._image3.visible=i.IsHave,this._button3.visible=!this._image3.visible,n>=1507478400?this._getButton.enabled=!1:!UnitStatusMgr.IsUnlockNinjaScene&&e.IsHave&&t.IsHave&&i.IsHave?this._getButton.enabled=!0:this._getButton.enabled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._UpdateShow()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(GuoQingSceneWindow.prototype,"GuoQingSceneWindow");var GameRole=function(e){function t(){var i=e.call(this)||this;return i._id=0,i._isJump=!1,i._mapMoveMark=!1,i._isDie=!1,i._moveIndex=0,i._currentRoadType=1,i._reviveTime=-1,i._isDestroy=!1,i._wudiTime=5e3,i._friSpeed=280,i._canJump=!0,i._skillAniZhenSet=[],i._skillAniCeSet=[],i._isRevive=!1,i._change=!1,i._isFly=!1,i._changeType=-1,i._isPassHole=!1,i._id=t.GameRoleID+=1,i}return __extends(t,e),t.prototype.CreateRole=function(e){void 0===e&&(e="");var t=""==e?UnitManager.CurrentRole.Res:e;this._jxdArm=ArmaturePool.GetArmature(t+"_01_json",t+"_01texture_json",t+"_01texture_png",t+"_01"),this._jxdDis=this._jxdArm.display,this._jxdDis.x=0,this._jxdDis.y=0,this._jxdSizeArm=ArmaturePool.GetArmature(t+"_02_json",t+"_02texture_json",t+"_02texture_png",t+"_02"),this._jxdSizeDis=this._jxdSizeArm.display,this._jxdSizeDis.x=0,this._jxdSizeDis.y=0,this._PlayMovie("walk",0),this.addChild(this._jxdDis),this.addChild(this._jxdSizeDis),this._change=!1,this._isRevive=!1,this._canJump=!0,this._isFly=!1,this._prop=null},t.prototype._UpdataRole=function(e,i){if(this._roleStarX=e,this._roleEndX=i,Math.abs(e-i)<=Game.PianchaNum?(this._isFly?(this._jxdDis.visible=!1,this._jxdSizeDis.visible=!1,this._prop&&(this._prop.animation.play("chupeng",0),this._prop.display.scaleX=1)):(null!=this._prop&&(this._prop.display.visible=!1),this._jxdDis.visible=!0,this._jxdSizeDis.visible=!1),this._direction=0,this._mapMoveMark&&(t.IsDirect=!0)):i>e?(this._jxdSizeDis.scaleX=1,this._isFly?(this._jxdDis.visible=!1,this._jxdSizeDis.visible=!1,this._prop&&(this._prop.animation.play("chupeng1",0),this._prop.display.scaleX=1)):(null!=this._prop&&(this._prop.display.visible=!1),this._jxdDis.visible=!1,this._jxdSizeDis.visible=!0),this._direction=2,this._mapMoveMark&&(t.IsDirect=!1)):e>i&&(this._jxdSizeDis.scaleX=-1,this._isFly?(this._jxdDis.visible=!1,this._jxdSizeDis.visible=!1,this._prop&&(this._prop.animation.play("chupeng1",0),this._prop.display.scaleX=-1)):(null!=this._prop&&(this._prop.display.visible=!1),this._jxdDis.visible=!1,this._jxdSizeDis.visible=!0),this._direction=1,this._mapMoveMark&&(t.IsDirect=!1)),this._skillAniZhenSet.length>0)for(var n=this._skillAniZhenSet.length-1;n>=0;n--)this._skillAniZhenSet[n].display.visible=this._jxdDis.visible;if(this._skillAniCeSet.length>0)for(var n=this._skillAniCeSet.length-1;n>=0;n--)this._skillAniCeSet[n].display.visible=this._jxdSizeDis.visible,this._skillAniCeSet[n].display.scaleX=this._jxdSizeDis.scaleX},Object.defineProperty(t.prototype,"Road",{get:function(){return this._road},set:function(e){this._road=e,this._moveRoad=e.MoveRoad,this._roadTypeSet=e.RoadType,this._doorTypeSet=e.DoorTypeSet},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveRoad",{get:function(){return this._moveRoad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Map",{get:function(){return this._map},set:function(e){this._map=e},enumerable:!0,configurable:!0}),t.prototype.Move=function(){var e=this;this._moveIndex<0&&(this._moveIndex=0);var i=new egret.Point(this.x,this.y);if(this._moveIndex>=this._moveRoad.length){if(t.IsFriend){var n=new egret.Point(i.x,1216),a=Math.sqrt(Math.pow(n.y-i.y,2)+Math.pow(n.x-i.x,2)),r=this._friSpeed,o=a/r*1e3,s=egret.Tween.get(this);this._jxdDis.visible=!0,this._jxdSizeDis.visible=!1,s.to({x:n.x,y:n.y},o)}}else{var u=this._moveRoad[this._moveIndex],n=new egret.Point(u.x,u.y+this._map.y);if(this._isRevive&&n.y<=i.y)return this._isRevive=!1,this._moveIndex+=1,void this.Move();this._isRevive=!1,this._UpdataRole(i.x,u.x);var l=this._roadTypeSet[this._moveIndex],h=this._doorTypeSet[this._moveIndex];if(1!=this._currentRoadType){if(2==this._currentRoadType&&this._CheckEnd(!0))return void Game.Instance.UpdataRoleMoveMark();if(2==this._currentRoadType&&t.IsFriend?Math.sqrt(Math.pow(n.y-i.y,2)+Math.pow(n.x-i.x,2))>80?(this._PlayMovie("jump_01",1),this._friStatus=1,egret.setTimeout(function(){e._PlayMovie("jump_03",1)},this,150),egret.setTimeout(function(){e._PlayMovie("jump_02",1)},this,500),egret.setTimeout(function(){e._friStatus=0,e._PlayMovie("walk",0)},this,700)):(this._PlayMovie("jump_01",1),this._friStatus=1,egret.setTimeout(function(){e._PlayMovie("jump_05",1)},this,150),egret.setTimeout(function(){e._PlayMovie("jump_02",1)},this,400),egret.setTimeout(function(){e._friStatus=0,e._PlayMovie("walk",0)},this,500)):2==this._currentRoadType&&(UnitManager.CurrentRole.JumpAction(),this._isPassHole=!0),4==this._currentRoadType)return Game.Instance.JumpDis=n.y-this.y,this._map.EnterDoorOpen(h),Game.RoleStatus=0,this._isJump=!1,this._currentRoadType=l,Game.Instance.CreateRole(h),this.x=n.x,this.y=n.y,this._moveIndex+=1,this._PlayMovie("walk",0),void this.Move();if(6==this._currentRoadType&&Game.Instance.RoleConfluence(this,this._currentRoadType))return void(Game.Instance.JumpDis=3)}if(!this._isDie){this._currentRoadType=l;var a=Math.sqrt(Math.pow(n.y-i.y,2)+Math.pow(n.x-i.x,2));if(t.IsFriend)if(0!=this._friStatus)var r=(this._friSpeed-100)*(0==this._direction?1:.8333333);else var r=this._friSpeed*(0==this._direction?1:.8333333);else var r=Game.MoveSpeed*(0==this._direction?1:.8333333);var o=a/r*1e3,s=egret.Tween.get(this);s.to({x:n.x,y:n.y},o).call(this.Move),this._mapMoveMark&&this._CheckMapMove(n.y-i.y,o),this._moveIndex+=1,this._moveIndex>=this._moveRoad.length&&!t.IsFriend&&Game.Instance.RoleUpdataMap(this,this._map)&&(this._moveIndex=0)}}},t.prototype._CheckMapMove=function(e,t){if(null!=this.parent){var i=this.parent.parent;this.y+i.y>=Game.RoleYLimit&&(e+=this.y+i.y-Game.RoleYLimit,Game.Instance.MapMove(e,t))}},t.prototype._CheckEnd=function(e){if(this._reviveTime>0)return!1;var t=!1;return this._isFly?!1:(e&&2==this._currentRoadType&&0==Game.RoleStatus?t=Game.Instance.CheckGameEnd(this):e||3!=this._currentRoadType||0!=Game.RoleStatus||(t=Game.Instance.CheckGameEnd(this)),t)},t.prototype.RoleJump=function(){this._canJump&&(this._RemoveRoleEvent(),this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnSmallJumpEnd,this),this._PlayMovie("jump_01",1),SoundManager.PlayMusic(UnitManager.CurrentRole.SmallJumpMusic),this._isJump=!0,Game.RoleStatus=1)},t.prototype._OnSmallJumpEnd=function(){this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSmallJumpEnd,this),2==Game.RoleStatus?(this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._PlayMovie("jump_03",1),SoundManager.PlayMusic(UnitManager.CurrentRole.BigJumpMusic)):0==Game.RoleStatus?(t.RoleCanJump=!0,this._isJump=!1,this._PlayMovie("walk",0),this._CheckEnd(!1)):(this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnSamllJumpHalfEnd,this),this._PlayMovie("jump_05",1))},t.prototype.Stop=function(){this._jxdArm.animation.stop(),this._jxdSizeArm.animation.stop(),this._RemoveRoleEvent()},t.prototype._RemoveRoleEvent=function(){this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSmallJumpEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSamllJumpHalfEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnReviveEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this.Revive,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnMergeEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._GameEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._DieEnd,this)},t.prototype._OnSamllJumpHalfEnd=function(e){t.RoleCanJump=!1,this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSamllJumpHalfEnd,this),2==Game.RoleStatus?(this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._PlayMovie("jump_06",1),SoundManager.PlayMusic(UnitManager.CurrentRole.BigJumpMusic)):0==Game.RoleStatus?(t.RoleCanJump=!0,this._isJump=!1,this._PlayMovie("walk",0),this._CheckEnd(!1)):(this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._PlayMovie("jump_02",1))},t.prototype._OnJumpEnd=function(e){t.RoleCanJump=!0,this._isPassHole&&!this._isFly&&(1==Game.RoleStatus?WindowManager.GameUI().Energy+=GameConstData.EnergySmall:2==Game.RoleStatus&&(WindowManager.GameUI().Energy+=GameConstData.EnergyBig)),this._isPassHole=!1,Game.RoleStatus=0,this._isJump=!1,this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._PlayMovie("walk",0),this._CheckEnd(!1)},t.prototype.Die=function(e,i,n){return void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=5e3),this._isFly?void this.Move():(this._isPassHole=!1,this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnJumpEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSmallJumpEnd,this),this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnSamllJumpHalfEnd,this),this._isDie=!0,this._canJump=!1,this._wudiTime=n,egret.Tween.removeTweens(this),void(e&&!i?(this._isFly&&(this._isFly=!1,this._UpdataRole(this._roleStarX,this._roleEndX),null!=this._prop&&(ArmaturePool.ReturnPool(this._prop),this._prop=null)),Game.GameStatus=!1,this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._GameEnd,this),t.RoleIsDie=!0,Game.Instance.ChangeSize(this.localToGlobal(),!0),this._PlayMovie("die1",1),SoundManager.PlayMusic(UnitManager.CurrentRole.DieMusic)):i?(Game.GameStatus=!1,this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this.Revive,this),t.RoleIsDie=!0,this._PlayMovie("die2",1),SoundManager.PlayMusic(UnitManager.CurrentRole.DieMusic)):(this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._DieEnd,this),this._PlayMovie("die2",1))))},t.prototype._DieEnd=function(){this.Destroy(),t.RoleIsDie=!1},t.prototype._GameEnd=function(){this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._GameEnd,this),t.RoleIsDie=!1,t.LastRole=this;var e=egret.Tween.get(this);e.wait(800).call(this._GameRealEnd,this)},t.prototype._GameRealEnd=function(){egret.Tween.removeTweens(this),UnitManager.CurrentRole.DeadAction(),!CheckpointManager.IsEndless&&!CheckpointManager.IsDailyActive&&UnitManager.CurrentRole.CurrentLife>0||(WindowManager.ReviveWindow().IsVisibled=!0)},t.prototype.Destroy=function(){this._isDestroy=!0,this._RemoveRoleEvent(),egret.Tween.removeTweens(this),ArmaturePool.ReturnPool(this._jxdArm),ArmaturePool.ReturnPool(this._jxdSizeArm),null!=this.parent&&this.parent.removeChild(this)},t.prototype.Disappear=function(){this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnMergeEnd,this);var e=this._isJump?"merge2":"merge1";this._PlayMovie(e,1)},t.prototype._OnMergeEnd=function(){this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnMergeEnd,this),this.Destroy()},Object.defineProperty(t.prototype,"MapMoveMark",{set:function(e){this._mapMoveMark=e},enumerable:!0,configurable:!0}),t.prototype._PlayMovie=function(e,t){if(this._isDestroy)return void Main.AddDebug("资源已销毁");if(this._jxdArm.animation.play(e,t),this._jxdSizeArm.animation.play(e,t),this._skillAniZhenSet.length>0)for(var i=this._skillAniZhenSet.length-1;i>=0;i--)this._skillAniZhenSet[i].animation.play(e,t);if(this._skillAniCeSet.length>0)for(var i=this._skillAniCeSet.length-1;i>=0;i--)this._skillAniCeSet[i].animation.play(e,t);null!=this._reviveMovie&&this._reviveMovie.animation.play(e,t)},t.prototype.Process=function(e){if(!t.IsFriend){var i=this._road.ObjectSet;if(null!=i&&i.length>0)for(var n=0;n<i.length;n++){var a=i[n];if(this.y-a.y>=0&&this.y-a.y<15&&Math.abs(this.x-a.x)<15&&0==Game.RoleStatus&&!this._isFly){a.Trigger(this),this._road.SpliceObject(n);break}if(a.y>this.y)break}if(this._reviveTime>0)if(this._reviveTime-=e,this._reviveTime<=0)this.removeChild(this._reviveMovie.display),this._reviveMovie.animation.stop(),egret.Tween.removeTweens(this._reviveMovie.display),ArmaturePool.ReturnPool(this._reviveMovie),this._reviveMovie=null;else if(this._reviveTime<=2e3){var r=egret.Tween.get(this._reviveMovie.display,{loop:!0});r.to({alpha:0},200).to({alpha:1},200)}}},t.prototype.ChangeStatus=function(e,t){var i=this;if(void 0===e&&(e=0),void 0===t&&(t=0),this._isDie)return void(2==e&&(this._changeType=e));if(this._changeType=-1,0==e){var n=Math.random();e=.4>=n?2:n>.4&&.8>=n?1:3}this._role=WindowManager.GameUI().Role;var a=null==CheckpointManager.CurrentCheckpoint?1:CheckpointManager.CurrentCheckpoint.Difficulty,r=new egret.Point(this.localToGlobal().x,this.localToGlobal().y);if(1==e){var o=-(.1*this._role.MaxLife+100*a)*(1-this._role.InjuryFreeRate);0!=t&&(o=t),WindowManager.GameUI().BuckleBlood(o,r)}else 3==e&&null==this._reviveMovie&&WindowManager.GameUI().BuckleBlood(500*(1-this._role.RealLucky)*a*(1-this._role.InjuryFreeRate),r);if(!this._change){var s=0,u=null;2==e?(u=ArmaturePool.GetArmature("jixiaode_zhifeiji_json","jixiaode_zhifeijitexture_json","jixiaode_zhifeijitexture_png","jixiaode_zhifeiji"),this._isFly=!0,this._UpdataRole(this._roleStarX,this._roleEndX),s=3500):1==e?(u=ArmaturePool.GetArmature("jixiaode_buxue_json","jixiaode_buxuetexture_json","jixiaode_buxuetexture_png","jixiaode_buxue"),s=600):4==e?(u=ArmaturePool.GetArmature("hudun_json","huduntexture_json","huduntexture_png","hudun"),s=5e3):(u=ArmaturePool.GetArmature("jixiaode_zhadan_json","jixiaode_zhadantexture_json","jixiaode_zhadantexture_png","jixiaode_zhadan"),s=600),null!=u&&(this._prop=u,this._change=!0,this.addChild(u.display),u.display.x=0,u.display.y=0,u.display.visible=!0,u.animation.play("huode",1),this._huoDeTimeOut=egret.setTimeout(function(){i._prop.animation.stop(),2==e?i._UpdataRole(i._roleStarX,i._roleEndX):i._prop.animation.play("chupeng",1),i._chupengTimeOut=egret.setTimeout(function(){i._isFly=!1,i._change=!1,null!=i._prop&&i.removeChild(i._prop.display),2==e&&(i.ReviveTime=1500),i._UpdataRole(i._roleStarX,i._roleEndX),ArmaturePool.ReturnPool(i._prop),i._prop=null,egret.clearTimeout(i._huoDeTimeOut),egret.clearTimeout(i._chupengTimeOut)},i,s)},this,150))}},t.prototype.creatSkillAni=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1),this._role=WindowManager.GameUI().Role;var i="",n="";this.clearSkillAni(),1==e?i=n="hudun":2==e?(i="mingrenyfs_01",n="mingrenyfs_02"):3==e?(i="zuozhuxz_01",n="zuozhuxz_02"):4==e&&(i="xiaoyingzy_01",n="xiaoyingzy_02");for(var a=0;t>a;a++){var r=ArmaturePool.GetArmature(i+"_json",i+"texture_json",i+"texture_png",i),o=ArmaturePool.GetArmature(n+"_json",n+"texture_json",n+"texture_png",n);if(this.addChild(r.display),this.addChild(o.display),1==t)o.display.x=r.display.x=0,o.display.y=r.display.y=0;else{var s=Math.random()*(2*Math.PI);o.display.x=r.display.x=50*Math.cos(s),o.display.y=r.display.y=50*Math.sin(s)}r.animation.play("walk"),o.animation.stop("walk"),this._skillAniZhenSet.push(r),this._skillAniCeSet.push(o)}},t.prototype.skillTimeOut=function(){if(this._skillAniZhenSet.length>0){for(var e=this._skillAniZhenSet.length-1;e>=0;e--)this._skillAniZhenSet[e].display.visible=!0,this._skillAniZhenSet[e].animation.play("walk",1);for(var e=this._skillAniCeSet.length-1;e>=0;e--)this._skillAniCeSet[e].display.visible=!0,this._skillAniCeSet[e].animation.play("walk",1)}},t.prototype.clearSkillAni=function(){if(this._skillAniZhenSet.length>0){for(var e=this._skillAniZhenSet.length-1;e>=0;e--)this.removeChild(this._skillAniZhenSet[e].display),ArmaturePool.ReturnPool(this._skillAniZhenSet[e]),this._skillAniZhenSet.splice(e,1);this._skillAniZhenSet=[]}if(this._skillAniCeSet.length>0){for(var e=this._skillAniCeSet.length-1;e>=0;e--)this.removeChild(this._skillAniCeSet[e].display),ArmaturePool.ReturnPool(this._skillAniCeSet[e]),this._skillAniCeSet.splice(e,1);this._skillAniCeSet=[]}this._UpdataRole(this._roleStarX,this._roleEndX),null!=this._skillTimeOut&&(egret.clearTimeout(this._skillTimeOut),this._skillTimeOut=null)},t.prototype.clearOneSkillAni=function(){null!=this._skillAniZhenSet[0]&&(this.removeChild(this._skillAniZhenSet[0].display),ArmaturePool.ReturnPool(this._skillAniZhenSet[0]),this._skillAniZhenSet.splice(0,1)),null!=this._skillAniCeSet[0]&&(this.removeChild(this._skillAniCeSet[0].display),ArmaturePool.ReturnPool(this._skillAniCeSet[0]),this._skillAniCeSet.splice(0,1)),0==this._skillAniZhenSet.length&&(this._UpdataRole(this._roleStarX,this._roleEndX),null!=this._skillTimeOut&&(egret.clearTimeout(this._skillTimeOut),this._skillTimeOut=null))},Object.defineProperty(t.prototype,"FenShenCount",{get:function(){return null==this._skillAniZhenSet?0:this._skillAniZhenSet.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Prop",{get:function(){return this._propState},set:function(e){this._propState=e},enumerable:!0,configurable:!0}),t.prototype.Revive=function(){t.IsFriend||(this._moveIndex-=1,this._jxdArm.hasEventListener(dragonBones.Event.COMPLETE)&&this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this.Revive,this),this._jxdArm.addEventListener(dragonBones.Event.COMPLETE,this._OnReviveEnd,this),this._PlayMovie("revive",1))},t.prototype._OnReviveEnd=function(){t.IsFriend||(this._jxdArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnReviveEnd,this),this._reviveTime=this._wudiTime,this._isDie=!1,Game.RoleStatus=0,t.RoleIsDie=!1,this._PlayMovie("walk",0),null!=WindowManager.EndWindow(!1)&&WindowManager.EndWindow().IsVisibled||(Game.GameStatus=!0,Game.Instance.UpdataRoleMoveMark(),this._isRevive=!0,this._canJump=!0,this._isFly=!1,-1!=this._changeType&&this.ChangeStatus(this._changeType),this.Move(),null==this._reviveMovie&&(this._reviveMovie=ArmaturePool.GetArmature("invincible_json","invincibletexture_json","invincibletexture_png","invincible"),this.addChildAt(this._reviveMovie.display,0),this._reviveMovie.animation.play("walk",0))))},Object.defineProperty(t.prototype,"ReviveTime",{get:function(){return t.IsFriend?void 0:this._reviveTime},set:function(e){t.IsFriend||(this._reviveTime=e,e>0&&null==this._reviveMovie&&(this._reviveMovie=ArmaturePool.GetArmature("invincible_json","invincibletexture_json","invincibletexture_png","invincible"),this.addChildAt(this._reviveMovie.display,0),this._reviveMovie.animation.play("invincible",0)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FriSpeed",{get:function(){return t.IsFriend?this._friSpeed:void 0},set:function(e){t.IsFriend&&(this._friSpeed=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FriStatus",{get:function(){return t.IsFriend?this._friStatus:void 0},set:function(e){t.IsFriend&&(this._friStatus=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsWuDi",{get:function(){return this._reviveTime>0?!0:!1
},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsDie",{get:function(){return this._isDie},enumerable:!0,configurable:!0}),t.prototype.Pause=function(){this._jxdArm.animation.stop(),this._jxdSizeArm.animation.stop(),egret.Tween.pauseTweens(this)},t.prototype.Continue=function(){this._jxdArm.animation.play(),this._jxdSizeArm.animation.play(),egret.Tween.resumeTweens(this)},t}(egret.DisplayObjectContainer);GameRole.RoleCanJump=!0,GameRole.RoleIsDie=!1,GameRole.IsDirect=!0,GameRole.IsFriend=!1,GameRole.GameRoleID=1e5,__reflect(GameRole.prototype,"GameRole");var BagPage=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._id=-1,t.width=134,t.height=171,t.skinName="resource/game_skins/BagPageSkins.exml",t.addEventListener(egret.TouchEvent.TOUCH_TAP,t._OnClick,t),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,-1!=this._id&&this.SetData(this._id)},t.prototype._OnClick=function(){WindowManager.UseItemTip().Show(this._id)},t.prototype.SetData=function(e){if(!this._isCreated)return void(this._id=e);var t=ItemManager.GetItemByID(e);if(null==t)return void Main.AddDebug("找不到物品，物品ID："+e);this._id=e,this._itemImage.source=t.ImageRes;var i=ItemManager.GetItemCount(e);this._countLabel.text=i.toString()},t}(eui.Component);__reflect(BagPage.prototype,"BagPage");var BagWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._bagPageSet=[],t._bagShowPageSet=[],t.skinName="resource/game_skins/BagWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var i=new eui.RadioButtonGroup;i.addEventListener(egret.Event.CHANGE,this._UpdatePage,this),this._allRadio.group=i,this._allRadio.value=t._ALL,this._itemRadio.group=i,this._itemRadio.value=t._ITEM,this._debrisRadio.group=i,this._debrisRadio.value=t._DEBRIS,GameEvent.AddEventListener(EventType.UseItem,this._UpdatePage,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._itemRadio.skinName=SkinCreateMgr.CreateRadioButton("fenye_daoju_on"+e+"_png","fenye_daoju_off"+e+"_png"),this._allRadio.skinName=SkinCreateMgr.CreateRadioButton("fenye_quanbu_on"+e+"_png","fenye_quanbu_off"+e+"_png"),this._debrisRadio.skinName=SkinCreateMgr.CreateRadioButton("fenye_suipian_on"+e+"_png","fenye_suipian_off"+e+"_png"),this._itemRadio.selected=!1,this._allRadio.selected=!0,this._UpdatePage()},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._itemRadio.selected=!1,this._allRadio.selected=!0,this._UpdatePage()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._UpdatePage=function(e){void 0===e&&(e=null);var i=t._ALL;if(null!=e){var n=e.target;i=n.selectedValue}for(;this._bagShowPageSet.length>0;){var a=this._bagShowPageSet.shift();this._itemGroup.removeChild(a),this._bagPageSet.push(a)}var r=ItemManager.GetItemIDSet();if(null!=r&&0!=r.length)for(var o=0,s=0;s<r.length;s++){var u=r[s],l=ItemManager.GetItemByID(u);if(null!=l&&(i!=t._ITEM||l.IsItem)&&(i!=t._DEBRIS||l.IsDebris)){var a=this._bagPageSet.length>0?this._bagPageSet.shift():new BagPage;a.SetData(u);var h=o%4,c=Math.floor(o/4);a.x=h*a.width+1*h,a.y=c*a.height+8*c,this._itemGroup.addChild(a),this._bagShowPageSet.push(a),o+=1}}},t}(AWindow);BagWindow._ALL=1,BagWindow._ITEM=2,BagWindow._DEBRIS=3,__reflect(BagWindow.prototype,"BagWindow");var UseItemTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._id=-1,t._useCount=0,t.skinName="resource/game_skins/BagTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._useOneButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUseOneClick,this),this._useAllButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUseAllClick,this),this._useButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUseClick,this),this._isCreated=!0,-1!=this._id&&this.Show(this._id)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._textLabel1.text=StringMgr.GetText("bagtiptext1"),this._textLabel2.text=StringMgr.GetText("bagtiptext2"),this._textLabel3.text=StringMgr.GetText("bagtiptext3"),this._useButton.skinName=SkinCreateMgr.CreateButton("beibao_an_qushiyong_l"+e+"_png","beibao_an_qushiyong_a"+e+"_png"),this._useOneButton.skinName=SkinCreateMgr.CreateButton("beibao_an_shiyong1ge_l"+e+"_png","beibao_an_shiyong1ge_a"+e+"_png"),this._useAllButton.skinName=SkinCreateMgr.CreateButton("beibao_an_quanbushiyong_l"+e+"_png","beibao_an_quanbushiyong_a"+e+"_png")},t.prototype._OnCloseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},t.prototype.Show=function(e){if(this._id=e,!this._isCreated)return void(this.IsVisibled=!0);this.IsVisibled=!0;var t=ItemManager.GetItemByID(e);if(null==t)return Main.AddDebug("物品为空，物品ID："+e),void(this.IsVisibled=!1);var i=ItemManager.GetItemCount(e);this._itemImage.source=t.ImageRes,this._nameLabel.text=t.Name,this._descLabel.text=t.Desc,this._countLabel.text=i.toString(),40022==e||40023==e?(this._buttonGroup.visible=!0,this._useButton.visible=!1):(this._buttonGroup.visible=!1,this._useButton.visible=!0)},t.prototype._OnUseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1;var e=ItemManager.GetItemByID(this._id);if(null!=e&&(e.ID==ItemManager.ReviveItemID&&WindowManager.StarWindow().CloseWindow(),e.IsDebris)){if(null==WindowManager.RoleWindow())return void WindowManager.SetWindowFunction(this._OpenRole.bind(this));this._OpenRole()}},t.prototype._OpenRole=function(){WindowManager.StarWindow().OpenWindow(WindowManager.RoleWindow())},t.prototype._OnUseOneClick=function(){return SoundManager.PlayButtonMusic(),(22==this._id||23==this._id)&&UnitManager.Player.Physical>=UnitManager.Player.MaxPhysical?void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("bagtiptext4")):void this._UseItem()},t.prototype._OnUseAllClick=function(){if(SoundManager.PlayButtonMusic(),(22==this._id||23==this._id)&&UnitManager.Player.Physical>=UnitManager.Player.MaxPhysical)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("bagtiptext4"));var e=ItemManager.GetItemCount(this._id);this._UseItem(e)},t.prototype._UseItem=function(e){if(void 0===e&&(e=1),0==e)return PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("bagtiptext5")),void GameEvent.DispatchEvent(EventType.UseItem);this._useCount=e;var t=JSON.parse("{}");t.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.UseItem+"&id="+this._id+"&num="+e+"&oemInfo="+JSON.stringify(t)],this._UseItemReturn.bind(this))},t.prototype._UseItemReturn=function(e){if(e.code!=NetManager.SuccessCode)return void Main.AddDebug("购买直接使用物品失败，商品ID："+this._id);ItemManager.UseItem(this._id,this._useCount),GameEvent.DispatchEvent(EventType.UseItem);var t=ItemManager.GetItemCount(this._id);0==t&&(this.IsVisibled=!1)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(UseItemTip.prototype,"UseItemTip");var CheckPage=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t.height=147,t.skinName="resource/game_skins/CheckPointSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._starImageSet=[];for(var t=0;3>t;t++)this._starImageSet.push(this["_starImage"+t]);this._rushButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._StartGame,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._ChooseCheck,this),this._isCreated=!0,this.Show(this._checkpointID),GameEvent.AddEventListener(EventType.CheckpointStarUpdata,this._UpdataStar,this),GameEvent.AddEventListener(EventType.ChooseCheckPonit,this.UpdateRoleShow,this),GameEvent.AddEventListener(EventType.CheckpointPass,this.UpdateJieSuoShow,this),GameEvent.AddEventListener(EventType.StartCheckPassAni,this.StartCheckPassAni,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._checkpointIDLabel.font="guanqianum"+e+"_fnt",this._rushButton.skinName=SkinCreateMgr.CreateButton("zhujiemianxg_an_kaishi_l"+e+"_png","zhujiemianxg_an_kaishi_a"+e+"_png")},t.prototype._ChooseCheck=function(e){2!=GuideManager.GuideID&&(CheckpointManager.ChooseCheckPointId=this._checkpointID,this.UpdateRoleShow(),3==GuideManager.GuideID&&GuideManager.GuideFinish(3))},t.prototype.UpdateRoleShow=function(){this._isCreated&&(CheckpointManager.ChooseCheckPointId==this._checkpointID?this.chooseAni():this._canRushGroup.visible=!1)},t.prototype.chooseAni=function(){0==this._canRushGroup.visible&&(this._canRushGroup.visible=!0,this._canRushGroup.anchorOffsetX=this._canRushGroup.width/2,this._canRushGroup.anchorOffsetY=this._canRushGroup.height/2,this._canRushGroup.scaleX=0,this._canRushGroup.scaleY=0,this._canRushGroup.y=130,egret.Tween.get(this._canRushGroup).to({scaleX:1,scaleY:1},200))},t.prototype.UpdateJieSuoShow=function(){if(this._isCreated){this._checkpoint=CheckpointManager.GetCheckpointByID(this._checkpointID);var e=this._checkpoint.CanChallenge;e?(this.touchEnabled=!0,this.touchChildren=!0,this._noJieSuoIma.visible=!1,this._jiesuoGroup.visible=!0):(this._noJieSuoIma.visible=!0,this._jiesuoGroup.visible=!1,this.touchEnabled=!1,this.touchChildren=!1)}},t.prototype.StartCheckPassAni=function(){if(this._isCreated&&CheckpointManager.CurrentCheckpointID==CheckpointManager.MaxCheckpointID&&CheckpointManager.MaxCheckpointID+1==this._checkpointID&&this._checkpoint.CanChallenge){this._noJieSuoIma.visible=!1,this._jiesuoGroup.visible=!1,this._jiesuoAni=new egret.MovieClip;var e=this._checkpointID%5==0?"zhujiemianxg_guankadh2":"zhujiemianxg_guankadh1";this._jiesuoAni.movieClipData=MovieManager.GetMovieClipData(e+"_json",e+"_png",e),this._jiesuoAni.x=90,this._jiesuoAni.y=150,this._jiesuoAni.play(1),this.addChild(this._jiesuoAni),this._jiesuoAni.addEventListener(egret.Event.COMPLETE,this._MovieEnd,this)}},t.prototype._MovieEnd=function(){try{this._jiesuoAni.stop(),this.removeChild(this._jiesuoAni),this._jiesuoAni.removeEventListener(egret.Event.COMPLETE,this._MovieEnd,this),this._jiesuoAni=null}catch(e){console.log(e)}this.Show(this._checkpointID)},t.prototype._UpdataStar=function(){if(this._checkpoint=CheckpointManager.GetCheckpointByID(this._checkpointID),this._curStarNum!=this._checkpoint.Star){this._curStarNum=this._checkpoint.Star;for(var e=0;e<this._starImageSet.length;e++)this._starImageSet[e].source=e<this._curStarNum?"zhujiemianxg_xing_on_png":"zhujiemianxg_xing_off_png"}},t.prototype.Show=function(e){if(this._checkpointID=e,this._isCreated){if(this._checkpoint=CheckpointManager.GetCheckpointByID(e),null==this._checkpoint)return void Main.AddDebug("关卡列表关卡为空，关卡ID："+e);this._curStarNum=this._checkpoint.Star;for(var t=0;t<this._starImageSet.length;t++)this._starImageSet[t].source=t<this._curStarNum?"zhujiemianxg_xing_on_png":"zhujiemianxg_xing_off_png";this._checkpointIDLabel.text="g"+this._checkpoint.ID,""!=this._checkpoint.RewardImage?(this._rewardImage.source=this._checkpoint.RewardImage,this._rewardGroup.visible=!0):this._rewardGroup.visible=!1,this._tiliLabel.text="-"+this._checkpoint.ConsumePhy,this._bgIma.source=e%5==0?"zhujiemianxg_guanka2_png":"zhujiemianxg_guanka1_png",this._noJieSuoIma.source=e%5==0?"zhujiemianxg_guanka2_d_png":"zhujiemianxg_guanka1_d_png";var i=this._checkpoint.CanChallenge;i?(this.touchEnabled=!0,this.touchChildren=!0):(this.touchEnabled=!1,this.touchChildren=!1),this.UpdateRoleShow(),this.UpdateJieSuoShow()}},t.prototype._StartGame=function(){return GuideManager.IsGuide&&GuideManager.GuideID<5?void 0:(GuideManager.IsGuide&&5==GuideManager.GuideID&&GuideManager.GuideFinish(5),GuideManager.IsGuide&&6==GuideManager.GuideID&&GuideManager.GuideFinish(6),CheckpointManager.CurrentCheckpointID=this._checkpointID,null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(this._OpenRoleSelect.bind(this)):void this._OpenRoleSelect())},t.prototype._OpenRoleSelect=function(){WindowManager.RoleSelectWindow().IsVisibled=!0},Object.defineProperty(t.prototype,"RolePosi",{get:function(){return[89,20]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkId",{get:function(){return this._checkpointID},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(CheckPage.prototype,"CheckPage");var RaidEndWindow=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._isVisibled=!1,t._groupSet=[],t._imageSet=[],t._labelSet=[],t.skinName="resource/game_skins/RaidEndSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this);for(var t=1;2>=t;t++)this._groupSet.push(this["_awardGroup"+t]),this._imageSet.push(this["_image"+t]),this._labelSet.push(this["_label"+t]);this._isCreated=!0,null!=this._bonus&&this.Show(this._bonus)},t.prototype._OnClick=function(){this.IsVisibled=!1},t.prototype.Show=function(e){if(void 0===e&&(e=null),this._bonus=e,!this._isCreated)return void(this.IsVisibled=!0);this.IsVisibled=!0;for(var t=0;t<this._groupSet.length;t++)this._groupSet[t].visible=!1;var i=0;if(null!=e)for(var n=PromptManager.GetBonusResData(e,!0),t=0;t<n.length&&(this._imageSet[i].source=n[t].res,this._labelSet[i].text=n[t].name+" X"+n[t].num,this._groupSet[i].visible=!0,i+=1,!(i>=this._groupSet.length));t++);this._awardGroup2.visible?(this._bg.height=481,this._receiveButton.y=709):(this._bg.height=361,this._receiveButton.y=589),this._bonus=null},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(RaidEndWindow.prototype,"RaidEndWindow");var DailyActiveRankList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/DailyAcitveRankListSkins.exml",t.height=72,t}return __extends(t,e),t.prototype.SetData=function(e){var t=e.score,i=e.rank,n=e.icon,a=null==e.name?"":decodeURIComponent(e.name);this._nameLabel.text=a,this._scoreLabel.text=t,this._bonusNumLabel.text=e.bonus.toString(),this._scoreLabel.visible="Active"==WindowManager.DailyActiveStartWindow().State?!0:!1,this._bonusGroup.visible=!this._scoreLabel.visible;var r=parseInt(i),o=r%2==1;if(this._bgImage.visible=o,3>=r?(this._rankNumLabel.visible=!1,this._rankImage.visible=!0,this._rankImage.texture=RES.getRes("mingci_"+i+"_png"),this._rankUserIma.visible=!0,this._rankUserIma.texture=RES.getRes("touxiang_kuang_"+i+"_png")):(this._rankNumLabel.visible=!0,this._rankImage.visible=!1,this._rankUserIma.visible=!1),"未上榜"!=i?(this._noRankLabel.visible=!1,this._rankNumLabel.visible=!0,this._rankNumLabel.text=i):(this._noRankLabel.visible=!0,this._rankNumLabel.visible=!1),this._iconImaSource!=n&&(this._userIma.source="touxiang_mr_jpg"),""!=n){var s=new egret.ImageLoader;s.load(n),s.addEventListener(egret.Event.COMPLETE,function(){this._userIma.source=s.data,this._iconImaSource=n},this)}},t}(eui.Component);__reflect(DailyActiveRankList.prototype,"DailyActiveRankList");var DailyActiveRankWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._rankObjectSet=[],t._dailyAcitveRankListSet=[],t.skinName="resource/game_skins/DailyAcitveRankWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="huodong_paihang_di"+e+"_png"},t.prototype.onCloseDown=function(e){this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._GetData()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._GetData=function(){NetManager.SendRequest(["func="+NetNumber.DailyActiveRank],this._ReveiveActivityRank.bind(this))},t.prototype._ReveiveActivityRank=function(e){var t=e.code;t==NetManager.SuccessCode&&(this._rankObjectSet=e.data.list,this._myRankInfo=e.data.user),this._UpdataShow()},t.prototype._UpdataShow=function(){this._rankTypeLabel.text="Active"==WindowManager.DailyActiveStartWindow().State?StringMgr.GetText("dailyactivetext1"):StringMgr.GetText("dailyactivetext2");for(var e=0;e<this._dailyAcitveRankListSet.length;e++)null!=this._dailyAcitveRankListSet[e].parent&&this._listGroup.removeChild(this._dailyAcitveRankListSet[e]);for(var t=0,i=0,n=null,a=0;a<this._rankObjectSet.length;a++)0!=this._rankObjectSet[a].rank&&10>a&&(n=this._GetRankList(t),n.SetData(this._rankObjectSet[a]),this._listGroup.addChild(n),n.y=i,t+=1,i+=n.height);if(null!=this._myRankInfo){if(this._myRankInfo.rank>0?this._myRankLabel.text=this._myRankInfo.rank.toString():this._myRankLabel.text=StringMgr.GetText("dailyactivetext3"),this._myNameLabel.text=UnitManager.Player.Name,this._myScoreLabel.text=this._myRankInfo.score.toString(),this._iconImaSource!=this._myRankInfo.icon&&(this._myUserIma.source="touxiang_mr_jpg"),""!=this._myRankInfo.icon){var r=new egret.ImageLoader;r.load(this._myRankInfo.icon),r.addEventListener(egret.Event.COMPLETE,function(){this._myUserIma.source=r.data,this._iconImaSource=this._myRankInfo.icon},this)}this._bonusNumLabel.text=this._myRankInfo.bonus.toString(),this._myScoreLabel.visible="Active"==WindowManager.DailyActiveStartWindow().State?!0:!1,this._bonusGroup.visible="Active"==WindowManager.DailyActiveStartWindow().State?!1:!0}else this._myRankLabel.text=StringMgr.GetText("dailyactivetext3"),this._myNameLabel.text=UnitManager.Player.Name,this._myScoreLabel.text="0",this._myScoreLabel.visible="Active"==WindowManager.DailyActiveStartWindow().State?!0:!1,this._bonusGroup.visible="Active"==WindowManager.DailyActiveStartWindow().State?!1:!0,this._myUserIma.source="touxiang_mr_jpg"},t.prototype._GetRankList=function(e){var t=null;return e<this._dailyAcitveRankListSet.length?t=this._dailyAcitveRankListSet[e]:(t=new DailyActiveRankList,this._dailyAcitveRankListSet.push(t)),t},t}(AWindow);__reflect(DailyActiveRankWindow.prototype,"DailyActiveRankWindow");var DailyActiveRewardList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/DailyAcitveRewardListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.show=function(e){this._itemIma.texture=RES.getRes(e.res),this._nameLabel.text=e.name,this._numLabel.text="x"+e.num,this._nameLabel.filters=[FilterManage.AddMiaoBian(2,6432919)],this._numLabel.filters=[FilterManage.AddMiaoBian(2,6432919)]},t}(eui.Component);__reflect(DailyActiveRewardList.prototype,"DailyActiveRewardList");var DailyActiveRewardTip=function(e){function t(){var t=e.call(this)||this;return t._rewardSet=[],t._isVisibled=!1,t._bonus=[],t._isCreat=!1,t.skinName="resource/game_skins/DailyAcitveRewardTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._sureButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._isCreat=!0,this.Show(this._bonus)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="jiangli_di"+e+"_png"},t.prototype.onCloseDown=function(e){this.IsVisibled=!1},t.prototype.Show=function(e){this.IsVisibled=!0;for(var t=0;t<this._rewardSet.length;t++)null!=this._rewardSet[t].parent&&this._listGroup.removeChild(this._rewardSet[t]);var i=0,n=0,a=null,r=PromptManager.GetBonusResData(e,!0),o=0;1==r.length?o=175:2==r.length?o=115:3==r.length&&(o=65);for(var s=0;s<r.length;s++)a=this._GetList(i),a.show(r[s]),this._listGroup.addChild(a),a.x=n+o,i+=1,n+=a.width},t.prototype._GetList=function(e){var t=null;return e<this._rewardSet.length?t=this._rewardSet[e]:(t=new DailyActiveRewardList,this._rewardSet.push(t)),t},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(DailyActiveRewardTip.prototype,"DailyActiveRewardTip");var DailyActiveStartWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._jiangchiNum=0,t._state="Active",t._dailyActiveMaxScore=3e8,t.skinName="resource/game_skins/DailyAcitveStartWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartDown,this),this._rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenDailyActiveRankWindow,this),this._lookRewardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookRewardDown,this),this._tipCloseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseRewardTipDown,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="richang_di"+e+"_png",this._startButton.skinName=SkinCreateMgr.CreateButton("richang_an_kaishi_l"+e+"_png","richang_an_kaishi_a"+e+"_png"),this._rankButton.skinName=SkinCreateMgr.CreateButton("richang_an_paiming_l"+e+"_png","richang_an_paiming_a"+e+"_png","dianzan_off"+e+"_png"),this._lookRewardButton.skinName=SkinCreateMgr.CreateButton("richang_an_chakan_l"+e+"_png","richang_an_chakan_a"+e+"_png"),this._rewardTipBg.source="richangjiangli_di"+e+"_png",""==e?(this._rewardTipLabel1.text="1. 本次活动共设前10名奖励以及参与奖，所有的奖励都将从奖池中出现。",this._rewardTipLabel2.text="2. 系统将根据玩家的排名，将奖池中的奖励按照百分比发放。",this._rewardTipLabel3.text="3. 排名越靠前的玩家获得的奖励将越多。"):(this._rewardTipLabel1.text="1. Rewards are available for participation and top 10 finishers, drawn from the prize pool.",this._rewardTipLabel2.text="2. Rewards given out in ratios from the prize pool based on rankings.",this._rewardTipLabel3.text="3. The higher you rank, the more rewards you get."),this._startButton.enabled=!0,this.updataShow()},t.prototype.onCloseDown=function(e){this.IsVisibled=!1},t.prototype.onLookRewardDown=function(e){this._rewardTipGroup.visible=!0},t.prototype.onCloseRewardTipDown=function(e){this._rewardTipGroup.visible=!1},t.prototype.onOpenDailyActiveRankWindow=function(e){return null==WindowManager.DailyActiveRankWindow()?void WindowManager.SetWindowFunction(this._ShowDailyActiveRankWindow):void this._ShowDailyActiveRankWindow()},t.prototype._ShowDailyActiveRankWindow=function(){WindowManager.DailyActiveRankWindow().IsVisibled=!0},t.prototype.onStartDown=function(e){NetManager.SendRequest(["func=dailyactivity.checkJoin"],this.ReveiceCanJoin.bind(this))},t.prototype.ReveiceCanJoin=function(e){if(console.log(e),e.code!=NetManager.SuccessCode)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext4"));if(0==e.data.join)PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("dailyactivetext5"),null,this.JoinDailyActiveGame.bind(this));else{if(CheckpointManager.CurrentCheckpointID=CheckpointManager.DailyActiveActiveCheckpointID,null==WindowManager.RoleSelectWindow())return void WindowManager.SetWindowFunction(this._OpenRoleSelect.bind(this));this._OpenRoleSelect()}},t.prototype.JoinDailyActiveGame=function(){NetManager.SendRequest(["func=dailyactivity.toJoin"],this.ReveiceIsJoin.bind(this))},t.prototype.ReveiceIsJoin=function(e){return console.log(e),e.code!=NetManager.SuccessCode?void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext6")):(CheckpointManager.CurrentCheckpointID=CheckpointManager.DailyActiveActiveCheckpointID,null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(this._OpenRoleSelect.bind(this)):void this._OpenRoleSelect())},t.prototype._OpenRoleSelect=function(){WindowManager.RoleSelectWindow().IsVisibled=!0},t.prototype.Show=function(e){e.data.prop&&(this._jiangchiNum=e.data.prop),this._state=e.data.state,e.data.score&&(UnitManager.DailyActiveCurScore=e.data.score),UnitManager.DailyActiveCurScore>UnitManager._dailyActiveMaxScore&&(UnitManager.DailyActiveCurScore=UnitManager._dailyActiveMaxScore),this.updataShow()},t.prototype.updataShow=function(){this._pingGaiNumLabel.text=this._jiangchiNum.toString(),"Active"==this.State?this._startButton.enabled=!0:this._startButton.enabled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"State",{get:function(){return this._state},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(DailyActiveStartWindow.prototype,"DailyActiveStartWindow");var DailyActiveYuReWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._jiangchiNum=0,t._itemId=40702,t.skinName="resource/game_skins/DailyAcitveYuReWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._chooseButton1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCanDown,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="richangyure_di"+e+"_png",this._chooseButton1.skinName=SkinCreateMgr.CreateButton("richangyure_an_jiayou_l"+e+"_png","richangyure_an_jiayou_a"+e+"_png")},t.prototype.onCloseDown=function(e){this.IsVisibled=!1},t.prototype.onCanDown=function(e){ItemManager.GetItemCount(this._itemId)>0?NetManager.SendRequest(["func="+NetNumber.AddDailyActiveProp+"&choose=1&num="+ItemManager.GetItemCount(this._itemId)],this._ReceiveAddJiangChi.bind(this)):PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext7"))},t.prototype._ReceiveAddJiangChi=function(e){if(e.code==NetManager.SuccessCode)e.data.prop&&(this._jiangchiNum=e.data.prop),ItemManager.UseItem(this._itemId,ItemManager.GetItemCount(this._itemId)),this.updataInfo(),e.data.bonus&&e.data.bonus.length>0&&PromptManager.ShowDailyActiveRewardTip(e.data.bonus);else switch(e.code){case 903:PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext8"));break;case 904:PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext9"));break;default:PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("dailyactivetext10"))}},t.prototype.Show=function(e){e.data.prop&&(this._jiangchiNum=e.data.prop),this.updataInfo()},t.prototype.updataInfo=function(){this._pingGaiNumLabel.text=this._jiangchiNum.toString(),this._itemNumLabel.text="x"+ItemManager.GetItemCount(this._itemId)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(DailyActiveYuReWindow.prototype,"DailyActiveYuReWindow");var FirstChargeWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._price=60,t.skinName="resource/game_skins/FirstChargePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._buyButton.visible=!0,this._rewardButton.visible=!1,this._tipGroup.visible=!1,this._yujieTip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._TipBegin,this),this._yujieTip.addEventListener(egret.TouchEvent.TOUCH_END,this._TipEnd,this),this._giftTip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._TipBegin,this),this._giftTip.addEventListener(egret.TouchEvent.TOUCH_END,this._TipEnd,this),this._moneyTip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._TipBegin,this),this._moneyTip.addEventListener(egret.TouchEvent.TOUCH_END,this._TipEnd,this),this._buyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyClick,this),this._rewardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRewardClcik,this),this._InitMovie(),GameEvent.AddEventListener(EventType.UserStatusChange,this._UpdateButton,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="shouchong_di"+e+"_png",this._buyButton.skinName=SkinCreateMgr.CreateButton("shouchong_an_lijigoumai_l"+e+"_png","shouchong_an_lijigoumai_a"+e+"_png"),this._rewardButton.skinName=SkinCreateMgr.CreateButton("shouchong_an_lingqujiangli_l"+e+"_png","shouchong_an_lingqujiangli_a"+e+"_png")},t.prototype._InitMovie=function(){this._movieSet=[];for(var e=MovieManager.GetMovieClipData("boxmovie_json","boxmovie_png","vipyueka_baoxiangtx"),t=0;3>t;t++){var i=new egret.MovieClip(e);i.play(-1),this.addChild(i),this._movieSet.push(i)}this._movieSet[0].x=this._yujieTip.x+this._yujieTip.width/2+2,this._movieSet[0].y=this._yujieTip.y+this._yujieTip.height/2+7,this._movieSet[1].x=this._giftTip.x+this._giftTip.width/2+2,this._movieSet[1].y=this._giftTip.y+this._giftTip.height/2+7,this._movieSet[2].x=this._moneyTip.x+this._moneyTip.width/2+2,this._movieSet[2].y=this._moneyTip.y+this._moneyTip.height/2+7},t.prototype._OnRewardClcik=function(){var e=UnitStatusMgr.IsFirstChargeReward;return e?void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext1")):void NetManager.SendRequest(["func="+NetNumber.FirstChargeGift],this._ReceiveReward.bind(this))},t.prototype._ReceiveReward=function(e){var t=e.code;if(t!=NetManager.SuccessCode)return void Main.AddDebug("首充领取返回错误：code="+t);var i=e.data,n=i.bonus;PromptManager.GetBonusResData(n,!0),PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext2")),WindowManager.StarWindow().CloseWindow()},t.prototype._TipBegin=function(e){var t="";e.currentTarget==this._yujieTip?(this._tipGroup.x=this._yujieTip.x,t=StringMgr.GetText("vippagetext3")):e.currentTarget==this._giftTip?(this._tipGroup.x=this._giftTip.x,t=StringMgr.GetText("vippagetext4")):e.currentTarget==this._moneyTip&&(this._tipGroup.x=this._moneyTip.x,t="\n20000"+StringMgr.GetText("rewardtext1")),this._tipLabel.text=t,this._tipGroup.visible=!0},t.prototype._TipEnd=function(e){this._tipGroup.visible=!1},t.prototype._OnBuyClick=function(){PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext5"),null,this._BuyToken.bind(this))},t.prototype._BuyToken=function(){var e=JSON.parse("{}");e.token=UnitManager.Player.GameToken;var t=Game.IsIos?14079:14071;NetManager.SendRequest(["func="+NetNumber.BuyGold+"&itemid="+t+"&count=1&oemInfo="+JSON.stringify(e)],this._OnBuyVIPCom.bind(this))},t.prototype._OnBuyVIPCom=function(e){var t=e.data.code;e.data;e.code!=NetManager.SuccessCode?1004==t&&PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext6"),null,this._OnPayClick.bind(this)):e.code==NetManager.SuccessCode&&(PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("vippagetext7")),this._buyButton.visible=!1,this._rewardButton.visible=!0,WindowManager.StarWindow().CloseWindow())},t.prototype._OnPayClick=function(){Main.AddDebug("发起支付")},t.prototype._OnPaySuccess=function(){this._BuyToken()},t.prototype._OnPayError=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},t.prototype._OnPayClose=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled
},set:function(e){if(this._isVisibled!=e)if(this._isVisibled=e,e){if(Main.Instance.WindowBottomLayer.addChild(this),this._UpdateButton(),null!=this._movieSet)for(var t=0;t<this._movieSet.length;t++)this._movieSet[t].play(-1)}else if(Main.Instance.WindowBottomLayer.removeChild(this),null!=this._movieSet)for(var t=0;t<this._movieSet.length;t++)this._movieSet[t].stop()},enumerable:!0,configurable:!0}),t.prototype._UpdateButton=function(){this._buyButton.visible=!UnitStatusMgr.IsFirstCharge,this._rewardButton.visible=!this._buyButton.visible},t}(AWindow);__reflect(FirstChargeWindow.prototype,"FirstChargeWindow");var FriendList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/FriendListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._zhaoButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onZhaoHuanDown,this),this._zanButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onZanDown,this),this._shouButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShouDown,this),GameEvent.AddEventListener(EventType.ShouHello,this.upDataShow,this),GameEvent.AddEventListener(EventType.FriendChangState,this.upDataShow,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._zhaoButton.skinName=SkinCreateMgr.CreateButton("zhaohui_l"+e+"_png","zhaohui_a"+e+"_png"),this._zanButton.skinName=SkinCreateMgr.CreateButton("dianzan_l"+e+"_png","dianzan_a"+e+"_png","dianzan_off"+e+"_png"),this._shouButton.skinName=SkinCreateMgr.CreateButton("shouqu_l"+e+"_png","shouqu_a"+e+"_png"),this._zanButton.enabled=!0,null==this._zanState||0!=this._zanState?this._zanButton.enabled=!1:this._zanButton.enabled=!0},t.prototype.upDataShow=function(){this._shouState!=this._curFriend.ShouZan&&this.upDateShow(this._curFriend),this._curState!=this._curFriend.CurState&&this.upDateShow(this._curFriend)},t.prototype.onShouDown=function(e){SoundManager.PlayButtonMusic(),NetManager.SendRequest(["func=bonusHello&openid="+this._curFriend.OpenID],this.onShouReturn.bind(this))},t.prototype.onShouReturn=function(e){e.code==NetManager.SuccessCode&&(this._curFriend.ShouZan-=1,PromptManager.ShowGit(e.data),this.upDateShow(this._curFriend),GameEvent.DispatchEvent(EventType.ShouHello))},t.prototype.onZanDown=function(e){SoundManager.PlayButtonMusic(),NetManager.SendRequest(["func=index.sendHello&actionType="+NetNumber.SendHelloNum+"&openid="+this._curFriend.OpenID],this.onZanReturn.bind(this))},t.prototype.onZanReturn=function(e){e.code==NetManager.SuccessCode&&(this._curFriend.QinMiNum+=1,this._curFriend.SendZan+=1,this.upDateShow(this._curFriend))},t.prototype.onZhaoHuanDown=function(e){SoundManager.PlayButtonMusic()},t.prototype.upDateShow=function(e){if(this._curFriend=e,this._qinmiLabel.text=this._curFriend.QinMiNum.toString(),this._nameLabel.text=this._curFriend.Name,this._scoreLabel.text=StringMgr.GetText("friendpagetext1")+this._curFriend.MaxScore.toString(),this._iconImaSource!=this._curFriend.IconRes&&(this._friendIcon.source=RES.getRes("touxiang_mr_jpg")),""!=this._curFriend.IconRes){var t=new egret.ImageLoader;t.load(this._curFriend.IconRes),t.addEventListener(egret.Event.COMPLETE,function(){this._friendIcon.source=t.data,this._iconImaSource=this._curFriend.IconRes},this)}this._curState=this._curFriend.CurState,this._zanState=this._curFriend.SendZan,this._shouState=this._curFriend.ShouZan,this.updataButton(),e.IsGaming?(this._curStateLabel.textColor=13131522,this._curStateLabel.text=StringMgr.GetText("friendpagetext2")):e.IsOnline?(this._curStateLabel.textColor=5548597,this._curStateLabel.text=StringMgr.GetText("friendpagetext3")):(this._curStateLabel.textColor=13518632,this._curStateLabel.text=StringMgr.GetText("friendpagetext4"))},t.prototype.updataButton=function(){0!=this._zanState?this._zanButton.enabled=!1:this._zanButton.enabled=!0,this._shouState>0?(this._shouButton.visible=!0,this._zanButton.visible=!1,this._redIma.visible=!0):(this._shouButton.visible=!1,this._zanButton.visible=!0,this._redIma.visible=!1),"-1"==this._curFriend.OpenID&&(this._shouButton.visible=!1,this._zanButton.visible=!1)},t}(AWindow);__reflect(FriendList.prototype,"FriendList");var FriendPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._listSet=[],t.skinName="resource/game_skins/FriendPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._scroller.bounces=!1,GameEvent.AddEventListener(EventType.FriendUpData,this.upDataReturn,this)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._UpdataShow()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.upDataReturn=function(){this._isVisibled&&this._UpdataShow()},t.prototype._UpdataShow=function(){if(0!=FriendManager.AllFrienSet.length||null!=FriendManager.JiQiFriend){this._scroller.viewport.scrollV=0;var e=0;null!=FriendManager.JiQiFriend&&(e=1);for(var t=0;t<this._listSet.length;t++)null!=this._listSet[t].parent&&this._friendGroup.removeChild(this._listSet[t]);var i=0,n=0,a=null;null!=FriendManager.JiQiFriend&&(a=this._GetList(i),a.upDateShow(FriendManager.JiQiFriend),this._friendGroup.addChild(a),a.y=n,i+=1,n+=a.height);for(var r=0;r<FriendManager.AllFrienSet.length;r++)a=this._GetList(i),a.upDateShow(FriendManager.AllFrienSet[r]),this._friendGroup.addChild(a),a.y=n,i+=1,n+=a.height}},t.prototype._GetList=function(e){var t=null;return e<this._listSet.length?t=this._listSet[e]:(t=new FriendList,this._listSet.push(t)),t},t}(AWindow);__reflect(FriendPage.prototype,"FriendPage");var BeyondFriendLabel=function(e){function t(){var t=e.call(this)||this;return t._Init(),t}return __extends(t,e),t.prototype._Init=function(){this._label=new eui.Label,this._label.width=640,this._label.height=50,this._label.fontFamily="微软雅黑",this._label.textAlign="center",this._label.textColor=16731648,this._label.bold=!0,this._label.size=50,this.addChild(this._label)},t.prototype.Show=function(e){this._label.text=e,egret.Tween.removeTweens(this._label),this._label.alpha=1,this._label.y=670;var t=egret.Tween.get(this._label);t.wait(500).to({y:550,alpha:0},600).call(this._Remove.bind(this))},t.prototype._Remove=function(){ObjectPool.getPool("BeyondFriendLabel").returnObject(this)},t.prototype.onInit=function(){return this},t.prototype.onReturn=function(){return null!=this.parent&&this.parent.removeChild(this),this},t}(egret.DisplayObjectContainer);__reflect(BeyondFriendLabel.prototype,"BeyondFriendLabel");var CheckpointTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._timeOutFun=-1,t._timeOutNum=0,t.skinName="resource/game_skins/CheckpointTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),t._instance=this,this._daojishiLabel.touchEnabled=!1,this._yesButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnYesButtonClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._yesButton.skinName=SkinCreateMgr.CreateButton("anniu_jixu_time_l"+e+"_png","anniu_jixu_time_a"+e+"_png")},t.prototype.ShowPrompt=function(e,i,n){void 0===e&&(e=""),void 0===i&&(i=""),void 0===n&&(n=null),this.IsVisibled=!0,this._yesFun=n,this.skin.currentState="firstTip",null!=i?(this._iconIma.visible=!0,this._iconIma.texture=RES.getRes(i)):this._iconIma.visible=!1,this._msgLabel.text=e,this._timeOutNum=t._Time,this._daojishiLabel.text="("+this._timeOutNum.toString()+"s)",this._timeOutFun=setTimeout(this.TimeOutFun.bind(this),1e3)},t.prototype.TimeOutFun=function(){clearTimeout(this._timeOutFun),this._timeOutNum-=1,this._daojishiLabel.text="("+this._timeOutNum.toString()+"s)",this._timeOutNum>0?this._timeOutFun=setTimeout(this.TimeOutFun.bind(this),1e3):this._OnYesButtonClick()},t.prototype._OnYesButtonClick=function(){this.IsVisibled=!1,null!=this._yesFun&&(this._yesFun(),this._yesFun=null)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t}(AWindow);CheckpointTip._Time=5,__reflect(CheckpointTip.prototype,"CheckpointTip");var EndWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._bonus=null,t.skinName="resource/game_skins/EndPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._starSet=[];for(var t=0;3>t;t++)this._starSet.push(this["_starImage"+t]);this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnShareClick,this),this._againButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnReplayClick,this),this._changeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChangeClick,this),this._returnButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnReturnClick,this),this._continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnContinueClick,this),this._isCreated=!0,null!=this._bonus&&(this.Show(this._bonus),this._bonus=null)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._fristImage.source="suipian_jiao"+e+"_png",this._newImage.source="newgame"+e+"_png",this._returnButton.skinName=SkinCreateMgr.CreateButton("anniu_fanhuizhuye_l"+e+"_png","anniu_fanhuizhuye_a"+e+"_png"),this._shareButton.skinName=SkinCreateMgr.CreateButton("anniu_fenxiang_l"+e+"_png","anniu_fenxiang_a"+e+"_png"),this._continueButton.skinName=SkinCreateMgr.CreateButton("anniu_jixu_l"+e+"_png","anniu_jixu_a"+e+"_png"),this._changeButton.skinName=SkinCreateMgr.CreateButton("anniu_genghuanjuese_l"+e+"_png","anniu_genghuanjuese_a"+e+"_png"),this._againButton.skinName=SkinCreateMgr.CreateButton("anniu_zailaiyici_l"+e+"_png","anniu_zailaiyici_a"+e+"_png")},t.prototype._OnContinueClick=function(){if(CheckpointManager.IsEndless)this.IsVisibled=!1,Game.Instance.StarBattle();else if(CheckpointManager.IsDailyActive)0==UnitManager.DailyActiveState||UnitManager.DailyActiveCurScore>=UnitManager._dailyActiveMaxScore?PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("endwindowtext1")):(this.IsVisibled=!1,Game.Instance.StarBattle());else{if(!CheckpointManager.CurrentCheckpoint.IsPass)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("endwindowtext2"));if(CheckpointManager.CurrentCheckpoint.ID>=CheckpointManager.GetCheckpointSet().length)return void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("endwindowtext3"));UnitManager.Player.PhysicalConsume(CheckpointManager.CurrentCheckpoint.ConsumePhy)&&(this.IsVisibled=!1,CheckpointManager.CurrentCheckpointID+=1,Game.Instance.StarBattle())}},t.prototype._OnReturnClick=function(){this.IsVisibled=!1,CheckpointManager.ChooseCheckPointId=CheckpointManager.CurrentCheckpointID,GameEvent.DispatchEvent(EventType.StartCheckPassAni),WindowManager.StarWindow().IsVisibled=!0,SoundManager.PlayBackgroundMusic(),Main.Instance.BattleEnd(),WindowManager.StarWindow().CloseWindow(),GuideManager.IsGuide||AchievementManager.ShowLastCompleteAch(),GuideManager.IsGuide&&8==GuideManager.GuideID&&WindowManager.StarWindow().ShouCangGuide()},t.prototype._OnChangeClick=function(){return null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(this._OpenRoleSelect.bind(this)):void this._OpenRoleSelect()},t.prototype._OpenRoleSelect=function(){WindowManager.RoleSelectWindow().IsVisibled=!0},t.prototype._OnShareClick=function(){var e=GameConstData.ShareContent;2==e.length},t.prototype._OnReplayClick=function(e){CheckpointManager.IsEndless?(this.IsVisibled=!1,Game.Instance.StarBattle()):CheckpointManager.IsDailyActive?0==UnitManager.DailyActiveState||UnitManager.DailyActiveCurScore>=UnitManager._dailyActiveMaxScore?PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("endwindowtext1")):(this.IsVisibled=!1,Game.Instance.StarBattle()):UnitManager.Player.PhysicalConsume(CheckpointManager.CurrentCheckpoint.ConsumePhy)&&(this.IsVisibled=!1,Game.Instance.StarBattle())},t.prototype.Show=function(e){if(void 0===e&&(e=null),!this._isCreated)return this._bonus=e,void(this.IsVisibled=!0);var t=Game.Instance.IsWin,i=Game.Instance.EndScore,n=Game.Instance.Star,a=Game.Instance.IsFrist&&t,r=StringMgr.LanguageSuffix;this._bg.source=t?"jiesuan_di"+r+"_png":"jiesuansb_di"+r+"_png",t||(n=0);for(var o=0;o<this._starSet.length;o++)this._starSet[o].visible=n>o;if(this._starGroup.visible==t,CheckpointManager.IsEndless||CheckpointManager.IsDailyActive)i>UnitManager.Player.MaxScore?(UnitManager.Player.MaxScore=i,this._newImage.visible=!0):this._newImage.visible=!1,this._scoreLabel.text=i.toString(),this._maxScoreLabel.text=UnitManager.Player.MaxScore.toString();else{var s=CheckpointManager.CurrentCheckpoint;if(null==s)return void Main.AddDebug("结算界面找不到关卡");this._scoreLabel.text=i.toString(),i>s.MaxScore?(this._newImage.visible=!0,s.MaxScore=i,this._maxScoreLabel.text=i.toString()):(this._newImage.visible=!1,this._maxScoreLabel.text=s.MaxScore.toString())}this.IsVisibled=!0;var u=0,l="",h=StringMgr.GetText("endwindowtext4"),c=!1,_=!1;if(null!=e)for(var o=0;o<e.length;o++){var d=e[o],p=d.type;if("M"==p)_?(l="fenxiang_jinbi_png",h=StringMgr.GetText("rewardtext1")+" X"+u.toString(),c=!0):(u=d.num,_=!0);else if("D"==p)l="fenxiang_jifen_png",h=StringMgr.GetText("rewardtext2")+" X"+d.num,c=!0;else if("I"!=p&&"C"!=p||c)"A"!=p||c||(l="fenxiang_daoju_tili_png",h=StringMgr.GetText("rewardtext3")+" X"+d.num,c=!0);else{var g=ItemManager.GetItemByID(d.id);if(null!=g&&701!=d.id&&702!=d.id&&(l=g.ImageRes,h=g.Name+"x"+d.num,ItemManager.AddItem(ItemManager.GetXID(p,d.id),d.num),c=!0),null!=g&&701==d.id||702==d.id){var m=[];m.push(e[o]),PromptManager.ShowDailyActiveRewardTip(m)}}}this._moneyLabel.text=u.toString(),this._rewardImage.source=l,this._rewardLabel.text=h,this._rewardBgIma.visible=c,this._rewardGroup.visible=t,this._fristImage.visible=a},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.GameLayer.addChild(this),Game.IsShowTopTip=!0,this.EndWindowGuide()):Main.Instance.GameLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.EndWindowGuide=function(){if(this.IsVisibled&&GuideManager.IsGuide&&8==GuideManager.GuideID){var e=this._returnButton.x,t=this._returnButton.y,i=this._returnButton.width,n=this._returnButton.height;GuideManager.ShowGuideWindow(0,e,t,i,n)}},t}(AWindow);__reflect(EndWindow.prototype,"EndWindow");var FriendGameScore=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/FriendGameScoreSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._friendNameLabel.wordWrap=!1,this._friendNameLabel.multiline=!1,this._friendNameLabel.width=250,this._friendNameLabel.height=35},t.prototype.upDateShow=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),null!=this.parent&&(this._friendNameLabel.text=e,this._friendIma.source=t,this._friendScoreLabel.text=i)},t}(eui.Component);__reflect(FriendGameScore.prototype,"FriendGameScore");var GameSkill=function(e){function t(t){var i=e.call(this)||this;return i._isPlay=!1,i.skinName="resource/game_skins/GameSkillShowSkins.exml",i._skillId=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.alpha=0,this.scaleX=0,this.scaleY=0,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.showSkill()},t.prototype.showSkill=function(){this._skill=SkillManager.GetSkillByID(this._skillId,UnitManager.CurrentRole.ID),this._skillIma.texture=RES.getRes(this._skill.ImageRes),this._skillNameIma.texture=RES.getRes(this._skill.GameSKillNameRes),this.showAni()},t.prototype.showAni=function(){var e=1.4;egret.Tween.get(this).to({scaleX:1.4*e,scaleY:1.2*e,alpha:1},133).to({scaleX:1.2*e,scaleY:1.2*e},133).wait(500).to({y:this.y-100,alpha:0},300).call(this.removeShow.bind(this))},t.prototype.removeShow=function(){egret.Tween.removeTweens(this),this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(GameSkill.prototype,"GameSkill");var GameUI=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._isVisibled=!1,t._timeWidth=168,t._bloodWidth=168,t._isTiming=!1,t._isMovie=!1,t._shanNum=0,t._ifUiDaojiAniStar=!1,t._energy=0,t._curIniSkill=null,t._kouxueSet=[],t.skinName="resource/game_skins/GameUISkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),GameEvent.AddEventListener(EventType.GameScoreChange,this._UpdateScore,this),GameEvent.AddEventListener(EventType.GameMoneyChange,this._UpdateMoney,this),GameEvent.AddEventListener(EventType.RoleLifeChange,this._UpdateBlood,this),GameEvent.AddEventListener(EventType.GameTimeChange,this._UpdateGameTime,this),GameEvent.AddEventListener(EventType.RoleRevive,this._RoleRevive,this),ProcessManager.AddProcess(this._Process.bind(this)),this._skillIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSkillClick,this),this._xueImage=new eui.Image("xuedi_png"),this._kouxueLabel=new eui.BitmapLabel,this._kouxueLabel.width=200,this._kouxueLabel.textAlign="center",this._kouxueLabel.font=RES.getRes("kouxuenum_fnt"),this._huixueLabel=new eui.BitmapLabel,this._huixueLabel.width=200,this._huixueLabel.textAlign="center",this._huixueLabel.font=RES.getRes("huixuenum_fnt"),this._timeImaAniGroup=new eui.Group,this.addChild(this._timeImaAniGroup);var t=StringMgr.LanguageSuffix;this._jianChiIma=ImagePool.GetImage("wz_jianchizhu"+t+"_png"),this._numIma=new eui.Image},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._textLabel.font="guanqia"+e+"_fnt",this._jianChiIma=ImagePool.GetImage("wz_jianchizhu"+e+"_png")},t.prototype.UIInit=function(){UnitManager.CurrentRole.SkillRunner.Init(),this._scoreLabel.text="0",this._moneyLabel.text="0",CheckpointManager.IsEndless||CheckpointManager.IsDailyActive||(this._guanqiaLabel.text=CheckpointManager.CurrentCheckpointID.toString(),this._guanqiaLabel.textAlign="center",this._timeImage.width=this._timeWidth,this._bloodImage.width=this._bloodWidth,this._timeLabel.text=CheckpointManager.CurrentCheckpoint.PassTime.toString()+"s",this._bloodLabel.text=UnitManager.CurrentRole.MaxLife.toString()+"/"+UnitManager.CurrentRole.MaxLife.toString()),this._isTiming=!1,this._isMovie=!1,this._group.visible=!CheckpointManager.IsEndless,this._checkGroup.visible=!CheckpointManager.IsEndless,this._group.visible&&(this._group.visible=!CheckpointManager.IsDailyActive,this._checkGroup.visible=!CheckpointManager.IsDailyActive),this._timeUiAniGroup.visible=!1,this._ifUiDaojiAniStar=!1,this._shanXueIma.visible=!1,this._shanXueIma.width=this._bloodWidth,this._dicengXueIma.width=this._bloodWidth,this._timeImaAniGroup&&(this._timeImaAniGroup.visible=!1),this.ZhuDongSkillInit(),this.Energy=GameConstData.GetValue("energyDefault")},t.prototype.ZhuDongSkillInit=function(){var e=UnitManager.CurrentRole.UseSkillSet;null==this._skillTiaoAni&&(this._skillTiaoAni=new egret.MovieClip,this._skillTiaoAni.movieClipData=MovieManager.GetMovieClipData("guanka_qipao_json","guanka_qipao_png","guanka_qipao"),this._skillTiaoAni.stop(),this._skillTiaoAni.x=this._skillGroup.width/2,this._skillTiaoAni.y=this._skillGroup.height/2-7,this._skillGroup.addChild(this._skillTiaoAni)),null==this._skillMaxAni&&(this._skillMaxAni=new egret.MovieClip,this._skillMaxAni.movieClipData=MovieManager.GetMovieClipData("guanka_qipaotx_json","guanka_qipaotx_png","guanka_qipaotx"),this._skillMaxAni.stop(),this._skillMaxAni.x=this._skillGroup.width/2,this._skillMaxAni.y=this._skillGroup.height/2-7,this._skillGroup.addChild(this._skillMaxAni),this._skillMaxAni.visible=!1);for(var t=0;t<e.length;t++)if(e[t].Type)return this._curIniSkill=e[t],this._skillGroup.visible=!CheckpointManager.IsEndless,this._skillGroup.visible&&(this._skillGroup.visible=!CheckpointManager.IsDailyActive),this._skillIma.texture=RES.getRes(this._curIniSkill.ImageRes),void(this._skillIma.mask=this._skillMaskIma);this._skillGroup.visible=!1,this._curIniSkill=null,this._skillMaxAni.stop(),this._skillMaxAni.visible=!1},t.prototype.onSkillClick=function(e){if(this.Energy>=this._curIniSkill.MpCost&&Game.GameStatus&&null!=this._curIniSkill){this.Energy-=this._curIniSkill.MpCost;var t=this._role.SkillRunner.ReleaseSkill(this._curIniSkill.ID);this._role.HandleAction(t)}},t.prototype._RoleRevive=function(){this._isTiming=!0},t.prototype._UpdateBlood=function(){if(null!=this._role){this._role=UnitManager.CurrentRole,this._bloodLabel.text=this.Role.CurrentLife.toString()+"/"+this.Role.MaxLife.toString();var e=this._role.MaxLife,t=this._role.CurrentLife;this._role.CurrentLife==this._role.MaxLife&&(this._bloodImage.width=t/e*this._bloodWidth,this._lastWidth=this._bloodImage.width,this._dicengXueIma.width=this._lastWidth),0==t&&(this._isTiming=!1,GameEvent.DispatchEvent(EventType.RoleLifeEmpty))}},t.prototype._UpdateGameTime=function(){if(this._timeImage.width=this.GameTime/this._maxGameTime*this._timeWidth,this._timeLabel.text=this.GameTime.toString()+"s",this.GameTime<=5&&0==this._ifUiDaojiAniStar&&(this._ifUiDaojiAniStar=!0,this._timeUiAniGroup.visible=!0,this.UiTimeDaoJiShiAni(),this._timeImaAniGroup.visible=!0,this.initJianChiIma()),this.GameTime<=5&&this.GameTime>0){this.initNum(this.GameTime),egret.Tween.removeTweens(this._numIma);egret.Tween.get(this._numIma).to({scaleX:1.579,scaleY:1.579,alpha:0},700);if(1==this.GameTime){egret.Tween.removeTweens(this._jianChiIma);egret.Tween.get(this._jianChiIma).to({scaleX:1.154,scaleY:1.154,alpha:0},700)}}0==this.GameTime&&(GameEvent.DispatchEvent(EventType.GameEnd),this._isTiming=!1)},t.prototype._UpdateScore=function(){this._scoreLabel.text=Game.Instance.Score.toString()},t.prototype._UpdateMoney=function(){this._moneyLabel.text=Game.Instance.GoldNum.toString()},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(e?Main.Instance.GameLayer.addChild(this):Main.Instance.GameLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.StarGame=function(){if(CheckpointManager.IsEndless||CheckpointManager.IsDailyActive)this._maxGameTime=1e5,this._group.visible=!1,this._checkGroup.visible=!1;else{var e=CheckpointManager.CurrentCheckpoint;this._maxGameTime=e.PassTime,this._group.visible=!0,this._checkGroup.visible=!0}this._role=UnitManager.CurrentRole,this._role.CurrentLife=this._role.MaxLife,this.GameTime=this._maxGameTime,this._UpdateBlood(),this._UpdateGameTime(),this._isTiming=!0,this._timer=0},Object.defineProperty(t.prototype,"Role",{get:function(){return this._role},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GameTime",{get:function(){return this._gameTime},set:function(e){0>e&&(e=0),this._gameTime!=e&&(this._gameTime=e,GameEvent.DispatchEvent(EventType.GameTimeChange))},enumerable:!0,configurable:!0}),t.prototype._Process=function(e){if((null==Game.Instance||!Game.Instance.IsGamePause)&&this._isTiming){var t=1e3;if(this._timer+=e,this._timer>=t&&(this._timer-=t,this.GameTime-=1,this.Energy+=GameConstData.EnergyTime),this._kouxueSet.length>0&&!this._isMovie){var i=this._kouxueSet.shift();this._BloodMovie(i[0],i[1])}}},t.prototype.BuckleBlood=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=null),0==e){var i=CheckpointManager.CurrentCheckpoint;e=GameConstData.BuckleBlood*i.Difficulty*(1-this._role.InjuryFreeRate),e=Math.ceil(e)}if(e=Math.ceil(e),e>0){var n=e;e=UnitManager.CurrentRole.HurtAction(n)}this.initUiBloodAni(),this._role.CurrentLife-=e,this.UiBloodAniStar(),this._Kouxue(e,t)},t.prototype._Kouxue=function(e,t){return this._isMovie?void this._kouxueSet.push([e,t]):void this._BloodMovie(e,t)},t.prototype._BloodMovie=function(e,t){if(!this._isMovie&&0!=e&&null!=t){this._isMovie=!0,e=Math.ceil(e),egret.Tween.removeTweens(this._kouxueLabel),egret.Tween.removeTweens(this._xueImage);var i="";e>=0?(i="-"+e.toString(),this._kouxueLabel.text=i,this.addChild(this._kouxueLabel)):(i="+"+Math.abs(e).toString(),this._huixueLabel.text=i,this.addChild(this._huixueLabel));var n=60;this._kouxueLabel.x=t.x-this._kouxueLabel.width/2,this._kouxueLabel.y=t.y-n,this._kouxueLabel.alpha=0,this._huixueLabel.x=t.x-this._kouxueLabel.width/2,this._huixueLabel.y=t.y-n,this._huixueLabel.alpha=0,this._xueImage.anchorOffsetX=25,this._xueImage.anchorOffsetY=9,this._xueImage.x=t.x,this._xueImage.y=t.y-n,this._xueImage.scaleX=this._xueImage.scaleY=0;var a=new egret.Point(this._bloodImage.localToGlobal().x+this._bloodImage.width/2,this._bloodImage.localToGlobal().y+this._bloodImage.height/2);this.addChild(this._xueImage);var r=egret.Tween.get(this._kouxueLabel);r.to({alpha:1},84).wait(125).to({y:this._kouxueLabel.y-17,alpha:0},125);var o=egret.Tween.get(this._huixueLabel);o.to({alpha:1},84).wait(125).to({y:this._kouxueLabel.y-17,alpha:0},125);var s=egret.Tween.get(this._xueImage);s.to({scaleX:1,scaleY:1},84).to({scaleX:1.3,scaleY:1.3},125).to({scaleX:1,scaleY:1},167).to({x:a.x,y:a.y,scaleX:.4,scaleY:.4},460).call(this._MovieEnd,this)}},t.prototype._MovieEnd=function(){this.contains(this._kouxueLabel)&&this.removeChild(this._kouxueLabel),this.contains(this._huixueLabel)&&this.removeChild(this._huixueLabel),this.removeChild(this._xueImage),this._isMovie=!1},t.prototype.initUiBloodAni=function(){var e=this._role.MaxLife,t=this._role.CurrentLife;this._bloodImage.width=t/e*this._bloodWidth,this._lastWidth=this._bloodImage.width,this._shanXueIma.width=this._bloodImage.width,this._dicengXueIma.width=this._lastWidth,this._shanXueIma.visible=!1,clearTimeout(this._timerOutFun),egret.Tween.removeTweens(this._dicengXueIma),egret.Tween.removeTweens(this._bloodImage)},t.prototype.UiBloodAniStar=function(){this._shanXueIma.visible=!0,this._shanNum=0,this._timerOutFun=setTimeout(this.shanFun.bind(this),50)},t.prototype.shanFun=function(){if(this._shanNum+=1,this._shanXueIma.visible=!1,this._shanNum<5)this._shanXueIma.visible=!0,this._timerOutFun=setTimeout(this.shanFun.bind(this),50);else{clearTimeout(this._timerOutFun);var e=this._role.CurrentLife,t=this._role.MaxLife,i=e/t*this._bloodWidth;egret.Tween.get(this._bloodImage).to({width:i},200).call(this.moveDiCengXue.bind(this))}},t.prototype.moveDiCengXue=function(){egret.Tween.removeTweens(this._bloodImage);var e=this._role.CurrentLife,t=this._role.MaxLife,i=e/t*this._bloodWidth;egret.Tween.get(this._dicengXueIma).to({width:i},200).call(function(){egret.Tween.removeTweens(this._dicengXueIma);var e=this._role.CurrentLife,t=this._role.MaxLife;this._lastWidth=e/t*this._bloodWidth}.bind(this))},t.prototype.UiTimeDaoJiShiAni=function(){this._timeUiAniGroup.alpha=1,egret.Tween.removeTweens(this._timeUiAniGroup);egret.Tween.get(this._timeUiAniGroup).to({alpha:0},1e3).call(function(){1==Game.GameStatus?this.UiTimeDaoJiShiAni():this.UiTimeAniEnd()}.bind(this))},t.prototype.initJianChiIma=function(){this._timeImaAniGroup.addChild(this._jianChiIma),this._jianChiIma.anchorOffsetX=this._jianChiIma.width/2,this._jianChiIma.anchorOffsetY=this._jianChiIma.height/2,this._jianChiIma.x=325,this._jianChiIma.y=150,this._jianChiIma.scaleX=1,this._jianChiIma.scaleY=1,this._jianChiIma.alpha=0;egret.Tween.get(this._jianChiIma).to({alpha:.5},167).to({alpha:1},167)},t.prototype.initNum=function(e){this._numIma.texture=RES.getRes("wz_"+e+"_png"),this._timeImaAniGroup.addChild(this._numIma),this._numIma.anchorOffsetX=this._numIma.width/2,this._numIma.anchorOffsetY=this._numIma.height/2,this._numIma.x=325,this._numIma.y=250,this._numIma.scaleX=1,this._numIma.scaleY=1,this._numIma.alpha=1},t.prototype.UiTimeAniEnd=function(){egret.Tween.removeTweens(this._timeUiAniGroup),this._timeUiAniGroup.visible=!1},t.prototype.timeImaAniEnd=function(){egret.Tween.removeTweens(this._jianChiIma),egret.Tween.removeTweens(this._numIma),this._timeImaAniGroup.contains(this._jianChiIma)&&this._timeImaAniGroup.removeChild(this._jianChiIma),this._timeImaAniGroup.contains(this._numIma)&&this._timeImaAniGroup.removeChild(this._numIma),this._timeImaAniGroup.visible=!1},t.prototype.gameEnd=function(){this.timeImaAniEnd(),this.UiTimeAniEnd(),this.initUiBloodAni()},Object.defineProperty(t.prototype,"Energy",{get:function(){return this._energy},set:function(e){e=Math.max(0,e),this._energy=e;var t=this._curIniSkill?this._curIniSkill.MpCost:100;if(this._energy=Math.min(this._energy,t),this._energy<t?(this._skillIma.filters=[FilterManage.HuiDu],this._jinzhiIma.visible=!0,this._skillMaxAni&&this._skillMaxAni.visible&&(this._skillMaxAni.stop(),this._skillMaxAni.visible=!1)):(this._skillIma.filters=[],this._jinzhiIma.visible=!1,this._skillMaxAni&&(this._skillMaxAni.play(-1),this._skillMaxAni.visible=!0)),this._skillTiaoAni&&this._curIniSkill){var i=Math.round(100*(this._energy/this._curIniSkill.MpCost));this._skillTiaoAni.gotoAndStop(i)}this._energyLabel.text=this._energy.toString()},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(GameUI.prototype,"GameUI");var ReviveWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/RevivePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._noButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnNoButtonClick,this),this._yesButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnYesButtonClick,this),GameEvent.AddEventListener(EventType.ReviveItemUpdate,this._UpdateItemCount,this),this._UpdateItemCount()},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._textLabel1.text=StringMgr.GetText("revivepagetext1"),this._textLabel2.text=StringMgr.GetText("revivepagetext2"),this._yesButton.skinName=SkinCreateMgr.CreateButton("anniu_kaishi_l"+e+"_png","anniu_kaishi_a"+e+"_png"),this._noButton.skinName=SkinCreateMgr.CreateButton("anniu_quxiao_l"+e+"_png","anniu_quxiao_a"+e+"_png")},t.prototype._OnNoButtonClick=function(){this.IsVisibled=!1,GameEvent.DispatchEvent(EventType.GameEnd)},t.prototype._OnYesButtonClick=function(){if(ItemManager.GetItemCount(ItemManager.ReviveItemID)<=0){var e=FrequencyManager.GetFrequency(2);if(null==e)return void Main.AddDebug("获取不到次数信息，type=2");var t=e.MaxValue+e.ExtValue,i=e.Value;if(i=t-i,i>0){var n=i+"/"+t,a=StringMgr.GetText("revivepagetext3").replace("&num",n);PromptManager.CreatCenterTip(!1,!1,a,null,this._OnShareTipYes.bind(this),this._OnShareTipNo.bind(this))}else this.IsVisibled=!1,PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("revivepagetext5"),null,function(){GameEvent.DispatchEvent(EventType.GameEnd)},function(){GameEvent.DispatchEvent(EventType.GameEnd)})}else{var r=JSON.parse("{}");r.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.UseItem+"&id="+ItemManager.ReviveItemID+"&num=1&oemInfo="+JSON.stringify(r)],this._UseReviveItemCom.bind(this))}},t.prototype._OnShareTipNo=function(){this.IsVisibled=!1,GameEvent.DispatchEvent(EventType.GameEnd)},t.prototype._OnShareTipYes=function(){if(Main.IsLocationDebug)this._ShareTask();else{var e=GameConstData.ShareContent;2==e.length,this._ShareTask()}},t.prototype._ShareTask=function(){NetManager.SendRequest(["func="+NetNumber.ShareEnd+"&type="+UnitManager.DieShareType],this._OnShareTaskReturn.bind(this))},t.prototype._OnShareTaskReturn=function(e){if(e.code!=NetManager.SuccessCode)return void Main.AddDebug("分享任务返回错误，错误码："+e.code);var t=e.data.items;Object.keys(t).map(function(e){ItemManager.SetItemCount(parseInt(e),t[e].num)}),null==WindowManager.GetItemTip()?WindowManager.SetWindowFunction(this._OpenGetItemTip.bind(this)):this._OpenGetItemTip()},t.prototype._OpenGetItemTip=function(){WindowManager.GetItemTip().IsVisibled=!0
},t.prototype._UseReviveItemCom=function(e){e.code==NetManager.SuccessCode&&(this.IsVisibled=!1,ItemManager.UseItem(ItemManager.ReviveItemID,1),null!=UnitManager.CurrentRole&&WindowManager.GameUI().BuckleBlood(-Math.floor(.3*UnitManager.CurrentRole.MaxLife)),Game.Instance.GameRevive())},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.GameLayer.addChild(this):Main.Instance.GameLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._UpdateItemCount=function(){this._countLabel.text=ItemManager.GetItemCount(ItemManager.ReviveItemID).toString()},t}(AWindow);__reflect(ReviveWindow.prototype,"ReviveWindow");var RoadFriendIcon=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.height=100,this._group=new eui.Group,this.addChild(this._group),this._friendIcon=new eui.Image,this._friendIcon.source="resource/res/common/shop_jinbi.png",this._group.addChild(this._friendIcon),this._maskIma=new eui.Image,this._maskIma.texture=RES.getRes("youxi_haoyou_zz_png"),this._friendIcon.mask=this._maskIma,this._kuangIma=new eui.Image,this._kuangIma.texture=RES.getRes("youxi_haoyou_di_png"),this._group.addChild(this._kuangIma),this._nameLabel=new eui.Label,this._nameLabel.fontFamily="微软雅黑",this._nameLabel.size=30,this._nameLabel.textColor=2379611,this._nameLabel.text="鸡小德",this.addChild(this._nameLabel)},t.prototype.upDateShow=function(e,t,i){void 0===e&&(e="resource/res/common/shop_jinbi.png"),void 0===t&&(t=0),void 0===i&&(i="鸡小德"),(t=0)?this._kuangIma.rotation=0:this._kuangIma.rotation=90,this._friendIcon.source=e,this._nameLabel.text=i},t}(egret.DisplayObjectContainer);__reflect(RoadFriendIcon.prototype,"RoadFriendIcon");var SuccFailPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/SuccFailPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._lookEndButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookEnd,this),this._sureButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookEnd,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this._shareRewardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._scoreLabel.font="succPageScore"+e+"_fnt",this._rankLabel.font="succPageRankNum"+e+"_fnt",this._sureButton.skinName=SkinCreateMgr.CreateButton("chuanguansb_an_queding_l"+e+"_png","chuanguansb_an_queding_a"+e+"_png"),this._shareButton.skinName=SkinCreateMgr.CreateButton("chuanguancg_an_xuanyao_l"+e+"_png","chuanguancg_an_xuanyao_a"+e+"_png"),this._lookEndButton.skinName=SkinCreateMgr.CreateButton("chuanguancg_an_chakan_l"+e+"_png","chuanguancg_an_chakan_a"+e+"_png"),this._shareRewardButton.skinName=SkinCreateMgr.CreateButton("chuanguancg_an_fenxiang_l"+e+"_png","chuanguancg_an_fenxiang_a"+e+"_png")},t.prototype.onShare=function(e){var t=GameConstData.ShareContent;0==t.length,NetManager.SendRequest(["func="+NetNumber.ShareEnd+"&type="+UnitManager.ChaoYueFriendShareType],this._OnShareChaoYueReturn.bind(this))},t.prototype._OnShareChaoYueReturn=function(e){return e.code!=NetManager.SuccessCode?void Main.AddDebug("超越好友分享返回错误，错误码："+e.code):(PromptManager.ShowGit(e.data.bonus),void this.onLookEnd(null))},t.prototype.onLookEnd=function(e){return null==WindowManager.EndWindow()?void WindowManager.SetWindowFunction(this._OpenEndWindow.bind(this),this._bonus):void this._OpenEndWindow(this._bonus)},t.prototype._OpenEndWindow=function(e){egret.Tween.removeTweens(this),this.IsVisibled=!1,WindowManager.EndWindow().Show(e)},t.prototype.judgeBounsIma=function(){var e=null;return null!=this._superBonus&&(e=PromptManager.GetBonusResData(this._superBonus,!1)),[e[0].res,e[0].num]},t.prototype.onShow=function(e,t,i){this._bonus=t,this._ifWin=e,this._superBonus=i,e?SoundManager.PlayBackgroundMusic():SoundManager.PlayFailBGMusic(),this.initSuccFailIma(),this.IsVisibled=!0},t.prototype.initSuccFailIma=function(){var e=StringMgr.LanguageSuffix;this._ifWin?this._succFailIma.texture=RES.getRes("chuanguancg_di"+e+"_png"):this._succFailIma.texture=RES.getRes("chuanguansb_di"+e+"_png"),this._sureButton.visible=!1,this._winGroup.visible=!1},t.prototype.judegeShowWinScoreOrFailButton=function(){this._ifWin&&!GuideManager.IsGuide?this.showWinScoreAni():(this.showFailScoreAni(),this.SuccFailGuide())},t.prototype.showWinScoreAni=function(){this._winGroup.visible=!0,this._scoreLabel.text="f"+Game.Instance.EndScore.toString();var e=Game.Instance.judgeIsChaoYueFriend();if(101==Game.Instance.EndRankNum?Game.Instance.FriendSet.length<30?(Game.Instance.EndRankNum=Game.Instance.FriendSet.length+1,this._rankLabel.text="d "+Game.Instance.EndRankNum.toString()+" m"):this._rankLabel.text="w":this._rankLabel.text="d "+Game.Instance.EndRankNum.toString()+" m",0==e)this._mohuIma.visible=!1,this._downInfoGroup.visible=!1,this._upInfoGroup.visible=!1,this._upRankGroup.visible=!1,this._shareRewardGroup.visible=!1,this._lookEndButton.visible=!0,this._shareButton.visible=!0;else{this._mohuIma.visible=!1;var t=0;if(t=Game.Instance.playerInfo?Math.abs(Game.Instance.EndRankNum-Game.Instance.LastRankNum):Math.abs(Game.Instance.EndRankNum-Game.Instance.FriendSet.length+1),this._upRankLabel.text="+"+t.toString(),this._upInfoIcon.source="touxiang_mr_jpg",Game.Instance.playerInfo){if(""!=Game.Instance.playerInfo.icon){var i=new egret.ImageLoader;i.load(Game.Instance.playerInfo.icon),i.addEventListener(egret.Event.COMPLETE,function(){this._upInfoIcon.source=i.data},this)}this._upInfoNameLabel.text=decodeURIComponent(Game.Instance.playerInfo.name)}else this._upInfoNameLabel.text=UnitManager.Player.Name,this._upInfoIcon.source=UnitManager.Player.HearUrl;if(this._upInfoScoreLabel.text=Game.Instance.EndScore.toString(),this._downInfoIcon.source="touxiang_mr_jpg",""!=Game.Instance.chaoYueFriendInfo[3]){var n=new egret.ImageLoader;n.load(Game.Instance.chaoYueFriendInfo[3]),n.addEventListener(egret.Event.COMPLETE,function(){this._downInfoIcon.source=n.data},this)}this._downInfoNameLabel.text=decodeURIComponent(Game.Instance.chaoYueFriendInfo[1]),this._downInfoScoreLabel.text=Game.Instance.chaoYueFriendInfo[2],this._shareRewardIma.texture=RES.getRes(this.judgeBounsIma()[0]),this._shareRewardNumLabel.text="x "+this.judgeBounsIma()[1],this._downInfoGroup.visible=!0,this._upInfoGroup.visible=!0,this._upInfoGroup.x=250,this._upInfoGroup.y=875,this._downInfoGroup.x=10,this._downInfoGroup.y=727,this._lookEndButton.visible=!1,this._shareButton.visible=!1,this._shareRewardGroup.visible=!1,this.friendInfoChange(),this.friendInfoUpImaAni(),this.friendInfoDownImaAni()}},t.prototype.showFailScoreAni=function(){this._sureButton.visible=!0},t.prototype.friendInfoChange=function(){egret.Tween.removeTweens(this._upInfoGroup),this._upInfoGroup.scaleX=1,this._upInfoGroup.scaleY=1,egret.Tween.get(this._upInfoGroup).to({x:185,y:690,scaleX:1.111,scaleY:1.111},125).to({x:10,y:727,scaleX:.95,scaleY:.95},83).call(function(){egret.Tween.get(this._upInfoGroup).wait(125).to({scaleX:1,scaleY:1}),this._upRankGroup.visible=!0,this.RankImaAni(),this.RankWenZhiAni(),this._mohuIma.visible=!0,this.friendInfoMoHuAni(),egret.Tween.get(this._downInfoGroup).to({x:250,y:875},300).wait(4e3).call(this.sureBttonXianShi.bind(this))}.bind(this))},t.prototype.friendInfoMoHuAni=function(){egret.Tween.removeTweens(this._mohuIma),this._mohuIma.scaleX=1,this._mohuIma.scaleY=1,this._mohuIma.anchorOffsetX=this._mohuIma.width/2,this._mohuIma.anchorOffsetY=this._mohuIma.height/2,this._mohuIma.y=800,this._mohuIma.x=270,egret.Tween.get(this._mohuIma).wait(50).to({scaleX:1.2,scaleY:.143},125).to({scaleX:2,scaleY:.033},42).call(function(){this._mohuIma.visible=!1}.bind(this))},t.prototype.friendInfoUpImaAni=function(){egret.Tween.removeTweens(this._upAniIma),this._upAniIma.y=-30,egret.Tween.get(this._upAniIma).to({y:-50},500).call(this.friendInfoUpImaAni.bind(this))},t.prototype.friendInfoDownImaAni=function(){egret.Tween.removeTweens(this._downAniIma),this._downAniIma.y=25,egret.Tween.get(this._downAniIma).to({y:35},900).call(this.friendInfoDownImaAni.bind(this))},t.prototype.RankImaAni=function(){egret.Tween.removeTweens(this._upRankAniIma),this._upRankAniIma.y=0,egret.Tween.get(this._upRankAniIma).to({y:-10},300).to({y:0},300).to({y:10},300).to({y:0},300).call(this.RankImaAni.bind(this))},t.prototype.RankWenZhiAni=function(){egret.Tween.removeTweens(this._upRankLabel),this._upRankLabel.y=60,this._upRankLabel.alpha=0,egret.Tween.get(this._upRankLabel).to({y:10,alpha:1},700).wait(1e3).to({y:-50,alpha:0},700)},t.prototype.sureBttonXianShi=function(){this._mohuIma.visible=!1,this._downInfoGroup.visible=!1,this._upInfoGroup.visible=!1,egret.Tween.removeTweens(this._upInfoGroup),egret.Tween.removeTweens(this._downInfoGroup),egret.Tween.removeTweens(this._upAniIma),egret.Tween.removeTweens(this._downAniIma),this._lookEndButton.visible=!0,this._shareRewardGroup.visible=!0},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this.showAni()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.showAni=function(){this._bg.anchorOffsetX=this._bg.width/2,this._bg.anchorOffsetY=this._bg.height/3,this._bg.scaleX=0,this._bg.scaleY=0,this._bg.x=this._bg.width/2,this._bg.y=this._bg.height/3,egret.Tween.get(this._bg).to({scaleX:1,scaleY:1},208),this._succFailIma.anchorOffsetX=this._succFailIma.width/2,this._succFailIma.anchorOffsetY=this._succFailIma.height/2,this._succFailIma.scaleX=0,this._succFailIma.scaleY=0,this._succFailIma.y=430,egret.Tween.get(this._succFailIma).to({scaleX:1,scaleY:1},208).to({scaleX:1.037,scaleY:1.037},83).to({scaleX:1,scaleY:1},83).wait(125).call(this.judegeShowWinScoreOrFailButton.bind(this))},t.prototype.SuccFailGuide=function(){if(this.IsVisibled&&GuideManager.IsGuide&&8==GuideManager.GuideID){var e=this._sureButton.x,t=this._sureButton.y,i=this._sureButton.width,n=this._sureButton.height;GuideManager.ShowGuideWindow(0,e,t,i,n)}},t}(AWindow);__reflect(SuccFailPage.prototype,"SuccFailPage");var GiftWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._isGet=!1,t.skinName="resource/game_skins/GiftPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._lqButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),this._isCreated=!0,null!=this._bonus&&this.Show(this._isGet,this._bonus)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._lqButton.skinName=SkinCreateMgr.CreateButton("denglulb_an_lingqu"+e+"_png","denglulb_an_lingqu_a"+e+"_png")},t.prototype._OnClick=function(){this.IsVisibled=!1},t.prototype.Show=function(e,t){if(!this._isCreated)return this._bonus=t,this._isGet=e,void(this.IsVisibled=!0);this._bonus=null,this._isGet=!1;var i=0;if(null!=t){i=t.length;for(var n=1,a=0;a<t.length&&2>a;a++){var r=t[a],o=r.type;if("M"==o)this["_rewardImage"+n].source="fenxiang_jinbi_png",this["_countLabel"+n].text=r.num,this["_nameLabel"+n].text=StringMgr.GetText("rewardtext1");else if("I"==o||"C"==o){var s=ItemManager.GetItemByID(r.id);null!=s&&(this["_rewardImage"+n].source=s.ImageRes,this["_countLabel"+n].text=r.num,this["_nameLabel"+n].text=s.Name,e||ItemManager.AddItem(ItemManager.GetXID(o,r.id),r.num))}else"A"==o?(this["_rewardImage"+n].source="fenxiang_daoju_tili_png",this["_countLabel"+n].text=r.num,this["_nameLabel"+n].text=StringMgr.GetText("rewardtext3")):"D"==o&&(this["_rewardImage"+n].source="fenxiang_jifen_png",this["_countLabel"+n].text=r.num,this["_nameLabel"+n].text=StringMgr.GetText("rewardtext2"));n+=1}}var u=UnitManager.Player.IsVIP;this._vipImage1.visible=u,this._vipImage2.visible=u,this._lqButton.visible=!e,this._titleLabel.text=e?StringMgr.GetText("giftpagetext1"):StringMgr.GetText("giftpagetext2");var l=StringMgr.LanguageSuffix;u?(this._bgImage.source="denglulb_hongdi"+l+"_png",this._borderImage1.source="denglulb_hong_wupinlan_png",this._borderImage2.source="denglulb_hong_wupinlan_png",this._titleImage.source=e?"denglulb_hong_yilingqu"+l+"_png":"denglulb_hong_lingqu"+l+"_png",this._nameLabel1.textColor=8733952,this._nameLabel2.textColor=8733952,this._countLabel1.textColor=8733952,this._countLabel2.textColor=8733952,this._titleLabel.textColor=8733952):(this._bgImage.source="denglulb_landi"+l+"_png",this._borderImage1.source="denglulb_lan_wupinlan_png",this._borderImage2.source="denglulb_lan_wupinlan_png",this._titleImage.source=e?"denglulb_lan_yilingqu"+l+"_png":"denglulb_lan_lingqu"+l+"_png",this._nameLabel1.textColor=2383773,this._nameLabel2.textColor=2383773,this._countLabel1.textColor=2383773,this._countLabel2.textColor=2383773,this._titleLabel.textColor=2383773),this._rewardGroup1.visible=i>0,this._rewardGroup2.visible=i>1,this._rewardGroup1.x=2>i?265:160},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.TopLayer.addChild(this):Main.Instance.TopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(GiftWindow.prototype,"GiftWindow");var PlayGiftWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._groupSet=[],t._imageSet=[],t._countLabelSet=[],t.skinName="resource/game_skins/PlayGiftWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this);for(var t=0;5>t;t++)this._groupSet.push(this["_gourp"+t]),this._imageSet.push(this["_image"+t]),this._countLabelSet.push(this["_countLabel"+t]),this._groupSet[t].visible=!1;null!=this._bonus&&this.Show(this._type,this._bonus)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="dengluxs_di"+e+"_png",this._receiveButton.skinName=SkinCreateMgr.CreateButton("denglulb_an_lingqu"+e+"_png","denglulb_an_lingqu_a"+e+"_png")},t.prototype._OnClick=function(){this.IsVisibled=!1},t.prototype.Show=function(e,t){if(!this._isCreated)return this._bonus=t,this._type=e,void(this.IsVisibled=!0);this.IsVisibled=!0,this._bonus=null;var i="";switch(this._type=0,e){case 1:i=StringMgr.GetText("giftpagetext3");break;case 2:i=StringMgr.GetText("giftpagetext4");break;case 3:i=StringMgr.GetText("giftpagetext5")}if(this._nameLabel.text=i,null!=t){for(var n=0;n<this._groupSet.length;n++)this._groupSet[n].visible=!1;for(var a=0,n=0;n<t.length&&5>n;n++){this._groupSet[n].visible=!0;var r=t[n],o=r.type,s=ItemManager.GetXID(o,r.id);if("M"==o)this._imageSet[a].source="fenxiang_jinbi_png",this._countLabelSet[a].text=r.num;else if("I"==o||"C"==o){var u=ItemManager.GetItemByID(s);null!=u&&(this._imageSet[a].source=u.ImageRes,this._countLabelSet[a].text=r.num,ItemManager.AddItem(s,r.num))}else"A"==o?(this._imageSet[a].source="fenxiang_daoju_tili_png",this._countLabelSet[a].text=r.num):"D"==o?(this._imageSet[a].source="fenxiang_jifen_png",this._countLabelSet[a].text=r.num):"V"==o&&(this._imageSet[a].source="fenxiang_daoju_viptian_png",this._countLabelSet[a].text=r.num);a+=1}if(a>0&&6>a)for(var l=[[[265,529]],[[194,529],[336,529]],[[122,529],[265,529],[407,529]],[[194,464],[336,464],[194,592],[363,593]],[[122,464],[265,464],[407,464],[194,592],[336,592]]],h=l[a-1],n=0;n<h.length;n++)this._groupSet[n].x=h[n][0],this._groupSet[n].y=h[n][1]}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.MainTopLayer.addChild(this):Main.MainTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(PlayGiftWindow.prototype,"PlayGiftWindow");var GuideHand=function(e){function t(){var t=e.call(this)||this;return t._Init(),t}return __extends(t,e),t.prototype._Init=function(){this._image=new eui.Image("xinshou_jiantou_png"),this._image.x=-32.5,this._image.y=-65,this.addChild(this._image)},t.prototype.Play=function(){if(null!=this.parent){egret.Tween.removeTweens(this._image);var e=egret.Tween.get(this._image);e.to({y:-100},500).to({y:-65},500).call(this.Play,this)}},t.prototype.Stop=function(){this._image.x=-32.5,this._image.y=-65,egret.Tween.removeTweens(this._image)},t}(egret.DisplayObjectContainer);__reflect(GuideHand.prototype,"GuideHand");var GuideWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/GuidePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._mask=new MaskBG,this._hand=new GuideHand,this._knowButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKnowClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="xinshou_shouye"+e+"_png",this._image1.source="xinshou_qidian"+e+"_png",this._shouchangIma.source="xinshou_shoucang"+e+"_png",this._knowButton.skinName=SkinCreateMgr.CreateButton("anniu_wozhidao_l"+e+"_png","anniu_wozhidao_a"+e+"_png")},t.prototype._OnKnowClick=function(){SoundManager.PlayButtonMusic(),GuideManager.GuideFinish(GuideManager.GuideID)},t.prototype.Show=function(e,t,i,n,a,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=""),this.IsVisibled=!1},t.prototype._HandPlay=function(){this._HandStop(),this.contains(this._hand)||this.addChild(this._hand),this._hand.Play()},t.prototype._HandStop=function(){this.contains(this._hand)&&this.removeChild(this._hand),this._hand.Stop()},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.TopLayer.addChildAt(this,0):Main.Instance.TopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(GuideWindow.prototype,"GuideWindow");var MaskBG=function(e){function t(){var t=e.call(this)||this;return t._zsImage=new egret.Bitmap,t._zImage=new egret.Bitmap,t._zxImage=new egret.Bitmap,t._sImage=new egret.Bitmap,t._xImage=new egret.Bitmap,t._ysImage=new egret.Bitmap,t._yImage=new egret.Bitmap,t._yxImage=new egret.Bitmap,t._Init(),t}return __extends(t,e),t.prototype._Init=function(){this._zsImage.texture=RES.getRes("wait_di_png"),this._zImage.texture=RES.getRes("wait_di_png"),this._zxImage.texture=RES.getRes("wait_di_png"),this._sImage.texture=RES.getRes("wait_di_png"),this._xImage.texture=RES.getRes("wait_di_png"),this._ysImage.texture=RES.getRes("wait_di_png"),this._yImage.texture=RES.getRes("wait_di_png"),this._yxImage.texture=RES.getRes("wait_di_png"),this._zsImage.touchEnabled=!0,this._zImage.touchEnabled=!0,this._zxImage.touchEnabled=!0,this._sImage.touchEnabled=!0,this._xImage.touchEnabled=!0,this._ysImage.touchEnabled=!0,this._yImage.touchEnabled=!0,this._yxImage.touchEnabled=!0,this._zsImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._zImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._zxImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._sImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._xImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._ysImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._yImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this._yxImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBGClick,this),this.addChild(this._zsImage),this.addChild(this._zImage),this.addChild(this._zxImage),this.addChild(this._sImage),this.addChild(this._xImage),this.addChild(this._ysImage),this.addChild(this._yImage),this.addChild(this._yxImage),this.SetSize(400,200,40,80)},t.prototype.SetSize=function(e,t,i,n){var a=640,r=1136;i>a&&(i=a),n>r&&(n=r),this._zsImage.x=this._zImage.x=this._zxImage.x=0,this._sImage.x=this._xImage.x=e,this._ysImage.x=this._yImage.x=this._yxImage.x=e+i,this._zsImage.y=this._sImage.y=this._ysImage.y=0,this._zImage.y=this._yImage.y=t,this._zxImage.y=this._xImage.y=this._yxImage.y=t+n,this._zsImage.width=this._zImage.width=this._zxImage.width=e,this._sImage.width=this._xImage.width=i,this._ysImage.width=this._yImage.width=this._yxImage.width=a-(e+i),this._zsImage.height=this._sImage.height=this._ysImage.height=t,this._zImage.height=this._yImage.height=n,this._zxImage.height=this._xImage.height=this._yxImage.height=r-(t+n)},t.prototype._OnBGClick=function(e){e.stopPropagation(),e.stopImmediatePropagation()},t}(egret.DisplayObjectContainer);__reflect(MaskBG.prototype,"MaskBG");var IntegralExchangeList=function(e){function t(){var t=e.call(this)||this;return t._gitId=0,t.skinName="resource/game_skins/IntegralExchangeListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),GameEvent.AddEventListener(EventType.ActivityScore,this.upDataScore.bind(this),this),this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._haveReceiveIma.source="jifen_yilingqu"+e+"_png",this._textLabel.text=StringMgr.GetText("integraltext1"),this._receiveButton.skinName=SkinCreateMgr.CreateButton("jifen_an_lingqu_l"+e+"_png","jifen_an_lingqu_l"+e+"_png","jifen_an_lingqu_h"+e+"_png"),this._receiveButton.enabled=!0,this._exchangInfo.condition&&IntegralManager.Score>=this._exchangInfo.condition?this._receiveButton.enabled=!0:this._receiveButton.enabled=!1},t.prototype.onReceiveClick=function(){SoundManager.PlayButtonMusic(),NetManager.SendRequest(["func="+NetNumber.ActivityGetBonus+"&id="+this._gitId],this._ReveiveActivityGetBonus.bind(this))},t.prototype._ReveiveActivityGetBonus=function(e){var t=e.code,i=e.data;t==NetManager.SuccessCode&&(IntegralManager.GitStateById(this._gitId,1),PromptManager.ShowGit(i.bonus)),this.upDataShow(null)},t.prototype.upDataShow=function(e){e&&(this._exchangInfo=e,this._gitId=this._exchangInfo.stageid),this.upDataScore();for(var t=this._exchangInfo.rewards.split(";"),i=0;i<t.length;i++){var n=t[i].split(","),a=this.showItemIma(n),r=a[1];if(parseInt(a[1])>1e4){var o=parseInt(a[1])/1e3;r=o+"k"}0==i?(this._itemIcon1.source=a[0],this._itemNumLabel1.text=r):(this._itemIcon2.source=a[0],this._itemNumLabel2.text=r)}},t.prototype.upDataScore=function(){this._integralNumLabel.text=IntegralManager.Score+"/"+this._exchangInfo.condition,IntegralManager.Score>=this._exchangInfo.condition?this._receiveButton.enabled=!0:this._receiveButton.enabled=!1,1==IntegralManager.GitState[this._gitId]?(this._haveReceiveIma.visible=!0,this._receiveButton.visible=!1,this._integralNumLabel.visible=!1):(this._haveReceiveIma.visible=!1,this._receiveButton.visible=!0,this._integralNumLabel.visible=!0)},t.prototype.showItemIma=function(e){if(null!=e){if("M"==e[0])return["fenxiang_jinbi_png",e[1]];if("A"==e[0])return["fenxiang_daoju_tili_png",e[1]];if("D"==e[0])return["fenxiang_jifen_png",e[1]];if("I"==e[0]||"C"==e[0]){var t=ItemManager.GetItemByID(parseInt(e[1]));if(null!=t)return[t.ImageRes,e[2]];if(null==t&&"C"==e[0]&&"0"==e[1])return["suipian_weizhi_png",e[2]]}}},t}(AWindow);__reflect(IntegralExchangeList.prototype,"IntegralExchangeList");var IntegralRankList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/IntegralRankListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._playerNameLabel.multiline=!1,this._playerNameLabel.height=30},t.prototype._UpdataText=function(){this._isPlayer?(this._xiaofeiLabel.textColor=9654530,this._playerNameLabel.textColor=9654530,this._integralNumLabel.textColor=9654530,this._itemNumLabel1.font="inteitemnumfont2"+StringMgr.LanguageSuffix+"_fnt",this._itemNumLabel2.font="inteitemnumfont2"+StringMgr.LanguageSuffix+"_fnt"):(this._xiaofeiLabel.textColor=2383773,this._playerNameLabel.textColor=2383773,this._integralNumLabel.textColor=2383773,this._itemNumLabel1.font="inteitemnumfont1"+StringMgr.LanguageSuffix+"_fnt",this._itemNumLabel2.font="inteitemnumfont1"+StringMgr.LanguageSuffix+"_fnt"),""==StringMgr.LanguageSuffix?this._xiaofeiLabel.text="积分:":this._xiaofeiLabel.text="Point:"},t.prototype.upDataShow=function(e,t,i){this._isPlayer=e;for(var n=t.rank,a=null,r=[],o=0;o<i.length;o++)if(n<=i[o].endrank){a=i[o].rewards;break}if(this._integralNumLabel.text=t.score,this._playerNameLabel.text=decodeURIComponent(t.name),this._playerIconIma.source=RES.getRes("touxiang_mr_jpg"),""!=t.icon){var s=new egret.ImageLoader;s.load(t.icon),s.addEventListener(egret.Event.COMPLETE,function(){this._playerIconIma.source=s.data},this)}r=a.split(";");for(var o=0;o<r.length;o++){var u=r[o].split(","),l=this.showItemIma(u),h=l[1];if(parseInt(l[1])>1e4){var c=parseInt(l[1])/1e3;h=c+"k"}0==o?(this._itemIcon1.source=l[0],this._itemNumLabel1.text=l[1]):(this._itemIcon2.source=l[0],this._itemNumLabel2.text=l[1])}if(3>=n){var _=StringMgr.LanguageSuffix;this._rankNumBgIma.texture=RES.getRes("jifen_paiming_"+n+_+"_png"),this._rankNumLabel.visible=!1}else this._rankNumBgIma.texture=RES.getRes("jifen_paiming_mr_png"),this._rankNumLabel.visible=!0,this._rankNumLabel.text="d"+n.toString()+"m";this._rankListGroup.visible=!this._isPlayer,this._MyRankListGroup.visible=this._isPlayer,this._isPlayer?(this._xiaofeiLabel.textColor=9654530,this._playerNameLabel.textColor=9654530,this._integralNumLabel.textColor=9654530,this._itemNumLabel1.font="inteitemnumfont2"+StringMgr.LanguageSuffix+"_fnt",this._itemNumLabel2.font="inteitemnumfont2"+StringMgr.LanguageSuffix+"_fnt"):(this._xiaofeiLabel.textColor=2383773,this._playerNameLabel.textColor=2383773,this._integralNumLabel.textColor=2383773,this._itemNumLabel1.font="inteitemnumfont1"+StringMgr.LanguageSuffix+"_fnt",this._itemNumLabel2.font="inteitemnumfont1"+StringMgr.LanguageSuffix+"_fnt"),""==StringMgr.LanguageSuffix?this._xiaofeiLabel.text="积分:":this._xiaofeiLabel.text="Point:"},t.prototype.showItemIma=function(e){if(null!=e){if("M"==e[0])return["fenxiang_jinbi_png",e[1]];if("A"==e[0])return["fenxiang_daoju_tili_png",e[1]];if("D"==e[0])return["fenxiang_jifen_png",e[1]];if("I"==e[0]||"C"==e[0]){var t=ItemManager.GetItemByID(parseInt(e[1]));if(null!=t)return[t.ImageRes,e[2]];if(null==t&&"C"==e[0]&&"0"==e[1])return["suipian_weizhi_png",e[2]]}}},t}(AWindow);__reflect(IntegralRankList.prototype,"IntegralRankList");var IntegralRuleWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/IntegralRulePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseClick,this)},t.prototype.upDataShow=function(e){this.IsVisibled=!0,this._ruleLabel.text=e,this._bg.source="huodongguize_di"+StringMgr.LanguageSuffix+"_png"},t.prototype.onCloseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.TopLayer.addChild(this):Main.Instance.TopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(IntegralRuleWindow.prototype,"IntegralRuleWindow");var IntegralWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._listSet=[],t._rankListSet=[],t._exchangeListSet=[],t._IntegralTypeData=null,t._IntegralRankDataSet=[],t._IntegralExchangeDataSet=[],t._rankObjectSet=[],t.skinName="resource/game_skins/IntegralWindowSkins.exml",t._ReadData(),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=new eui.RadioButtonGroup;t.addEventListener(egret.Event.CHANGE,this._UpdataPage,this),this._integralExchangeRadio.group=t,this._integralExchangeRadio.value=1,this._integralRankRadio.group=t,this._integralRankRadio.value=2,this._UpdataPage(null),this.touchEnabled=!0,this.touchChildren=!0,this._ruleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRuleClick,this),this._UpdataShow()},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._integralTimeLabel0.text=StringMgr.GetText("integraltext2"),this._integralExchangeRadio.skinName=SkinCreateMgr.CreateRadioButton("jifen_an_duihuan_huang"+e+"_png","jifen_an_duihuan_lan"+e+"_png"),this._integralRankRadio.skinName=SkinCreateMgr.CreateRadioButton("jifen_an_paihang_huang"+e+"_png","jifen_an_paihang_lan"+e+"_png"),this._UpdataShow(),0==IntegralManager.RankNum?this._myRankNumLabel.text=StringMgr.GetText("integraltext3"):this._myRankNumLabel.text=StringMgr.GetText("integraltext4")+IntegralManager.RankNum},t.prototype._ReadData=function(){this._IntegralTypeData=IntegralManager.IntegralInformation(),this._IntegralExchangeDataSet=IntegralManager.IntegralExchangeRewardsData(),this._IntegralRankDataSet=IntegralManager.IntegralRankRewards()},t.prototype.onRuleClick=function(e){return null==WindowManager.IntegralRuleWindow()?void WindowManager.SetWindowFunction(this._OpenIntegralRule.bind(this)):void this._OpenIntegralRule()},t.prototype._OpenIntegralRule=function(){this._exchangeGroup.visible?WindowManager.IntegralRuleWindow().upDataShow(StringMgr.GetText(this._IntegralTypeData.cumulativerule)):WindowManager.IntegralRuleWindow().upDataShow(StringMgr.GetText(this._IntegralTypeData.rankingrule))},t.prototype._UpdataPage=function(e){var t=1;if(null!=e){var i=e.target;t=i.selectedValue}this._exchangeGroup.visible=1==t,this._rankGroup.visible=2==t,this._rankGroup.visible?NetManager.SendRequest(["func="+NetNumber.ActivityRankList],this._ReveiveActivityRank.bind(this)):this._UpdataShow()},t.prototype._ReveiveActivityRank=function(e){var t=e.code;t==NetManager.SuccessCode&&(this._rankObjectSet=e.data.list),this._UpdataShow()},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._rankGroup.visible&&NetManager.SendRequest(["func="+NetNumber.ActivityRankList],this._ReveiveActivityRank.bind(this))):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._UpdataShow=function(){if(this._exchangeGroup.visible){for(var e=0;e<this._exchangeListSet.length;e++)null!=this._exchangeListSet[e].parent&&this._exchangeListGroup.removeChild(this._exchangeListSet[e]);for(var t=0,i=0,n=null,a=0;a<this._IntegralExchangeDataSet.length;a++)n=this._GetExchangeList(t),n.upDataShow(this._IntegralExchangeDataSet[a]),this._exchangeListGroup.addChild(n),n.y=i,t+=1,i+=n.height}if(this._rankGroup.visible){for(var e=0;e<this._rankListSet.length;e++)null!=this._rankListSet[e].parent&&this._rankListGroup.removeChild(this._rankListSet[e]);for(var r=0,o=!1,t=0,i=0,n=null,a=0;a<this._rankObjectSet.length;a++)0!=this._rankObjectSet[a].rank&&(n=this._GetRankList(t),this._rankObjectSet[a].openid==UnitManager.PlayerID?(r=this._rankObjectSet[a].rank,o=!0):o=!1,n.upDataShow(o,this._rankObjectSet[a],this._IntegralRankDataSet),this._rankListGroup.addChild(n),n.y=i,t+=1,i+=n.height);IntegralManager.RankNum=r,0==IntegralManager.RankNum?this._myRankNumLabel.text=StringMgr.GetText("integraltext3"):this._myRankNumLabel.text=StringMgr.GetText("integraltext4")+IntegralManager.RankNum}this._integralTimeLabel.text=StringMgr.GetText("integraltext5")+IntegralManager.StartTime+"—"+IntegralManager.EndTime},t.prototype._GetExchangeList=function(e){var t=null;return e<this._exchangeListSet.length?t=this._exchangeListSet[e]:(t=new IntegralExchangeList,this._exchangeListSet.push(t)),t
},t.prototype._GetRankList=function(e){var t=null;return e<this._rankListSet.length?t=this._rankListSet[e]:(t=new IntegralRankList,this._rankListSet.push(t)),t},t}(AWindow);__reflect(IntegralWindow.prototype,"IntegralWindow");var KeepRewardTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/KeepRewardTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._addButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.AddShouCangGuide2()},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="shoucang_di"+e+"_png",this._addButton.skinName=SkinCreateMgr.CreateButton("shoucang_an_liji_l"+e+"_png","shoucang_an_liji_a"+e+"_png")},t.prototype.onTap=function(e){this.IsVisibled=!1,GuideManager.GuideFinish(8)},t.prototype.AddShouCangGuide2=function(){var e=this._addButton.x,t=this._addButton.y,i=this._addButton.width,n=this._addButton.height;GuideManager.ShowGuideWindow(0,e,t,i,n)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(KeepRewardTip.prototype,"KeepRewardTip");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t._Init(),t}return __extends(t,e),t.prototype._Init=function(){var e=new eui.Image;e.source="loading_di_jpg",this.addChild(e),this._bgMov=ArmaturePool.GetArmature("loading_liuguang_json","loading_liuguangtexture_json","loading_liuguangtexture_png","loading_liuguang");var t=this._bgMov.display;t.x=320,t.y=568,this.addChild(t),this._bgMov.animation.play("loading_liuguang",0),this._loadingMovieClip=new egret.MovieClip(MovieManager.GetMovieClipData("loading_tiaoAni_json","loading_tiaoAni_png","loading_tiao")),this._loadingMovieClip.x=45,this._loadingMovieClip.y=995,this.addChild(this._loadingMovieClip),this._lodingLabel=new eui.Label,this._lodingLabel.textColor=3562922,this._lodingLabel.size=32,this._lodingLabel.bold=!0,this._lodingLabel.fontFamily="微软雅黑",this._lodingLabel.width=640,this._lodingLabel.textAlign="center",this._lodingLabel.y=this._loadingMovieClip.y-25,this._lodingLabel.text="0%",this.addChild(this._lodingLabel);var i=new egret.TextField;i.fontFamily="微软雅黑",i.size=16,i.width=300,i.height=50,i.x=0,i.y=0,i.textColor=0,i.text="app:"+Main.AppVersion+"   res:"+Main.ResVersion,this.addChild(i)},t.prototype.SetProgress=function(e,t){this._lodingLabel.text=Math.floor(e/t*100).toString()+"%",this._loadingMovieClip.gotoAndStop(Math.floor(e/t*100))},t.prototype.Destroy=function(){this._bgMov.animation.stop("loading_liuguang"),ArmaturePool.ReturnPool(this._bgMov)},t}(egret.DisplayObjectContainer);__reflect(LoadingUI.prototype,"LoadingUI");var NoticeList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/NoticeListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},t.prototype.upDateShow=function(e,t){if(this._curNotice=e,this._noticePosiId=t,this._group1.visible=0==this._curNotice.Bonus.length?!0:!1,this._group2.visible=0==this._curNotice.Bonus.length?!1:!0,1==this._group1.visible)this._information1.text=this._curNotice.Des;else if(1==this._group2.visible){this._information2.text=this._curNotice.Des;for(var i=this._curNotice.BonusRes,n=0;n<i.length;n++)0==n?(this._itemGroup1.visible=!0,this._itemGroup2.visible=!1,this._itemIcon1.texture=RES.getRes(i[n].res),this._itemNumLabel1.text=i[n].num.toString()):(this._itemGroup2.visible=!0,this._itemIcon2.texture=RES.getRes(i[n].res),this._itemNumLabel2.text=i[n].num.toString())}this.isRead?this._redIma.visible=!1:this._redIma.visible=!0;var a=(new Date).getTime()/1e3|0,r=a-this._curNotice.Time,o=r%60,s=Math.floor(r%3600/60),u=Math.floor(r/3600%24),l=Math.floor(r/86400),h=Math.floor(l/7),c=Math.floor(l/30),_=Math.floor(c/12);_>0?this._timeLabel.text=_+StringMgr.GetText("noticepagetext1"):c>0?this._timeLabel.text=c+StringMgr.GetText("noticepagetext2"):h>0?this._timeLabel.text=h+StringMgr.GetText("noticepagetext3"):l>0?this._timeLabel.text=l+StringMgr.GetText("noticepagetext4"):u>0?this._timeLabel.text=u+StringMgr.GetText("noticepagetext5"):s>0?this._timeLabel.text=s+StringMgr.GetText("noticepagetext6"):o>=0?this._timeLabel.text=o+StringMgr.GetText("noticepagetext7"):0>o&&(this._timeLabel.text="0"+StringMgr.GetText("noticepagetext7"))},t.prototype.onTap=function(e){0==this.isRead&&NetManager.SendRequest(["func="+NetNumber.SendNoticeRead+"&idx="+this._noticePosiId],this._ReviceReadNotice.bind(this))},t.prototype._ReviceReadNotice=function(e){e.code==NetManager.SuccessCode&&(NoticeManager.GetNoticeByPosiId(this._noticePosiId).IsRead=!0,this.upDateShow(this._curNotice,this._noticePosiId),this._curNotice.Bonus.length>0&&PromptManager.ShowGit(this._curNotice.Bonus),GameEvent.DispatchEvent(EventType.NoticeUpDataResIma))},Object.defineProperty(t.prototype,"isRead",{get:function(){return this._curNotice.IsRead},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(NoticeList.prototype,"NoticeList");var NoticePage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._noticeSet=[],t.skinName="resource/game_skins/NoticePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),GameEvent.AddEventListener(EventType.NoticeUpData,this.updataShow.bind(this),this),GameEvent.AddEventListener(EventType.NoticeUpDataResIma,this.updataShow.bind(this),this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._noticeRadio.skinName=SkinCreateMgr.CreateRadioButton("xiaoxi_xitong_l"+e+"_png","xiaoxi_xitong_a"+e+"_png"),this.updataShow()},t.prototype.updataShow=function(){var e=0,t=!1;if(null!=NoticeManager.AllNoticeSet){for(var i=0;i<NoticeManager.AllNoticeSet.length;i++){var n=this._GetList(i);this._group.addChild(n);var a=NoticeManager.AllNoticeSet.length-i-1;n.upDateShow(NoticeManager.AllNoticeSet[NoticeManager.AllNoticeSet.length-i-1],a),n.y=e,e=n.y+n.height,0==NoticeManager.AllNoticeSet[NoticeManager.AllNoticeSet.length-i-1].IsRead&&(t=!0)}this._sysRedIma.visible=t}},t.prototype._GetList=function(e){var t=null;return e<this._noticeSet.length?t=this._noticeSet[e]:(t=new NoticeList,this._noticeSet.push(t)),t},t.prototype._GetData=function(){for(var e=0;e<this._noticeSet.length;e++)null!=this._noticeSet[e].parent&&this._group.removeChild(this._noticeSet[e]);NetManager.SendRequest(["func="+NetNumber.GetNoticeList],NoticeManager.updataNoticeReturn.bind(NoticeManager))},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._GetData()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(NoticePage.prototype,"NoticePage");var NoticeDetailPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/NoticeDetailPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._neirongLabel.touchEnabled=!0,this._weihuLabel.touchEnabled=!0,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._weihuButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onWeiHuDown,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._closeButton.skinName=SkinCreateMgr.CreateButton("anniu_queding_l"+e+"_png","anniu_queding_a"+e+"_png"),this._nameImage.source="wenzi_xitongonggao"+e+"_png",this._bg&&(this._weihuButton.skinName=SkinCreateMgr.CreateButton("anniu_queding_l"+e+"_png","anniu_queding_a"+e+"_png"),this._bg.source="tishi_di"+e+"_png")},t.prototype.onCloseDown=function(e){this.IsVisibled=!1},t.prototype.onWeiHuDown=function(e){this.IsVisibled=!1,document.location.reload()},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.MainTopLayer.addChild(this):Main.MainTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.Show=function(e,t){this.IsVisibled=!0,null==t&&(t=""),this._neirongLabel.text=t},t.prototype.ShowWeihu=function(e){this.IsVisibled=!0,this._weihuLabel.lineSpacing=10,this._weihuLabel.text=e,this.skin.currentState="weihu",this._weihuLabel.height=this._weihuLabel.textHeight},t.prototype.ShowGenxin=function(e){this.IsVisibled=!0,this._neirongLabel.lineSpacing=10,this._neirongLabel.text=e,this.skin.currentState="genxin",this._neirongLabel.height=this._neirongLabel.textHeight},t}(eui.Component);__reflect(NoticeDetailPage.prototype,"NoticeDetailPage");var CenterPromptPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._yesParam=null,t._noParam=null,t._closeTime=0,t._timer=0,t._showParam=null,t.skinName="resource/game_skins/CenterPromptPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),ProcessManager.AddProcess(this._Process.bind(this)),t._instance=this,this._noButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnNoButtonClick,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnNoButtonClick,this),this._yesButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnYesButtonClick,this),this._daojishiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnYesButtonClick,this),this._daojishiLabel.touchEnabled=!1},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._noButton.skinName=SkinCreateMgr.CreateButton("anniu_quxiao_l"+e+"_png","anniu_quxiao_a"+e+"_png"),this._yesButton.skinName=SkinCreateMgr.CreateButton("anniu_queding_l"+e+"_png","anniu_queding_a"+e+"_png"),this._daojishiBtn.skinName=SkinCreateMgr.CreateButton("anniu_queding_time_l"+e+"_png","anniu_queding_time_a"+e+"_png"),this._shareButton.skinName=SkinCreateMgr.CreateButton("anniu_fenxiang_l"+e+"_png","anniu_fenxiang_a"+e+"_png")},t.prototype.ShowPrompt=function(e,t,i,n,a,r,o,s,u){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===u&&(u=!1),this.IsVisibled?void(this._showParam=[e,t,i,n,a,r,o,s,u]):(this.IsVisibled=!0,this._yesFun=a,this._noFun=r,this._yesParam=o,this._noParam=s,void(e||(t?(this.skin.currentState="auto",null!=n?(this._iconIma.visible=!0,this._iconIma.texture=RES.getRes(n),this._msgLabel.y=500):(this._iconIma.visible=!1,this._msgLabel.y=483),this._msgLabel.text=i,this._closeTime=3,this._daojishiLabel.text="("+this._closeTime+")"):(u?(this._shareButton.visible=!0,this._noButton.visible=!1):(this._shareButton.visible=!1,this._noButton.visible=!0),this._closeTime=0,this.skin.currentState="normal",this._msgLabel.text=i))))},t.prototype._Process=function(e){if(this.IsVisibled||0==this._closeTime){var t=1e3;this._timer+=e,this._timer>=t&&(this._timer-=t,this._closeTime-=1,0!=this._closeTime?this._daojishiLabel.text="("+this._closeTime+")":this._OnYesButtonClick())}},t.prototype._OnNoButtonClick=function(){SoundManager.PlayButtonMusic(),null!=this._noFun&&(this._noFun(this._noParam),this._noFun=null,this._noParam=null),this.IsVisibled=!1},t.prototype._OnYesButtonClick=function(){SoundManager.PlayButtonMusic(),null!=this._yesFun&&(this._yesFun(this._yesParam),this._yesFun=null,this._yesParam=null),this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.TopLayer.addChild(this):(Main.Instance.TopLayer.removeChild(this),null!=this._showParam&&(this.ShowPrompt(this._showParam[0],this._showParam[1],this._showParam[2],this._showParam[3],this._showParam[4],this._showParam[5],this._showParam[6],this._showParam[7],this._showParam[8]),this._showParam=null)))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(CenterPromptPage.prototype,"CenterPromptPage");var GetItemTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._closeTime=0,t._timer=0,t.skinName="resource/game_skins/GetItemTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._timeLabel.touchEnabled=!1,this._button.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),ProcessManager.AddProcess(this._Process.bind(this))},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="huodedaoju"+e+"_png",this._button.skinName=SkinCreateMgr.CreateButton("anniu_queding_time_l"+e+"_png","anniu_queding_time_a"+e+"_png")},t.prototype._OnClick=function(){this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){if(this._isVisibled!=e)if(e){var t=egret.Tween.get(this);t.wait(3e3).call(this._OnAdd.bind(this))}else Main.Instance.WindowTopLayer.removeChild(this),this._isVisibled=e},enumerable:!0,configurable:!0}),t.prototype._OnAdd=function(){egret.Tween.removeTweens(this),this._isVisibled=!0,Main.Instance.WindowTopLayer.addChild(this),this._closeTime=3,this._timer=0,this._timeLabel.text="("+this._closeTime+")"},t.prototype._Process=function(e){if(this.IsVisibled||0==this._closeTime){var t=1e3;this._timer+=e,this._timer>=t&&(this._timer-=t,this._closeTime-=1,0!=this._closeTime?this._timeLabel.text="("+this._closeTime+")":this.IsVisibled=!1)}},t}(AWindow);__reflect(GetItemTip.prototype,"GetItemTip");var MaoPaoTip=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!0,t._isCreat=!1,t.skinName="resource/game_skins/MaoPaoTipSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreat=!0,this.IsVisibled&&this.upDataShow()},t.prototype.setData=function(e,t){this._msg=e,this._type=t,this.upDataShow()},t.prototype.upDataShow=function(){this._isCreat&&(1==this._type?(this._smallMaoPaoTipGroup.visible=!0,this._bigMaoPaoTipGroup.visible=!1,this._smallMaoPaoLabel.text=this._msg,this._smallMaoPaoTipGroup.x=-32,this._smallMaoPaoTipGroup.y=-70):(this._smallMaoPaoTipGroup.visible=!1,this._bigMaoPaoTipGroup.visible=!0,this._smallMaoPaoLabel.text=this._msg,this._bigMaoPaoTipGroup.x=-92,this._bigMaoPaoTipGroup.y=-122))},t.prototype.showAni=function(){egret.Tween.removeTweens(this),this.scaleX=0,this.scaleY=0,egret.Tween.get(this).to({scaleX:1,scaleY:1},500)},t.prototype.removeAni=function(){egret.Tween.removeTweens(this),this.scaleX=1,this.scaleY=1,egret.Tween.get(this).to({scaleX:0,scaleY:0},500).call(function(){this.visible=!1},this)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(this.visible=!0,this.upDataShow(),this.showAni()):this.removeAni())},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(MaoPaoTip.prototype,"MaoPaoTip");var Game=function(e){function t(){var t=e.call(this)||this;return t._showSkillIDSet=[],t._isShowSkillMovie=!1,t._skillTimer=0,t._gameSkillTipSet=[],t._scoreSet=[1232,2034,3029,4021,5836,6284,7356,8520,9953,10099,11003,12987,13764,14328,15602,20846],t._scoreState=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],t._scoreIndex=0,t._ifAniPlay=!0,t._roleSet=[],t._jumpDis=0,t._scoreNum=0,t._updataTimer=0,t._isWin=!1,t._starNum=0,t._endScore=0,t._isRoleLifeEmpty=!1,t._isFrist=!1,t._endlessDifficulty=3,t._endlessDieCount=0,t._endlessStartDifficulty=3,t._endlessScoreSet=[400,900,1600,2500,3600,4900,6300],t._endlessDifSet=[4,5,6,7,8,9,10],t._moveFriendArr=[],t._linpao=[],t._friendRankSet=[],t._isreadygo=!1,t._friendRankSet2=[],t._lastRankNum=0,t._endRankNum=0,t._lastItemPosiY=0,t._isQuanPingSkillAni=!1,t._quanpingSkill=null,t._xueTimes=0,t._isGamePause=!1,t._Init(),t}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t.prototype._Init=function(){t._instance=this,this._bg=new eui.Image(MapManager.SceneJsonData.bg),this._sceneLayer=new egret.DisplayObjectContainer,this._moveLayer=new egret.DisplayObjectContainer,this._mapLayer=new egret.DisplayObjectContainer,this._outDoorLayer=new egret.DisplayObjectContainer,this._roleLayer=new egret.DisplayObjectContainer,this._doorLayer=new egret.DisplayObjectContainer,this._topLayer=new egret.DisplayObjectContainer,this._weatherLayer=new egret.DisplayObjectContainer,this.addChild(this._bg),this.addChild(this._sceneLayer),this.addChild(this._moveLayer),this._moveLayer.addChild(this._mapLayer),this._moveLayer.addChild(this._outDoorLayer),this._moveLayer.addChild(this._roleLayer),this._moveLayer.addChild(this._doorLayer),this._moveLayer.addChild(this._topLayer),this._top=new eui.Image(MapManager.SceneJsonData.top),this.addChild(this._top),this.addChild(this._weatherLayer),this._friendBg=new eui.Image,this._friendScore=new FriendGameScore,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._OnMouseClick,this),GameEvent.AddEventListener(EventType.GameEnd,this._GameRealEnd,this),GameEvent.AddEventListener(EventType.RoleLifeEmpty,this._GameRoleLifeEmpty,this),ProcessManager.AddProcess(this._Process.bind(this)),this.StarBattle()},t.prototype.StarBattle=function(){if(null!=this._paperairArm1&&(ArmaturePool.ReturnMoviePool(this._paperairArm1),this._paperairArm1=null),null!=this._paperairArm2&&(ArmaturePool.ReturnMoviePool(this._paperairArm2),this._paperairArm2=null),this._currentPaper=null,t._isInitArm=!1,ArmaturePool.Init(),t._isInitMap=!1,MapManager.creatAllMap(),CheckpointManager.IsEndless||CheckpointManager.IsDailyActive){var e=JSON.parse("{}");e.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.GameEnd+"&start=0&score=0&money=0&oemInfo="+JSON.stringify(e)],this._GameStartComplete.bind(this))}else CheckpointManager.IsCatch?NetManager.SendRequest(["func="+NetNumber.StartCatch+"&id="+CheckpointManager.CurrentCheckpointID],this._GameStartComplete.bind(this)):CheckpointManager.IsRunaway?NetManager.SendRequest(["func="+NetNumber.StartEscape+"&id="+CheckpointManager.CurrentCheckpointID],this._GameStartComplete.bind(this)):NetManager.SendRequest(["func="+NetNumber.CheckpointStar+"&id="+CheckpointManager.CurrentCheckpointID],this._GameStartComplete.bind(this));var e=JSON.parse("{}");this._friendRankSet2=[],e.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.FriendRanking+"&oemInfo="+JSON.stringify(e)],this._ReceiveFriendRank.bind(this)),this._friendRankInfo=null,this._playerRankInfo=null,this._lastRankNum=101,t.Instance.EndRankNum=0,CheckpointManager.CurrentCheckpoint?MapManager.SetSceneIndex(CheckpointManager.CurrentCheckpoint.SceneId):MapManager.SetSceneIndex(2001),0!=UnitManager.CurrentRole.Scene&&UnitManager.CurrentRole.IsSceneStart&&MapManager.SetSceneIndex(UnitManager.CurrentRole.Scene),Main.IsNeedNetDebug||this._GameStartComplete({code:0})},t.prototype._GameStartComplete=function(e){var i=e.code;if(i!=NetManager.SuccessCode){var n=!1;switch(i){case 603:case 9004:PromptManager.CreatCenterTip(!1,!0,"体力不足"),n=!0}return 0==n&&PromptManager.CreatCenterTip(!1,!0,"进入游戏失败！"),void(WindowManager.WaitPage().IsVisibled=!1)}if(MapManager.IsUpdateMap=!1,GameEvent.DispatchEvent(EventType.GameStart),this._bg&&(this._bg.texture=RES.getRes(MapManager.SceneJsonData.bg)),this._top&&(this._top.texture=RES.getRes(MapManager.SceneJsonData.top)),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this._moveLayer),egret.Tween.removeTweens(this._sceneLayer),null!=this._mapSet&&this._mapSet.length>0)for(;this._mapSet.length>0;)this._mapSet[0].Destroy(),this._mapLayer.removeChild(this._mapSet.shift());if(null!=this._sceneSet&&this._sceneSet.length>0)for(;this._sceneSet.length>0;)this._sceneSet[0].Destroy(),this._sceneLayer.removeChild(this._sceneSet.shift());if(null!=this._roleSet&&this._roleSet.length>0)for(;this._roleSet.length>0;)this._roleSet[0].Destroy(),this._roleSet.shift();null!=GameRole.LastRole&&(GameRole.LastRole.Destroy(),GameRole.LastRole=null),this._moveLayer.y=0,this._sceneLayer.y=0,this._scoreNum=0,this._goldNum=0,this._timer=0,this._isRoleLifeEmpty=!1,WindowManager.GameUI().UIInit(),SkillManager.StartGame(),UnitManager.CurrentRole.GameInit(),this._CreateScene(),this._CreateScene(),this._CreateScene(),this._CreateMap(),this._CreateMap(),SoundManager.PlayBattleBGMusic(),t._isStarReturn=!0,t._isInitArm&&t._isInitMap&&t._isStarReturn&&(WindowManager.WaitPage().IsVisibled=!1),this.afterJiaoChengPage(),null!=WindowManager.AchievementTip(!1)&&WindowManager.AchievementTip().IsVisibled&&(WindowManager.AchievementTip().IsVisibled=!1)},t.prototype.creatJiaoChengPage=function(){null==this._jiaoChengPage&&(this._jiaoChengPage=new eui.Image,this._jiaoChengPage.texture=RES.getRes("xinshou_jiaocheng"+StringMgr.LanguageSuffix+"_png"),this._jiaoChengPage.touchEnabled=!1),Main.Instance.GameLayer.addChild(this._jiaoChengPage)},t.prototype.afterJiaoChengPage=function(){if(this._jiaoChengPage&&null!=this._jiaoChengPage.parent&&Main.Instance.GameLayer.removeChild(this._jiaoChengPage),t.Instance.ChangeSize(new egret.Point(312,0)),null!=CheckpointManager.CurrentCheckpoint&&""!=CheckpointManager.CurrentCheckpoint.TipID){var e="",i="",n=RES.getRes("chaptertipdata_json"),a=n[CheckpointManager.CurrentCheckpoint.TipID];null!=a&&(e=a.pic+"_png",i=StringMgr.GetText(a.desc)),PromptManager.ShowGameTip(i,e,this.jixuGame.bind(this))}else this.jixuGame()},t.prototype.jixuGame=function(){if(t.GameStatus=!0,null!=CheckpointManager.CurrentCheckpoint&&0!=CheckpointManager.CurrentCheckpoint.Effect&&(1==CheckpointManager.CurrentCheckpoint.Effect?WeatherManager.Start(WeatherManager.Rain):WeatherManager.Start(WeatherManager.Snow)),this._moveFriendArr.length>0)for(var e=0;e<this._moveFriendArr.length;e++)this.removeChild(this._moveFriendArr[e]);this._moveFriendArr=[],this.contains(this._friendScore)&&(this.removeChild(this._friendBg),this.removeChild(this._friendScore))},t.prototype.creatBeiDongSkillTip=function(){if(!CheckpointManager.IsEndless&&!CheckpointManager.IsDailyActive){this._gameSkillTipSet=[];var e=UnitManager.CurrentRole.UseSkillSet,t=[11,8,7,9,14,17,20];if(null!=e&&e.length>0)for(var i=0;i<e.length;i++)-1==t.indexOf(e[i].ID)&&this.creatZhuDongSkillTip(e[i].ID)}},t.prototype._ShowSkillMovie=function(){if(this._showSkillIDSet.length<=0)return void(this._isShowSkillMovie=!1);this._isShowSkillMovie=!0;var e=this._showSkillIDSet.shift(),t=new GameSkill(e);t.x=320,t.y=300,this.addChild(t),this._skillTimer=0},t.prototype.creatZhuDongSkillTip=function(e){this._isShowSkillMovie?this._showSkillIDSet.push(e):(this._showSkillIDSet.push(e),this._ShowSkillMovie())},t.prototype._CreateMap=function(){if(null==this._mapSet&&(this._mapSet=[]),null!=this._scoreNum){this._scoreNum>this._endlessScoreSet[0]&&(this._endlessStartDifficulty=3);for(var e=0;e<this._endlessScoreSet.length;e++)if(this._scoreNum<=this._endlessScoreSet[e]){0!=e&&(this._endlessDifficulty=this._endlessDifSet[e-1]);break}}var t=null;if(0==this._mapSet.length)t=CheckpointManager.IsEndless||CheckpointManager.IsDailyActive?MapManager.GetNewMap(this._endlessDifficulty,!0):MapManager.GetMap(),t.CreateMap(),t.y=0;else{t=CheckpointManager.IsEndless||CheckpointManager.IsDailyActive?MapManager.GetNewMap(this._endlessDifficulty):MapManager.GetMap(),t.CreateMap();var i=this._mapSet[this._mapSet.length-1];null!=i?t.y=i.y+i.Height:t.y=0}this._CreateDoor(t),this._mapSet.push(t),this._mapLayer.addChild(t);var n=1==this._mapSet.length;this._CreateGold(t,n)},t.prototype._CreateScene=function(){null==this._sceneSet&&(this._sceneSet=[]);var e=new Scene;if(0==this._sceneSet.length)e.y=0;else{var t=this._sceneSet[this._sceneSet.length-1];e.y=t.y+t.height}e.CreateScene(),this._sceneSet.push(e),this._sceneLayer.addChild(e)},t.prototype._InitRole=function(){GameRole.IsFriend=!1,null==this._roleSet&&(this._roleSet=[]);for(var e=this._mapSet[0],i=0;i<e.RoadCount;i++){var n=new GameRole;n.CreateRole(),n.Road=e.GetRoad(i),n.Map=e,n.x=n.MoveRoad[0].x,n.y=n.MoveRoad[0].y,n.Prop=!0,this._roleLayer.addChild(n),this._roleSet.push(n),n.Move();break}t.RoleStatus=0,GameRole.RoleIsDie=!1,this._xueTimes=0,this._roleSet[0].MapMoveMark=!0,t.Instance.ChangeSize(new egret.Point(this._roleSet[0].localToGlobal().x,0)),WindowManager.GameUI().StarGame(),this.weatherEffect(),this.creatBeiDongSkillTip()},t.prototype.weatherEffect=function(){var e=3e3,t=5e3;if(UnitManager.CurrentRole.ImmuneHurt)return void(1==CheckpointManager.CurrentCheckpoint.Effect?this._weathertime=egret.setTimeout(this.weatherEffect,this,t):2==CheckpointManager.CurrentCheckpoint.Effect&&(this._weathertime=egret.setTimeout(this.weatherEffect,this,e)));for(var i=!1,n=!1,a=0;a<this._roleSet.length;a++)this._roleSet[a].IsWuDi&&(i=!0),this._roleSet[a].IsDie||(n=!0);if(i||!n){var r=1==CheckpointManager.CurrentCheckpoint.Effect?t:2==CheckpointManager.CurrentCheckpoint.Effect?e:0;return void(0!=r&&(this._weathertime=egret.setTimeout(this.weatherEffect,this,r)))}var o=null==CheckpointManager.CurrentCheckpoint?1:CheckpointManager.CurrentCheckpoint.Difficulty;if(null!=CheckpointManager.CurrentCheckpoint&&0!=CheckpointManager.CurrentCheckpoint.Effect){egret.clearTimeout(this._weathertime);var s,u=WindowManager.GameUI().Role;if(null!=this._roleSet[0]&&(s=new egret.Point(this._roleSet[0].localToGlobal().x,this._roleSet[0].localToGlobal().y)),1==CheckpointManager.CurrentCheckpoint.Effect){var l=Math.ceil((.01*u.MaxLife+10*o)*(1-u.InjuryFreeRate));WindowManager.GameUI().BuckleBlood(l,s),this._weathertime=egret.setTimeout(this.weatherEffect,this,t)}else if(2==CheckpointManager.CurrentCheckpoint.Effect){var h=0;this._xueTimes+=1,3==this._xueTimes&&(this._xueTimes=0,h=.02*u.MaxLife);var l=Math.ceil((40+o)*o*.1);WindowManager.GameUI().BuckleBlood(l+h,s),this._weathertime=egret.setTimeout(this.weatherEffect,this,e)}}},t.prototype.CreateRole=function(e){for(var t=this._roleSet[0].Map,i=1;i<t.RoadCount;i++){var n=t.GetRoad(i);if(!n.IsCreateRole){n.IsCreateRole=!0;var a=new GameRole;a.CreateRole(),a.Road=n,a.Map=t,a.x=a.MoveRoad[0].x+t.x,a.y=a.MoveRoad[0].y+t.y,a.Prop=!0,a.ReviveTime=this._roleSet[0].ReviveTime,this._roleLayer.addChild(a),this._roleSet.push(a),a.Move()}}t.OutDoorOpen(e),this.UpdataRoleMoveMark()},t.prototype.UpdataRoleMoveMark=function(){if(null!=this._roleSet&&0!=this._roleSet.length){var e=this._roleSet[0];e.MapMoveMark=!0;for(var t=1;t<this._roleSet.length;t++)this._roleSet[t].y>e.y&&(e.MapMoveMark=!1,this._roleSet[t].MapMoveMark=!0,e=this._roleSet[t])}},t.prototype.RoleConfluence=function(e,i){if(t.Instance.UpdataRoleMoveMark(),0==this._roleSet.length)return!1;for(var n=!1,a=0;a<this._roleSet.length;a++)if(e!=this._roleSet[a]&&!(this._roleSet[a].Road.GroupNum>i)&&e.y<=this._roleSet[a].y){n=!0;break}if(n){for(var a=0;a<this._roleSet.length;a++)if(e==this._roleSet[a]){this._roleSet.splice(a,1);break}return e.Disappear(),!0}return!1},t.prototype.MapMove=function(e,t){this._jumpDis>0&&(e+=this._jumpDis,this._jumpDis=0),egret.Tween.removeTweens(this._moveLayer);var i=this._moveLayer.y-e,n=egret.Tween.get(this._moveLayer);n.to({y:i},t),egret.Tween.removeTweens(this._sceneLayer);var a=this._sceneLayer.y-e,r=egret.Tween.get(this._sceneLayer);r.to({y:a},t),this._SceneMoveEnd()},t.prototype._SceneMoveEnd=function(){var e=this._sceneSet[0];this._sceneLayer.y+e.y+e.height<=0&&(e.Destroy(),this._sceneLayer.removeChild(e),this._sceneSet.splice(0,1),this._CreateScene(),this._PaperairPlay())},t.prototype.RoleUpdataMap=function(e,t){for(var i=0;i<this._roleSet.length;i++)if(e==this._roleSet[i]){if(e==this._roleSet[i])break;return!1}for(var i=0;i<this._mapSet.length;i++)if(this._mapSet[i]==t){if(i==this._mapSet.length-1)return!1;var n=this._mapSet[i+1];e.Road=n.GetRoad(0),e.Map=n}for(var i=0;i<this._mapSet.length;i++){var a=this._moveLayer.y+this._mapSet[i].Height+this._mapSet[i].y;if(0>a){var t=this._mapSet[i];this._mapLayer.removeChild(this._mapSet[i]),this._mapSet.splice(i,1),t.Destroy(),i--}}return this._mapSet.length<3&&this._CreateMap(),!0},t.prototype._OnMouseClick=function(e){if(this._jiaoChengPage&&null!=this._jiaoChengPage.parent&&this.afterJiaoChengPage(),!GameRole.RoleIsDie&&!GameRole.IsFriend&&t.GameStatus)if(0==t.RoleStatus){t.RoleStatus=1;for(var i=0;i<this._roleSet.length;i++)this._roleSet[i].RoleJump()}else 1==t.RoleStatus&&GameRole.RoleCanJump&&(t.RoleStatus=2)},t.prototype.CheckGameEnd=function(e){if(!GameRole.IsFriend){if(CheckpointManager.IsEndless||CheckpointManager.IsDailyActive){for(var i=0;i<this._roleSet.length;i++)if(this._roleSet[i]==e){this._roleSet[i].Die(1==this._roleSet.length,!1),this._roleSet.splice(i,1),t.Instance.UpdataRoleMoveMark();break}return this._roleSet.length<=0?(GameEvent.DispatchEvent(EventType.RoleLifeEmpty),!0):!1}for(var n=!1,a=!1,r=5e3,i=0;i<this._roleSet.length;i++)if(this._roleSet[i]==e){if(1==this._roleSet.length){if(this.FallHole(),this._isRoleLifeEmpty)return void(this._isRoleLifeEmpty=!1);n=!0,WindowManager.GameUI().Role.CurrentLife>0&&(a=!0,r=2e3)}this._roleSet[i].Die(n,a,r),(!n||n&&!a)&&this._roleSet.splice(i,1),t.Instance.UpdataRoleMoveMark();break}return n}},t.prototype._GameRoleLifeEmpty=function(){this._isRoleLifeEmpty=!0;for(var e=!1,i=!1,n=5e3;this._roleSet.length>0;)1==this._roleSet.length&&(e=!0),this._roleSet[0].Die(e,i,n),(!e||e&&!i)&&this._roleSet.splice(0,1),t.Instance.UpdataRoleMoveMark()},t.prototype.FallHole=function(){var e;null!=this._roleSet[0]&&(e=new egret.Point(this._roleSet[0].localToGlobal().x,this._roleSet[0].localToGlobal().y)),WindowManager.GameUI().BuckleBlood(0,e)},t.prototype.GameRevive=function(){null==this._daojishiArm?(this._daojishiArm=ArmaturePool.GetArmature("daojishi_json","daojishitexture_json","daojishitexture_png","daojishi"),this._daojishiArm.display.x=320,this._daojishiArm.display.y=568):MovieManager.ADDArmature(this._daojishiArm),this._daojishiArm.addEventListener(dragonBones.Event.COMPLETE,this._OnDaojishiEnd,this),this.addChild(this._daojishiArm.display),this._daojishiArm.animation.play("daojishi",1),this._friendScore.visible=!0,this._friendBg.visible=!0,this.scaleX=this.scaleY=1,WindowManager.GameUI().IsVisibled=!0},t.prototype._OnDaojishiEnd=function(){this._daojishiArm.removeEventListener(dragonBones.Event.COMPLETE,this._OnDaojishiEnd,this),this.removeChild(this._daojishiArm.display),dragonBones.WorldClock.clock.remove(this._daojishiArm),t.GameStatus=!0,this._roleSet.push(GameRole.LastRole),this._roleSet[0].Revive(),this.UpdataRoleMoveMark(),GameEvent.DispatchEvent(EventType.RoleRevive)},Object.defineProperty(t.prototype,"JumpDis",{set:function(e){this._jumpDis=e},enumerable:!0,configurable:!0}),t.prototype._CreateDoor=function(e){if(null!=e)for(var i=0;i<e.RoadCount;i++)for(var n=e.GetRoad(i),a=n.MoveRoad,r=n.RoadType,o=n.DoorTypeSet,s=0;s<a.length-1&&!(i>0&&s>2);s++){var u=0==s?null:a[s-1],l=a[s+1],h=r[s],c=a[s],_=o[s];if(4==h&&null!=u){var d=void 0;Math.abs(c.x-u.x)<=t.PianchaNum?(d=ArmaturePool.GetMovieArmature("entrance01_idle_json","entrance01_idle_png","entrance01_idle"),d.name="entrance01"):(d=ArmaturePool.GetMovieArmature("entrance02_idle_json","entrance02_idle_png","entrance02_idle"),d.name="entrance02",c.x>u.x?d.scaleX=-1:d.scaleX=1),d.x=c.x,d.y=e.y+c.y+12,d[Map.DoorType]=_,d.play(-1),this._doorLayer.addChild(d),e.AddEnterDoor(d)}if(5==h){var p;Math.abs(c.x-l.x)<=t.PianchaNum?(p=ArmaturePool.GetMovieArmature("exit01_idle_json","exit01_idle_png","exit01_idle"),p.name="exit01"):(p=ArmaturePool.GetMovieArmature("exit02_idle_json","exit02_idle_png","exit02_idle"),p.name="exit02",c.x<l.x?p.scaleX=-1:p.scaleX=1),p.x=c.x,p.y=e.y+c.y,p[Map.DoorType]=_,p.play(-1),this._outDoorLayer.addChild(p),e.AddOutDoor(p)
}}},t.prototype.ChangeSize=function(e,t){if(void 0===t&&(t=!1),null!=e){this.anchorOffsetX=e.x,this.anchorOffsetY=e.y,this.x=e.x,this.y=e.y,this._friendScore.visible=!1,this._friendBg.visible=!1,WindowManager.GameUI().IsVisibled=!1;var i=egret.Tween.get(this);if(t?(this.scaleX=this.scaleY=1,i.to({scaleX:1.3,scaleY:1.3},600).call(this._ChangeSizeEnd,this)):i.to({scaleX:1,scaleY:1},600).call(this._ChangeSizeEnd,this),this._moveFriendArr.length>0)for(var n=0;n<this._moveFriendArr.length;n++)this.removeChild(this._moveFriendArr[n]);this._moveFriendArr=[]}},t.prototype._ChangeSizeEnd=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this._sceneLayer),egret.Tween.removeTweens(this._moveLayer),1==this.scaleX&&(this._friendScore.visible=!0,this._friendBg.visible=!0,WindowManager.GameUI().IsVisibled=!0)},t.prototype._AddScore=function(){this._scoreNum+=this._roleSet.length,GameEvent.DispatchEvent(EventType.GameScoreChange)},Object.defineProperty(t.prototype,"Score",{get:function(){var e=this._scoreNum;return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndScore",{get:function(){return this._endScore},enumerable:!0,configurable:!0}),t.prototype._Process=function(e){if(t.GameStatus&&!this.IsGamePause){if(null==this._ready&&0==this._isreadygo)return this.createReady(),void(this._isreadygo=!0);if(GameRole.IsFriend)return void(GameRole.IsFriend=!1);this._isShowSkillMovie&&(this._skillTimer+=e,this._skillTimer>=900&&this._ShowSkillMovie());var i=330,n=Math.ceil(1.414*i);this._timer+=e,GameRole.IsDirect&&this._timer>=i?(this._timer-=i,this._AddScore()):!GameRole.IsDirect&&this._timer>=n&&(this._timer-=n,this._AddScore());for(var a=0;a<this._roleSet.length;a++)this._roleSet[a].Process(e)}},t.prototype.createReady=function(){null==this._ready&&(this._ready=new eui.Image),this._ready.texture=RES.getRes("wz_ready_png"),this._topLayer.addChild(this._ready),this._ready.anchorOffsetX=this._ready.width/2,this._ready.anchorOffsetY=this._ready.height/2,this._ready.x=345,this._ready.y=500,this._ready.scaleX=1.049,this._ready.scaleY=1.049,this._ready.alpha=1;egret.Tween.get(this._ready).to({scaleX:1,scaleY:1},300).to({scaleX:1.1,scaleY:1.1},300).to({scaleX:1,scaleY:1},300).to({scaleX:1.644,scaleY:1.644,alpha:0},1300).wait(500).call(function(){this._topLayer.removeChild(this._ready),this._ready=null,this.creatego()}.bind(this))},t.prototype.creatego=function(){null==this._go&&(this._go=new eui.Image),this._go.texture=RES.getRes("wz_go_png"),this._topLayer.addChild(this._go),this._go.anchorOffsetX=this._go.width/2,this._go.anchorOffsetY=this._go.height/2,this._go.x=345,this._go.y=500,this._go.scaleX=1.049,this._go.scaleY=1.049,this._go.alpha=1;egret.Tween.get(this._go).to({scaleX:1,scaleY:1},135).wait(600).to({alpha:0},428).call(function(){this._topLayer.removeChild(this._go),this._go=null,this._InitRole()}.bind(this))},t.prototype.AddGoldNum=function(){this._goldNum+=1,GameEvent.DispatchEvent(EventType.GameMoneyChange)},Object.defineProperty(t.prototype,"GoldNum",{get:function(){var e=this._goldNum;return e},enumerable:!0,configurable:!0}),t.prototype._CreateGold=function(e,t){if(null!=e){var i=45,n=36;this._goldGroupNum=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var a=0;a<e.RoadCount;a++){var r=e.GetRoad(a),o=r.MoveRoad,s=r.RoadType,u=r.GroupSet,l=0;t&&(l+=1);for(var h=o[l],c=l+1;c<o.length-1;c++)if(2!=s[c-1]&&4!=s[c-1]&&6!=s[c-1]){if(h.x==o[c].x&&o[c].y-h.y>=i||o[c].y-h.y>=n){if(0!=u[c-1]){for(var _=!1,d=u[c-1];d<this._goldGroupNum.length;d++)if(1==this._goldGroupNum[d]){_=!0;break}if(_)break}this._AddObject(e,r,h,o[c],u[c-1])}h=o[c]}else h=o[c];this._goldGroupNum[r.GroupNum]=1}e.GoldSort()}},t.prototype._AddObject=function(e,i,n,a,r){var o,s=.4,u=33,l=29,h=20;Math.abs(n.x-a.x)<=t.PianchaNum?o=0:n.x<a.x?o=2:n.x>a.x&&(o=1);var c=n.y,_=new egret.Point;for(_.copyFrom(n),_.x+=0==o?0:1==o?-14:14,_.y+=8;_.y<=a.y-10;){var d=Math.random();if(s>d){var p,g=CheckpointManager.CurrentCheckpoint,m=Math.random();if(Math.abs(c-_.y)<70&&(m=1),null!=g&&m<=g.LuckyRate){var f=ObjectPool.getPool("LuckyChest").borrowObject();f.Direction=o,p=f,c=_.y}else if(null!=g&&m<=g.RandomRate+g.LuckyRate&&m>g.LuckyRate){var v=ObjectPool.getPool("RandomChest").borrowObject();p=v,c=_.y}else if(null!=g&&m<=g.LuckyRate+g.RandomRate+g.AirRate&&m>g.RandomRate+g.LuckyRate){var y=ObjectPool.getPool("AirBox").borrowObject();p=y,c=_.y}else if(null!=g&&m<=g.LuckyRate+g.RandomRate+g.AirRate+g.BombRate&&m>g.LuckyRate+g.RandomRate+g.AirRate){var S=ObjectPool.getPool("BombBox").borrowObject();p=S,c=_.y}else{var b=ObjectPool.getPool("Gold").borrowObject();p=b}p.x=_.x,p.y=e.y+_.y,this._mapLayer.addChild(p),i.AddObject(p),0!=r&&e.AddObject(p,r,i)}_.x+=0==o?0:1==o?-l:l,_.y+=0==o?u:h}},Object.defineProperty(t.prototype,"TopLayer",{get:function(){return this._topLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WeatherLayer",{get:function(){return this._weatherLayer},enumerable:!0,configurable:!0}),t.prototype._PaperairPlay=function(){null==this._currentPaper&&(Math.random()>.5||(null==this._paperairArm1&&(this._paperairArm1=ArmaturePool.GetMovieArmature(MapManager.SceneJsonData.paperair[0].res+"_json",MapManager.SceneJsonData.paperair[0].res+"_png",MapManager.SceneJsonData.paperair[0].res),this._paperairArm2=ArmaturePool.GetMovieArmature(MapManager.SceneJsonData.paperair[1].res+"_json",MapManager.SceneJsonData.paperair[1].res+"_png",MapManager.SceneJsonData.paperair[1].res)),this._currentPaper&&ArmaturePool.ReturnMoviePool(this._currentPaper),Math.random()>.5?(this._currentPaper=this._paperairArm1,this._paperName=MapManager.SceneJsonData.paperair[0]):(this._currentPaper=this._paperairArm2,this._paperName=MapManager.SceneJsonData.paperair[1]),this._currentPaper.addEventListener(egret.Event.COMPLETE,this._PaperairComplete,this),this.addChild(this._currentPaper),this._currentPaper.play(1)))},t.prototype._PaperairComplete=function(){this._currentPaper&&ArmaturePool.ReturnMoviePool(this._currentPaper),this._currentPaper=null},Object.defineProperty(t.prototype,"IsWin",{get:function(){return this._isWin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Star",{get:function(){return this._starNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FristRolePosition",{get:function(){if(null!=this._roleSet&&this._roleSet.length>0){var e=new egret.Point(this._roleSet[0].localToGlobal().x,this._roleSet[0].localToGlobal().y);return e}return null},enumerable:!0,configurable:!0}),t.prototype.judgeIsChaoYueFriend=function(){var e=t.Instance.EndScore,i=0;if(t.Instance.EndRankNum=t.Instance.LastRankNum,null!=t.Instance.playerInfo&&(i=t.Instance.playerInfo.score),e>i&&t.Instance.FriendSet.length>=1)for(var n=0;n<t.Instance.FriendSet.length;n++)if(parseInt(t.Instance.FriendSet[n][2])<=e){t.Instance.chaoYueFriendInfo=t.Instance.FriendSet[n],t.Instance.EndRankNum=parseInt(t.Instance.FriendSet[n][0]);break}return t.Instance.EndRankNum>=t.Instance.LastRankNum?!1:!0},t.prototype._GameRealEnd=function(){t.GameStatus=!1,egret.clearTimeout(this._weathertime),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this._moveLayer),egret.Tween.removeTweens(this._sceneLayer);for(var e=0;e<this._roleSet.length;e++)egret.Tween.removeTweens(this._roleSet[e]);for(var e=0;e<this._roleSet.length;e++)this._roleSet[e].Stop();var i=WindowManager.GameUI().Role,n=i.ScoreRate,a=i.MoneyRate,r=i.BonusRate,o=i.VictoryAction?1:0,s=1;if(CheckpointManager.IsEndless){var u=JSON.parse("{}");u.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.GameEnd+"&start=1&score="+this.Score+"&money="+this.GoldNum+"&oemInfo="+JSON.stringify(u)],this._ReceiveEndlessGameEnd.bind(this))}else if(CheckpointManager.IsDailyActive){var u=JSON.parse("{}");u.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.GameEnd+"&start=1&score="+this.Score+"&money="+this.GoldNum+"&oemInfo="+JSON.stringify(u)],this._ReceiveEndlessGameEnd.bind(this)),NetManager.SendRequest(["func=dailyactivity.setScore&id="+this.Score])}else CheckpointManager.IsCatch?NetManager.SendRequest(["func="+NetNumber.EndCatch,"&id="+CheckpointManager.CurrentCheckpointID,"&blood="+i.CurrentLife],this._ReceiveCatchGameEnd.bind(this)):CheckpointManager.IsRunaway?NetManager.SendRequest(["func="+NetNumber.EscapeEnd,"&id="+CheckpointManager.CurrentCheckpointID,"&blood="+i.CurrentLife],this._ReceiveEscapeGameEnd.bind(this)):NetManager.SendRequest(["func="+NetNumber.CheckpointEnd+"&id="+CheckpointManager.CurrentCheckpointID,"&score="+this.Score,"&blood="+i.CurrentLife,"&money="+this.GoldNum,"&scorerate="+n,"&moneyrate="+a,"&bonusrate="+r,"&victoryaction="+o+"&super="+s],this._ReceiveGameEnd.bind(this));MapManager.IsUpdateMap=!0,WindowManager.WaitPage().IsVisibled=!0,egret.clearTimeout(this._weathertime),WeatherManager.Stop()},t.prototype._ReceiveCatchGameEnd=function(e){return WindowManager.GameUI().gameEnd(),this._isreadygo=!1,e.code!=NetManager.SuccessCode?void Main.AddDebug("奴隶抓捕战斗结束错误，code="+e.code):void 0},t.prototype._ReceiveEscapeGameEnd=function(e){return WindowManager.GameUI().gameEnd(),this._isreadygo=!1,e.code!=NetManager.SuccessCode?void Main.AddDebug("奴隶反抗战斗结束错误，code="+e.code):void 0},t.prototype._ReceiveEndlessGameEnd=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.data;return UnitManager.Player.Money=t.money,this._isWin=!1,this._endScore=this.Score,this._endScore<this._endlessScoreSet[0]&&(this._endlessDieCount+=1,this._endlessDieCount>=3&&(this._endlessStartDifficulty=Math.max(this._endlessStartDifficulty-1,1))),WindowManager.GameUI().gameEnd(),this._isreadygo=!1,null==WindowManager.SuccFailWindow()?void WindowManager.SetWindowFunction(this._OpenSuccFailWindow.bind(this),[!1,[{type:"M",num:this._goldNum}],null]):void WindowManager.SuccFailWindow().onShow(!1,[{type:"M",num:this._goldNum}],null)},t.prototype._ReceiveGameEnd=function(e){t.IsShowTopTip=!1,WindowManager.WaitPage().IsVisibled=!1;var i=!0;e.code!=NetManager.SuccessCode&&(Main.AddDebug("返回出错:"+e.code),i=!1);var n=WindowManager.GameUI().Role,a=CheckpointManager.CurrentCheckpoint,r=0,o=(a.MaxScore,0),s=a.Star,u=0==s,l=null;if(i){var h=e.data;if(null!=h){var r=h.score,o=(h.scoreM,h.star),s=h.starM,l=h.bonus,c=[];null!=h.firstBonus&&(c=h.firstBonus);var _=[];null!=h.superBonus&&(_=h.superBonus),l=l.concat(c),this._isWin=n.CurrentLife>0,this._starNum=o,this._endScore=r,r>UnitManager.Player.MaxScore&&(UnitManager.Player.MaxScore=r)}}else this._isWin=!1,u=!1,this._starNum=0,this._endScore=0;if(this._isFrist=u,a.IsPass=s>0,a.Star=s,WindowManager.GameUI().gameEnd(),this._isreadygo=!1,t.Instance.IsWin){if(CheckpointManager.PassCheckpoint(a.ID),null==WindowManager.SuccFailWindow())return void WindowManager.SetWindowFunction(this._OpenSuccFailWindow.bind(this),[!0,l,_]);WindowManager.SuccFailWindow().onShow(!0,l,_)}else{if(null==WindowManager.SuccFailWindow())return void WindowManager.SetWindowFunction(this._OpenSuccFailWindow.bind(this),[!1,l,_]);WindowManager.SuccFailWindow().onShow(!1,l,_)}},t.prototype._OpenSuccFailWindow=function(e){WindowManager.SuccFailWindow().onShow(e[0],e[1],e[2])},t.prototype._OpenEndWindow=function(e){WindowManager.EndWindow().Show(e)},t.prototype.ChangeRoleStatus=function(e,i){if(void 0===i&&(i=null),1==e)this._roleSet[0].ChangeStatus(1,i);else if(2==e)for(var n=0;n<this._roleSet.length;n++)this._roleSet[n].ChangeStatus(2);else if(4==e)for(var n=0;n<this._roleSet.length;n++)this._roleSet[n].creatSkillAni(1);else if(5==e)for(var n=0;n<this._roleSet.length;n++)this._roleSet[n].creatSkillAni(2,i);else if(6==e)for(var n=0;n<this._roleSet.length;n++)this._roleSet[n].creatSkillAni(3);else if(7==e)for(var n=0;n<this._roleSet.length;n++)this._roleSet[n].creatSkillAni(4,i);if(5==e||6==e||7==e){var a="";5==e?a="mingrenquanpingji":6==e?a="zuozhuquanpingji":7==e&&(a="xiaoyinquanpingji"),""!=a?(t.Instance.Pause(),this._isQuanPingSkillAni=!0,this._quanpingSkill=ArmaturePool.GetArmature(a+"_json",a+"texture_json",a+"texture_png",a),WindowManager.GameUI().addChild(this._quanpingSkill.display),this._quanpingSkill.display.x=320,this._quanpingSkill.display.y=568,this._quanpingSkill.display.visible=!0,this._quanpingSkill.animation.play(a,1),this._quanpingSkill.addEventListener(dragonBones.Event.COMPLETE,this.skillTimeOut,this)):this.skillTimeOut()}},t.prototype.skillTimeOut=function(){null!=this._quanpingSkill&&(ArmaturePool.ReturnPool(this._quanpingSkill),this._quanpingSkill=null),1==this._isQuanPingSkillAni&&(t.Instance.Continue(),this._isQuanPingSkillAni=!1)},Object.defineProperty(t.prototype,"FenShenCount",{get:function(){return null==this._roleSet&&0==this._roleSet.length?0:this._roleSet[1].FenShenCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFrist",{get:function(){return this._isFrist},enumerable:!0,configurable:!0}),t.prototype._ReceiveFriendRank=function(e){return},Object.defineProperty(t.prototype,"FriendSet",{get:function(){return this._friendRankSet2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playerInfo",{get:function(){return this._playerRankInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastRankNum",{get:function(){return this._lastRankNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndRankNum",{get:function(){return this._endRankNum},set:function(e){this._endRankNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chaoYueFriendInfo",{get:function(){return this._friendRankInfo},set:function(e){this._friendRankInfo=e},enumerable:!0,configurable:!0}),t.prototype.clearSkillAni=function(){for(var e=0;e<this._roleSet.length;e++)this._roleSet[e].clearSkillAni()},t.prototype.clearOneSkillAni=function(){for(var e=0;e<this._roleSet.length;e++)this._roleSet[e].clearOneSkillAni()},t.prototype.Pause=function(){if(this._isGamePause=!0,egret.Tween.pauseTweens(this),null!=this._roleSet)for(var e=0;e<this._roleSet.length;e++)this._roleSet[e].Pause()},t.prototype.Continue=function(){if(this._isGamePause=!1,egret.Tween.resumeTweens(this),null!=this._roleSet)for(var e=0;e<this._roleSet.length;e++)this._roleSet[e].Continue()},Object.defineProperty(t.prototype,"IsGamePause",{get:function(){return this._isGamePause},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);Game.IsIos=!0,Game.GameWidth=640,Game.MoveSpeed=223,Game.RoleYLimit=400,Game.RoleStatus=0,Game.GameStatus=!1,Game.PianchaNum=8,Game.IsShowTopTip=!0,Game._isInitArm=!1,Game._isInitMap=!1,Game._isStarReturn=!1,__reflect(Game.prototype,"Game");var MyRankList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/MyRankListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.upDateShow()},t.prototype.upDateShow=function(){this._rankNumLabel.text=StringMgr.GetText("rankpagetext1"),this._userIma.source=UnitManager.Player.HearUrl,this._nameLabel.text=UnitManager.Player.Name,this._scoreLabel.text=UnitManager.Player.MaxScore.toString()},t}(eui.Component);__reflect(MyRankList.prototype,"MyRankList");var RankList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/RankListSkins.exml",t.height=72,t}return __extends(t,e),t.prototype.SetData=function(e,t,i,n){void 0===n&&(n=""),this._lanNameLabel.text=this._baiNameLabel.text=t,this._lanLabel1.text=this._baiLabel1.text=i;var a=parseInt(e),r=a%2==1;if(this._baiGroup.visible=r,this._lanGroup.visible=!r,3>=a?(this._rankNumLabel.visible=!1,this._rankImage.visible=!0,this._rankImage.texture=RES.getRes("mingci_"+e+"_png"),this._rankUserIma.visible=!0,this._rankUserIma.texture=RES.getRes("touxiang_kuang_"+e+"_png")):(this._rankNumLabel.visible=!0,this._rankImage.visible=!1,this._rankUserIma.visible=!1),"未上榜"!=e?(this._noRankLabel.visible=!1,this._rankNumLabel.visible=!0,this._rankNumLabel.text=e):(this._noRankLabel.visible=!0,this._rankNumLabel.visible=!1),this._iconImaSource!=n&&(this._userIma.source="touxiang_mr_jpg"),""!=n){var o=new egret.ImageLoader;o.load(n),o.addEventListener(egret.Event.COMPLETE,function(){this._userIma.source=o.data,this._iconImaSource=n},this)}},t}(eui.Component);__reflect(RankList.prototype,"RankList");var RankWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._listSet=[],t._showListSet=[],t._ifRankUp=!1,t.skinName="resource/game_skins/RankPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=new eui.RadioButtonGroup;t.addEventListener(egret.Event.CHANGE,this._UpdataShow,this),this._totalRank.group=t,this._dayRank.group=t,this._friendRank.group=t,this._totalRank.value=1,this._dayRank.value=2,this._friendRank.value=3},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._totalRank.skinName=SkinCreateMgr.CreateRadioButton("paihang_lsan_on"+e+"_png","paihang_lsan_off"+e+"_png"),this._dayRank.skinName=SkinCreateMgr.CreateRadioButton("paihang_dran_on"+e+"_png","paihang_dran_off"+e+"_png","dianzan_off"+e+"_png"),this._friendRank.skinName=SkinCreateMgr.CreateRadioButton("paihang_hyan_on"+e+"_png","paihang_hyan_off"+e+"_png"),this._text3.text=StringMgr.GetText("dailyactivetext1"),StringMgr.Language==StringMgr.CN?(this._text1.text="名次",this._text2.text="玩家名字"):(this._text1.text="Rank",this._text2.text="Player")},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._GetData()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._UpdataShow=function(e){var t=1;if(this._scroller.viewport.scrollV=0,null!=e)var i=e.target,t=i.selectedValue;else this._dayRank.selected?t=2:this._friendRank.selected&&(t=3);var n=this._totalRankSet;for(1==t?n=this._totalRankSet:2==t?n=this._dayRankSet:3==t&&(n=this._friendRankSet);this._showListSet.length>0;){var a=this._showListSet.pop();this._listGroup.removeChild(a),this._listSet.push(a)}if(null!=n){for(var r=0,o=0;o<n.length;o++){var a;a=o>=this._listSet.length?new RankList:this._listSet.pop(),a.y=r,r+=a.height,a.SetData(n[o][0],n[o][1],n[o][2],n[o][3]),this._listGroup.addChild(a),this._showListSet.push(a)}if(0==this._ifRankUp&&3==t&&UnitManager.Player.MaxScore>0){var a;a=n.length>=this._listSet.length?new RankList:this._listSet.pop(),a.y=r,r+=a.height,a.SetData(StringMgr.GetText("rankpagetext1"),UnitManager.Player.Name,UnitManager.Player.MaxScore.toString(),UnitManager.Player.HearUrl),this._listGroup.addChild(a),this._showListSet.push(a)}}},t.prototype._GetData=function(){var e=JSON.parse("{}");e.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.Ranking+"&oemInfo="+JSON.stringify(e)],this._ReceiveTotalRank.bind(this)),NetManager.SendRequest(["func="+NetNumber.DayRanking+"&oemInfo="+JSON.stringify(e)],this._ReceiveDayRank.bind(this)),NetManager.SendRequest(["func="+NetNumber.FriendRanking+"&oemInfo="+JSON.stringify(e)],this._ReceiveFriendRank.bind(this))},t.prototype._ReceiveTotalRank=function(e){if(0==e.code){this._totalRankSet=[];for(var t=e.data.list,i=0;i<t.length;i++){var n=(i+1).toString(),a=decodeURIComponent(t[i].name),r=t[i].score;if(Main.IsLocationDebug)var o="";else var o=t[i].icon;this._totalRankSet.push([n,a,r,o])}this._UpdataShow(null)}},t.prototype._ReceiveDayRank=function(e){if(0==e.code){this._dayRankSet=[];for(var t=e.data.list,i=0;i<t.length;i++){var n=(i+1).toString(),a=decodeURIComponent(t[i].name),r=t[i].score;if(Main.IsLocationDebug)var o="";else var o=t[i].icon;this._dayRankSet.push([n,a,r,o])}this._UpdataShow(null)}},t.prototype._ReceiveFriendRank=function(e){if(0==e.code){this._friendRankSet=[];var t=e.data.list;if(this._ifRankUp=!1,null!=t&&t.length>0)for(var i=0;i<t.length;i++){var n=(i+1).toString(),a=decodeURIComponent(t[i].name),r=t[i].score;if(Main.IsLocationDebug)var o="";else var o=t[i].icon;this._friendRankSet.push([n,a,r,o]),t[i].openid==UnitManager.PlayerID&&(this._ifRankUp=!0)}this._UpdataShow(null)}},t}(AWindow);RankWindow.IsOpenStar=!1,__reflect(RankWindow.prototype,"RankWindow");var RoleDetail=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._curDongZuoNum=0,t._curAniNum=0,t._playMovName=[["walk"],["jump_01","jump_03"]],t._shenjiArmSet=[],t._tempLevel=0,t.skinName="resource/game_skins/RoleDetailSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._sxDetailGroup.visible=!1,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpDown,this),this._getButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetDown,this),this._detailButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onDetailDown,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onDetailUp,this),GameEvent.AddEventListener(EventType.RoleUpLevel,this._OnUpDataEvent,this),GameEvent.AddEventListener(EventType.RoleSuiPianItemUpdate,this._OnUpDataEvent,this),GameEvent.AddEventListener(EventType.RoleSkillUpLevel,this._OnUpDataEvent,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="juesexiangqing_di"+e+"_png",this._healthDetailLabel.text=StringMgr.GetText("roledetailtext1"),this._fangYuDetailLabel.text=StringMgr.GetText("roledetailtext2"),this._xinYunDetailLabel.text=StringMgr.GetText("roledetailtext3"),this._getButton.skinName=SkinCreateMgr.CreateButton("juesexiangqing_huode_l"+e+"_png","juesexiangqing_huode_a"+e+"_png","juesexiangqing_huode_off"+e+"_png"),this._upButton.skinName=SkinCreateMgr.CreateButton("juesexiangqing_shengji_l"+e+"_png","juesexiangqing_shengji_a"+e+"_png","juesexiangqing_shengji_off"+e+"_png")},t.prototype.onCloseDown=function(e){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},t.prototype.onUpDown=function(e){if(SoundManager.PlayButtonMusic(),this._curRole.GetCurRoleNum<this._curRole.UpLevelDebrisNum){var t=this._curRole.UpLevelDebrisNum-this._curRole.GetCurRoleNum;ItemManager.GetItemByID(this._curRole.Pieceid).Price*t;PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("roledetailtext4"),null,this._OnGoShopPage.bind(this))}else NetManager.SendRequest(["func="+NetNumber.upRole+"&id="+this._curRole.ID.toString()],this._UpRoleReturn.bind(this))},t.prototype.onGetDown=function(e){SoundManager.PlayButtonMusic(),this._curRole.GetCurRoleNum<this._curRole.UpLevelDebrisNum&&PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("roledetailtext4"),null,this._OnGoShopPage.bind(this))},t.prototype._OnGoShopPage=function(){return this.IsVisibled=!1,null==WindowManager.ShopWindow()?void WindowManager.SetWindowFunction(this._GoShop.bind(this)):void this._GoShop()},t.prototype._GoShop=function(){WindowManager.StarWindow().OpenWindow(WindowManager.ShopWindow()),WindowManager.ShopWindow().OpenRolePage()},t.prototype._UpRoleReturn=function(e){e.code==NetManager.SuccessCode?(ItemManager.SetItemCount(this._curRole.Pieceid,e.data.chip),this.creatShenJiDroArm()):PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("roledetailtext5"))},t.prototype.creatShenJiDroArm=function(){var e="shengji",t=new egret.MovieClip;t.movieClipData=MovieManager.GetMovieClipData(e+"_json",e+"_png",e),t.x=0,t.y=0,this.addChild(t),t.touchEnabled=!1,t.play(1),this._shenjiArmSet.push(t),t.addEventListener(egret.Event.COMPLETE,this.shengJiDroArmCom,this)},t.prototype.shengJiDroArmCom=function(e){if(this._shenjiArmSet[0]){this.removeChild(e.target),this._shenjiArmSet[0].removeEventListener(egret.Event.COMPLETE,this.shengJiDroArmCom,this),this._shenjiArmSet.splice(0,1);var t=this._curRole.MaxLife,i=this._curRole.Defense,n=this._curRole.Lucky;this._curRole.Level+=1,this.creatShenJiLabel(1,this._curRole.MaxLife-t),this.creatShenJiLabel(2,this._curRole.Defense-i),this.creatShenJiLabel(3,this._curRole.Lucky-n)}},t.prototype.creatShenJiLabel=function(e,t){var i=this,n=new eui.Label;this.addChild(n),n.size=24,n.textColor=15879742,n.bold=!0,n.fontFamily="微软雅黑",n.text="+"+t,n.x=533,1==e?n.y=292:2==e?n.y=332:3==e&&(n.y=368),egret.Tween.get(n).to({y:n.y-20},300).wait(100).to({y:n.y-30,alpha:0},200).call(function(){i.removeChild(n)},this)},t.prototype.onDetailDown=function(e){this._sxDetailGroup.visible=!0},t.prototype.onDetailUp=function(e){this._sxDetailGroup.visible=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):(this.returnRoleArmature(),this.removeUpAni(),Main.Instance.WindowTopLayer.removeChild(this)))},enumerable:!0,configurable:!0}),t.prototype.removeUpAni=function(){if(this._shenjiArmSet.length>0){this._curRole.Level+=this._shenjiArmSet.length;for(var e=0;e<this._shenjiArmSet.length;e++)this._shenjiArmSet[e].stop(),this._shenjiArmSet[e].removeEventListener(egret.Event.COMPLETE,this.shengJiDroArmCom,this),this.removeChild(this._shenjiArmSet[e]);this._shenjiArmSet=[]}},t.prototype._OnUpDataEvent=function(){null!=this._curRole&&(this._curRole=UnitManager.GetRole(this._curRole.ID),this.UpdataShow(this._curRole))},t.prototype.UpdataShow=function(e){this._curRole=e,this._levelLabel.text="LV."+this._curRole.Level.toString(),this._nameLabel.text=this._curRole.Name,this._healthLabel.text=this._curRole.MaxLife.toString(),this._fangYuLabel.text=this._curRole.Defense.toString(),this._XinYunLabel.text=this._curRole.Lucky.toString(),this._roleTeDianLabel.text=StringMgr.GetText("roledetailtext6")+this._curRole.Specialty,ItemManager.GetItemByID(this._curRole.Pieceid)&&(this._roleSuiPianIma.source=ItemManager.GetItemByID(this._curRole.Pieceid).ImageRes),this._curRole.GetCurRoleNum<this._curRole.UpLevelDebrisNum?(this._upButton.visible=!1,this._getButton.visible=!0):(this._upButton.visible=!0,this._getButton.visible=!1);var t=this._curRole.GetCurRoleNum/this._curRole.UpLevelDebrisNum;t>=1&&(t=1),this._curRole.Level<GameConstData.RoleMaxLevel&&0!=this._curRole.Level?(this._suiPianNumLabel.text=this._curRole.GetCurRoleNum.toString()+"/"+this._curRole.UpLevelDebrisNum.toString(),this._suiPianTiaoIma.width=265*t,this._upButton.enabled=!0):0==this._curRole.Level?(this._suiPianNumLabel.text=this._curRole.GetCurRoleNum.toString()+"/"+this._curRole.UpLevelDebrisNum.toString(),this._suiPianTiaoIma.width=265*t,this._upButton.enabled=!1,this._levelLabel.text="LV.1"):(this._suiPianNumLabel.text=StringMgr.GetText("roledetailtext7"),this._suiPianTiaoIma.width=265,this._upButton.enabled=!1,this._upButton.visible=!0,this._getButton.visible=!1),this._curRole.Level>=GameConstData.RoleMaxLevel||this._curRole.GetCurRoleNum<this._curRole.UpLevelDebrisNum?this._redIma.visible=!1:this._redIma.visible=!0;for(var i=[this._skill1,this._skill2,this._skill3],n=0;n<i.length;n++)i[n].upDateShow(this._curRole,n+1);this.creatRoleArmature()},t.prototype.creatRoleArmature=function(){if(ResReadyMgr.IsReady("startrole")){this.returnRoleArmature(),this._curAniNum=0,this._curDongZuoNum=0;var e=this._curRole.Res;this._curRoleArmature=ArmaturePool.GetArmature(e+"_01_json",e+"_01texture_json",e+"_01texture_png",e+"_01"),this.RandAniPlay(),this._curRoleArmature.display.x=205,this._curRoleArmature.display.y=355,this.addChild(this._curRoleArmature.display)}},t.prototype.RandAniPlay=function(){var e=0;do e=Math.floor(Math.random()*this._playMovName.length);while(this._curAniNum==e);this._curAniNum=e,this._curDongZuoNum=0,this._curRoleArmature.animation.play(this._playMovName[this._curAniNum][this._curDongZuoNum],1),this._curRoleArmature.addEventListener(dragonBones.Event.COMPLETE,this.AniComplete,this)},t.prototype.AniComplete=function(){this._curRoleArmature.removeEventListener(dragonBones.Event.COMPLETE,this.AniComplete,this),this._curDongZuoNum==this._playMovName[this._curAniNum].length-1?this.RandAniPlay():this.IsVisibled&&(this._curDongZuoNum+=1,this._curRoleArmature.animation.play(this._playMovName[this._curAniNum][this._curDongZuoNum],1),this._curRoleArmature.addEventListener(dragonBones.Event.COMPLETE,this.AniComplete,this))},t.prototype.returnRoleArmature=function(){null!=this._curRoleArmature&&(this._curRoleArmature.removeEventListener(dragonBones.Event.COMPLETE,this.AniComplete,this),this.removeChild(this._curRoleArmature.display),ArmaturePool.ReturnPool(this._curRoleArmature),this._curRoleArmature=null)},t}(AWindow);__reflect(RoleDetail.prototype,"RoleDetail");var RoleGetWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t.skinName="resource/game_skins/RoleGetWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseDown,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareDown,this),this._lookButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookDown,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._shareButton.skinName=SkinCreateMgr.CreateButton("juesehuode_an_fenxiang_l"+e+"_png","juesehuode_an_fenxiang_a"+e+"_png"),this._lookButton.skinName=SkinCreateMgr.CreateButton("juesehuode_an_chakan_l"+e+"_png","juesehuode_an_chakan_a"+e+"_png"),this._bg.source="juesehuode_di"+e+"_png",this._curRole&&(this._roleIma.source=this._curRole.GetRes+e+"_png")},t.prototype.onCloseDown=function(e){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},t.prototype.onShareDown=function(e){SoundManager.PlayButtonMusic(),null!=this._curRole?NetManager.SendRequest(["func=role.share&id="+this._curRole.ID+"&choose=1"]):NetManager.SendRequest(["func=sceneShare&type=1"]);var t=null==this._curRole?2005:this._curRole.ID,i=GameConstData.GetShareContentByID(t);2==i.length,this._shareButton.enabled=!1},t.prototype.onLookDown=function(e){SoundManager.PlayButtonMusic(),this.IsVisibled=!1;var t=WindowManager.RoleDetailWindow();t.UpdataShow(this._curRole),t.IsVisibled=!0},t.prototype.Show=function(e){this.IsVisibled=!0,this._lookButton.visible=!0,this._curRole=e,this._tipLabel.text=StringMgr.GetText("rolegetpagetext1")+this._curRole.Name,this._roleIma.source=this._curRole.GetRes+StringMgr.LanguageSuffix+"_png"},t.prototype.ShowImage=function(e){this.IsVisibled=!0,this._curRole=null,this._tipLabel.text=StringMgr.GetText("rolegetpagetext2"),this._lookButton.visible=!1,this._roleIma.texture=RES.getRes(e)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._shareButton.enabled=!0):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(RoleGetWindow.prototype,"RoleGetWindow");var RoleList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/RoleListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._peiYangButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPeiYangDown,this),this._jieSuoButton.enabled=!1,this._jieSuoButton.visible=!1,this._jieSuoButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJieSuoDown,this),this._yulanButton.visible=!0,this._yulanButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPeiYangDown,this),GameEvent.AddEventListener(EventType.RoleUpLevel,this._OnUpDataEvent,this),GameEvent.AddEventListener(EventType.RoleSkillUpLevel,this._OnUpDataEvent,this),GameEvent.AddEventListener(EventType.RoleSuiPianItemUpdate,this._OnUpDataEvent,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._textLabel.text=StringMgr.GetText("rolelisttext1"),this._peiYangButton.skinName=SkinCreateMgr.CreateButton("peiyang_l"+e+"_png","peiyang_a"+e+"_png"),this._jieSuoButton.skinName=SkinCreateMgr.CreateButton("jiesuo_l"+e+"_png","jiesuo_l"+e+"_png","jiesuo_a"+e+"_png"),this._yulanButton.skinName=SkinCreateMgr.CreateButton("yulan_l"+e+"_png","yulan_a"+e+"_png"),this.upDateShow(this._curRole)
},t.prototype.onPeiYangDown=function(e){SoundManager.PlayButtonMusic();var t=WindowManager.RoleDetailWindow();t.UpdataShow(this._curRole),t.IsVisibled=!0},t.prototype.onJieSuoDown=function(e){SoundManager.PlayButtonMusic(),NetManager.SendRequest(["func="+NetNumber.upRole+"&id="+this._curRole.ID],this._UpRoleReturn.bind(this))},t.prototype._UpRoleReturn=function(e){if(e.code==NetManager.SuccessCode){if(ItemManager.UseItem(this._curRole.Pieceid,this._curRole.GetRoleNum),e.data.lv?(this._curRole.Level=e.data.lv,this._curRole.SetSkillLevelByNum(e.data.sk1,1),this._curRole.SetSkillLevelByNum(e.data.sk2,2),this._curRole.SetSkillLevelByNum(e.data.sk3,3)):this._curRole.Level=1,e.data.unlock){var t=e.data.unlock;Object.keys(t).map(function(e){var i=t[e],n=parseInt(i.id),a=(i.lv,i.sk1),r=i.sk2,o=i.sk3,s=UnitManager.GetRole(n);null!=s&&(s.SetSkillLevelByNum(a,1),s.SetSkillLevelByNum(r,2),s.SetSkillLevelByNum(o,3))}),GameEvent.DispatchEvent(EventType.RoleUpLevel)}WindowManager.RoleGetPage().Show(this._curRole)}else PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("rolelisttext2"))},t.prototype._OnUpDataEvent=function(){null!=this._curRole&&this.upDateShow(this._curRole)},t.prototype.upDateShow=function(e){if(null!=e&&(this._curRole=e,this._levelLabel.text="LV."+this._curRole.Level,this._roleIcon.source=this._curRole.HeadRes,0==this._curRole.IsHave?(this._lanDiGroup.visible=!0,this._baiDiGroup.visible=!1,this._lanDiNameLabel.text=this._curRole.Name,this._jinDuLabel.text=this._curRole.GetCurRoleNum.toString()+"/"+this._curRole.GetRoleNum.toString(),this._jinDuLabel.filters=[FilterManage.AddMiaoBian(1,0)],this._curRole.GetCurRoleNum/this._curRole.GetRoleNum>=1?this._jinDuTiaoIma.width=211:this._jinDuTiaoIma.width=this._curRole.GetCurRoleNum/this._curRole.GetRoleNum*211,this._curRole.Level<GameConstData.RoleMaxLevel&&this._curRole.GetCurRoleNum>=this._curRole.GetRoleNum?(this._jieSuoButton.enabled=!0,this._jieSuoButton.visible=!0,this._redIma.visible=!0,this._yulanButton.visible=!1):(this._jieSuoButton.enabled=!1,this._jieSuoButton.visible=!1,this._yulanButton.visible=!0,this._redIma.visible=!1)):(this._lanDiGroup.visible=!1,this._baiDiGroup.visible=!0,this._baiDiNameLabel.text=this._curRole.Name,this._curRole.Level<GameConstData.RoleMaxLevel&&this._curRole.GetCurRoleNum>=this._curRole.UpLevelDebrisNum?this._redIma.visible=!0:this._redIma.visible=!1),0==this._redIma.visible))for(var t=0;t<this._curRole.UseSkillSet.length;t++){var i=Math.ceil(GameConstData.SkillMoneyBase*Math.pow(this._curRole.UseSkillSet[t].Level,1.6));if(this._curRole.UseSkillSet[t].IsCanUp&&UnitManager.Player.Money>=i)return void(this._redIma.visible=!0)}},t}(AWindow);__reflect(RoleList.prototype,"RoleList");var RolePage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._listSet=[],t.skinName="resource/game_skins/RolePageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._scroller.bounces=!1,GameEvent.AddEventListener(EventType.RoleUpLevel,this._OnJieSuo,this)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._UpdataShow()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._OnJieSuo=function(){this.IsVisibled&&this._UpdataShow()},t.prototype._UpdataShow=function(){for(var e=UnitManager.GetRoleSet(),t=[],i=[],n=[],a=0;a<e.length;a++){if(this._listSet.length<=a){var r=new RoleList;this._roleGroup.addChild(r),this._listSet.push(r)}this._listSet[a].upDateShow(e[a]),e[a].Level>0?t.push(this._listSet[a]):e[a].GetCurRoleNum>=e[a].GetRoleNum?i.push(this._listSet[a]):n.push(this._listSet[a])}for(var o=0,a=0;a<i.length;a++)i[a].y=o,o=i[a].y+i[a].height;for(var a=0;a<t.length;a++)t[a].y=o,o=t[a].y+t[a].height;for(var a=0;a<n.length;a++)n[a].y=o,o=n[a].y+n[a].height},t}(AWindow);__reflect(RolePage.prototype,"RolePage");var RoleSelect=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._roleID=0,t.skinName="resource/game_skins/RoleSelectSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,0!=this._roleID&&this.SetRole(this._roleID),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._sceneIma.skinName=SkinCreateMgr.CreateButton("guankaxj_jiaobiao"+e+"_png","guankaxj_jiaobiao"+e+"_png","guankaxj_jiaobiao_off"+e+"_png"),this._sceneIma.enabled=!0,this.SetRole(this._roleID)},t.prototype.SetRole=function(e){if(this._roleID=e,this._isCreated){var t=UnitManager.GetRole(e);this._roleImage.source=t.HeadRes,this._ifHave=t.IsHave,this._roleNameLabel.text=t.Name,this._sceneIma.visible=0==t.Scene?!1:!0,this._sceneIma.enabled=t.IsSceneStart?!0:!1;StringMgr.LanguageSuffix;this._ifHave?(this._roleImage.visible=!0,this._roleNameLabel.visible=!0,this._selectBgImage.source="guankaxj_kuang_png"):(this._roleImage.visible=!1,this._roleNameLabel.visible=!1,this._selectBgImage.source="guankaxj_kuang_off_png")}},t.prototype._OnClick=function(){if(UnitManager.CurrentRole.ID!=this._roleID){var e=UnitManager.GetRole(this._roleID);if(e.IsHave){var t=JSON.parse("{}");t.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.ChangeRoleOrTheme+"&id="+this._roleID+"&oemInfo="+JSON.stringify(t)],this._OnChangeComplete.bind(this)),Main.IsLocationDebug&&!Main.IsNeedNetDebug&&(UnitManager.ChangeRole(this._roleID),WindowManager.RoleSelectWindow().UpdateSelect(this))}}},t.prototype._OnChangeComplete=function(e){if(e.code==NetManager.SuccessCode){var t=e.data;UnitManager.ChangeRole(t.role),WindowManager.RoleSelectWindow().UpdateSelect(this)}},Object.defineProperty(t.prototype,"Selected",{set:function(e){this._selectImage.visible=e},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(RoleSelect.prototype,"RoleSelect");var RoleSelectWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._roleSelectSet=[],t._isClick=!1,t._isStartGame=!1,t.skinName="resource/game_skins/SelectRoleSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStartClick,this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),GameEvent.AddEventListener(EventType.GameStart,this._OnGameStart,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._name.source="guankaxj_di"+e+"_png",this._startButton.skinName=SkinCreateMgr.CreateButton("anniu_kaishi_l"+e+"_png","anniu_kaishi_a"+e+"_png"),this._closeButton.skinName=SkinCreateMgr.CreateButton("anniu_quxiao_l"+e+"_png","anniu_quxiao_a"+e+"_png")},t.prototype._OnCloseClick=function(){this.IsVisibled=!1,CheckpointManager.IsCatch=!1,CheckpointManager.IsRunaway=!1},t.prototype._OnStartClick=function(){this._isClick||(this._isClick=!0,SoundManager.PlayButtonMusic(),ResReadyMgr.IsReady(UnitManager.CurrentRole.ResGroupName)?this._Start():(WindowManager.WaitPage().IsVisibled=!0,this._isStartGame=!0),GuideManager.IsGuide&&GuideManager.GuideFinish(7))},t.prototype._Start=function(){WindowManager.WaitPage().IsVisibled=!0,this._isStartGame=!1,CheckpointManager.IsEndless?Main.Instance.StarBattle():CheckpointManager.IsDailyActive?(WindowManager.DailyActiveStartWindow().IsVisibled&&(WindowManager.DailyActiveStartWindow().IsVisibled=!1),Main.Instance.StarBattle()):CheckpointManager.IsCatch?Main.Instance.StarBattle():CheckpointManager.IsRunaway?Main.Instance.StarBattle():UnitManager.Player.PhysicalConsume(CheckpointManager.CurrentCheckpoint.ConsumePhy)?Main.Instance.StarBattle():(this._isClick=!1,WindowManager.WaitPage().IsVisibled=!1)},t.prototype.ResLoadEnd=function(){this._isStartGame&&(WindowManager.WaitPage().IsVisibled=!1,ResReadyMgr.IsReady(UnitManager.CurrentRole.ResGroupName)&&this._Start())},t.prototype._OnGameStart=function(){WindowManager.StarWindow().IsVisibled=!1,this.IsVisibled=!1,this._isClick=!1},t.prototype._UpdateShow=function(){for(var e=UnitManager.GetRoleSet(),t=[],i=[],n=0;n<e.length;n++){var a=e[n];a.IsHave?t.push(this.creatSelectRole(n,a)):i.push(this.creatSelectRole(n,a))}for(var r=0,n=0;n<t.length;n++)this.setSelectPosi(r,t[n]),r+=1;for(var n=0;n<i.length;n++)this.setSelectPosi(r,i[n]),r+=1},t.prototype.creatSelectRole=function(e,t){e<=this._roleSelectSet.length&&this._roleSelectSet.push(new RoleSelect);var i=this._roleSelectSet[e];return i.SetRole(t.ID),i.Selected=t.ID==UnitManager.CurrentRole.ID,i},t.prototype.setSelectPosi=function(e,t){var i=e%3;t.x=0==i?0:170*i,t.x+=0,t.y=0+200*Math.floor(e/3),e>=9&&(t.x+=100),this._roleGroup.addChild(t)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._UpdateShow(),GuideManager.IsGuide&&7==GuideManager.GuideID&&GuideManager.GuideCheck()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.UpdateSelect=function(e){for(var t=0;t<this._roleSelectSet.length;t++)this._roleSelectSet[t]==e?this._roleSelectSet[t].Selected=!0:this._roleSelectSet[t].Selected=!1},t.prototype.StartGameGuide=function(){if(this.IsVisibled){var e=this._startButton.x,t=this._startButton.y,i=this._startButton.width,n=this._startButton.height;GuideManager.ShowGuideWindow(0,e,t,i,n)}},t}(AWindow);__reflect(RoleSelectWindow.prototype,"RoleSelectWindow");var RoleSkillList=function(e){function t(){var t=e.call(this)||this;return t._skillUpArmSet=[],t.skinName="resource/game_skins/RoleSkillListSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._skillDetailGroup.visible=!1,this._qiangHuaButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onQiangHuaTap,this),this._lookDetailRect.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onlookDetailBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onlookDetailEnd,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._lookDetailIma.source="juesexiangqing_chakanxq_l"+e+"_png",this._qiangHuaButton.skinName=SkinCreateMgr.CreateButton("juesexiangqing_qianghua_l"+e+"_png","juesexiangqing_qianghua_a"+e+"_png","juesexiangqing_qianghua_off"+e+"_png")},t.prototype.onQiangHuaTap=function(e){UnitManager.Player.TestMoney(this._moneyNum)&&NetManager.SendRequest(["func="+NetNumber.upRoleSkill+"&id="+this._curRole.ID+"&skid="+this._skillCiShu+"&price="+this._moneyNum],this._UpRoleSkillReturn.bind(this))},t.prototype._UpRoleSkillReturn=function(e){e.code==NetManager.SuccessCode?(this._curRole.SetSkillLevelByNum(e.data.sk1,1),this._curRole.SetSkillLevelByNum(e.data.sk2,2),this._curRole.SetSkillLevelByNum(e.data.sk3,3),this.upDateShow(this._curRole,this._skillCiShu),this.creatSkillUpDroArm(),GameEvent.DispatchEvent(EventType.RoleSkillUpLevel)):PromptManager.CreatCenterTip(!1,!1,"强化失败!")},t.prototype.creatSkillUpDroArm=function(){var e="jiesuo",t=new egret.MovieClip;t.movieClipData=MovieManager.GetMovieClipData(e+"_json",e+"_png",e),this.addChild(t),t.play(1),t.addEventListener(egret.Event.COMPLETE,this.skillUpDroArmCom,this),this._skillUpArmSet.push(t)},t.prototype.skillUpDroArmCom=function(e){this._skillUpArmSet[0]&&(this._skillUpArmSet[0].removeEventListener(egret.Event.COMPLETE,this.skillUpDroArmCom,this),this.removeChild(this._skillUpArmSet[0]),this._skillUpArmSet.splice(0,1))},t.prototype.onlookDetailBegin=function(e){var t=StringMgr.LanguageSuffix;this._lookDetailIma.texture=RES.getRes("juesexiangqing_chakanxq_a"+t+"_png"),this._skillDetailGroup.visible=!0},t.prototype.onlookDetailEnd=function(e){var t=StringMgr.LanguageSuffix;this._lookDetailIma.texture=RES.getRes("juesexiangqing_chakanxq_l"+t+"_png"),this._skillDetailGroup.visible=!1},t.prototype.upDateShow=function(e,t){this._curRole=e,this._skillCiShu=t,this._curSkill=this._curRole.AllSkillSet[t-1],this._skillDetailLabel.text=this._curSkill.OverView,this._skillIcon.texture=RES.getRes(this._curSkill.ImageRes),this._skillNameLabel.text=this._curSkill.Name,this._skillNameLabel.filters=[FilterManage.AddMiaoBian(2,798813)];var i=StringMgr.LanguageSuffix;this._skillTypeIma.texture=this._curSkill.IsInitiative?RES.getRes("jineng_fenlei_zhudong"+i+"_png"):RES.getRes("jineng_fenlei_beidong"+i+"_png"),this._moneyNum=Math.ceil(GameConstData.SkillMoneyBase*Math.pow(this._curSkill.Level,1.6)),this._qiangHuaNumLabel2.text=this._moneyNum.toString(),this._qiangHuaNumLabel.text=this._moneyNum.toString();for(var n=(this._curSkill.Desc.replace("&data",this._curSkill.SkillValue.toString()),""),a=this._curSkill.Level+1,r=[this._jieSuoRoleLabel1,this._jieSuoRoleLabel2,this._jieSuoRoleLabel3,this._jieSuoRoleLabel4],o=0;o<r.length;o++)r[o].text="";for(var o=0;o<this._curSkill.JieSuoRole.length;o++)this._curSkill.JieSuoRole[o]&&(n=this._curSkill.JieSuoRole[o].Level<a?"<font color=0xff0000>"+this._curSkill.JieSuoRole[o].Name+" "+a+" "+StringMgr.GetText("roleskillpagetext1")+"</font>":this._curSkill.JieSuoRole[o].Name+" "+a+" "+StringMgr.GetText("roleskillpagetext1"));var s=this._curSkill.IsJieSuo;s?(this._suoIma.visible=!1,this._skillLevelLabel.visible=!0,this._qianghuaGroup.visible=!0,this._skillLevelLabel.text="l"+this._curSkill.Level,this._jieSuoTypeLabel.text=StringMgr.GetText("roleskillpagetext2")):(this._suoIma.visible=!0,this._skillLevelLabel.visible=!1,this._qianghuaGroup.visible=!1,this._jieSuoTypeLabel.text=StringMgr.GetText("roleskillpagetext3"),this._qiangHuaNumLabel2.text="0",this._qiangHuaNumLabel.text="0"),this._curSkill.IsCanUp?(this._qiangHuaButton.enabled=!0,this._redIma.visible=!0):(this._qiangHuaButton.enabled=!1,this._redIma.visible=!1),this._redIma.visible&&UnitManager.Player.Money<this._moneyNum&&(this._redIma.visible=!1)},t}(AWindow);__reflect(RoleSkillList.prototype,"RoleSkillList");var RollingNoticeWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._noticeSet=[],t.skinName="resource/game_skins/RollingNoticeWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.touchEnabled=!1,this.touchChildren=!1,this._noticeLabel.mask=this._maskRect},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.MainTopLayer.addChild(this):Main.MainTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.Show=function(){if(this.IsVisibled=!0,RollingNoticeManager.RollingNoticeSet.length<=0)return void(this.IsVisibled=!1);this._noticeLabel.x=508;var e=RollingNoticeManager.RollingNoticeSet.shift(),t=StringMgr.GetText(RollingNoticeManager.RollingNoticeMsgSet[e.id].text);e.name&&(t=t.replace("&name",decodeURIComponent(e.name))),e.roldId&&(t=t.replace("&role",UnitManager.GetRole(e.roldId).Name)),e.gateId&&(t=t.replace("&chapter",e.gateId)),e.dst&&(t=t.replace("&slave",decodeURIComponent(e.dst))),e.src&&(t=t.replace("&name",decodeURIComponent(e.src))),this._noticeLabel.text=t,this._noticeLabel.width=23*t.length;var i=this._maskRect.width+this._noticeLabel.width;egret.Tween.get(this._noticeLabel).to({x:133-this._noticeLabel.width},i/150*1e3).call(this.Show.bind(this))},t}(eui.Component);__reflect(RollingNoticeWindow.prototype,"RollingNoticeWindow");var SetWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._yuyan=2,t._yingxiao=1,t.skinName="resource/game_skins/SetWindowSkin.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._lgGroup.visible=!1,this._musicGroup.visible=!1,this._moImage.alpha=0,this._mcImage.alpha=1,this._yingxiao=2,this._musicImage.source=this._musicCloseImage.source,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._lgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnYuyanClick,this),this._cnImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCNClick,this),this._enImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnENClick,this),this._mImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnMusicClick,this),this._moImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnMusicOpenClick,this),this._mcImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnMusicCloseClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="xitongsz_di"+e+"_png",1==this._yingxiao?this._musicImage.source="xitongsz_wz_on"+e+"_png":this._musicImage.source="xitongsz_wz_off"+e+"_png",this._musicOpenImage.source="xitongsz_wz_on"+e+"_png",this._musicCloseImage.source="xitongsz_wz_off"+e+"_png",StringMgr.Language==StringMgr.CN?(this._yuyan=1,this._yuyanImage.source="xitongsz_wz_zhongwen_png",this._cnImage.alpha=1,this._enImage.alpha=0):(this._yuyan=2,this._yuyanImage.source="xitongsz_wz_yingwen_en_png",this._cnImage.alpha=0,this._enImage.alpha=1)},t.prototype._OnYuyanClick=function(){SoundManager.PlayButtonMusic(),this._lgGroup.visible=!this._lgGroup.visible,this._musicGroup.visible=!1},t.prototype._OnCNClick=function(){SoundManager.PlayButtonMusic(),this._lgGroup.visible=!1,1!=this._yuyan&&(this._yuyan=1,this._yuyanImage.source="xitongsz_wz_zhongwen_png",this._cnImage.alpha=1,this._enImage.alpha=0,StringMgr.Language=StringMgr.CN)},t.prototype._OnENClick=function(){SoundManager.PlayButtonMusic(),this._lgGroup.visible=!1,2!=this._yuyan&&(this._yuyan=2,this._yuyanImage.source="xitongsz_wz_yingwen_en_png",this._cnImage.alpha=0,this._enImage.alpha=1,StringMgr.Language=StringMgr.EN)},t.prototype._OnMusicClick=function(){SoundManager.PlayButtonMusic(),this._musicGroup.visible=!this._musicGroup.visible,this._lgGroup.visible=!1},t.prototype._OnMusicOpenClick=function(){if(SoundManager.PlayButtonMusic(),this._musicGroup.visible=!1,1!=this._yingxiao){this._yingxiao=1;var e=StringMgr.LanguageSuffix;this._musicImage.source="xitongsz_wz_on"+e+"_png",this._moImage.alpha=1,this._mcImage.alpha=0,SoundManager.YinYue=!0,SoundManager.PlayBackgroundMusic()}},t.prototype._OnMusicCloseClick=function(){if(SoundManager.PlayButtonMusic(),this._musicGroup.visible=!1,2!=this._yingxiao){this._yingxiao=2;var e=StringMgr.LanguageSuffix;this._musicImage.source="xitongsz_wz_off"+e+"_png",this._moImage.alpha=0,this._mcImage.alpha=1,SoundManager.YinYue=!1}},t.prototype._OnCloseClick=function(){SoundManager.PlayButtonMusic(),this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(SetWindow.prototype,"SetWindow");var ShopBuyPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._endBuyNum=0,t._xianZhiBuyNum=200,t._endOnePrice=0,t.skinName="resource/game_skins/ShopBuyPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._buyOneButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyOneButtonClick,this),this._buyTenButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyTenButtonClick,this),this._buyFivetyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyFivetyButtonClick,this),this._buyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyButtonClick,this),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseButtonClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._textLabel1.text=StringMgr.GetText("shopbuypagetext1"),this._textLabel2.text=StringMgr.GetText("shopbuypagetext2"),this._textLabel3.text=StringMgr.GetText("shopbuypagetext3"),this._bg.source="goumaits_di"+e+"_png",this._buyButton.skinName=SkinCreateMgr.CreateButton("goumaits_an_goumai_l"+e+"_png","goumaits_an_goumai_a"+e+"_png"),this._closeButton.skinName=SkinCreateMgr.CreateButton("anniu_quxiao_l"+e+"_png","anniu_quxiao_a"+e+"_png")},t.prototype._OnBuyOneButtonClick=function(){this._endBuyNum+=1,this.updataPrice()},t.prototype._OnBuyTenButtonClick=function(){this._endBuyNum+=10,this.updataPrice()},t.prototype._OnBuyFivetyButtonClick=function(){this._endBuyNum+=50,this.updataPrice()},t.prototype.updataPrice=function(){this._endBuyNum>this._xianZhiBuyNum&&(this._endBuyNum=this._xianZhiBuyNum),this._price=this._endOnePrice*this._endBuyNum,this._buyNumLabel.text=this._endBuyNum.toString(),this._buyMoneyLabel.text=this._price.toString()},t.prototype._OnBuyButtonClick=function(){this.IsVisibled=!1,null!=this._buyFun&&(this._buyFun(this._endBuyNum),this._buyFun=null)},t.prototype._OnCloseButtonClick=function(){this.IsVisibled=!1},t.prototype.Show=function(e,t,i,n){this.IsVisibled=!0,this._shopID=e,this._itemData=this.getItemData(),this._item=null,this._item=this.getItem(),this._endBuyNum=1,this._endOnePrice=n,this._price=this._endOnePrice*this._endBuyNum,this._buyGoldType=i;var a="shop_jinbi_png";"D"==this._buyGoldType&&(a="shop_jifen_png"),this._buyTypeIma.texture=RES.getRes(a),this._xianZhiBuyNum=200,this._nameLabel.text=StringMgr.GetText(this._itemData.name),this._descLabel.text=StringMgr.GetText(this._itemData.desc),null!=this._item?(23==this._item.ID&&(this._xianZhiBuyNum=1),this._haveNumLabel.text=ItemManager.GetItemCount(this._item.XID).toString()):this._haveNumLabel.text=UnitManager.Player.Money.toString(),this._buyNumLabel.text=this._endBuyNum.toString(),this._buyMoneyLabel.text=this._price.toString(),this._itemIconIma.texture=RES.getRes(this._itemData.res+"_png"),this._buyFun=t},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.getItemData=function(){null==this._shopData&&(this._shopData=RES.getRes("shopdata_json"));var e=this._shopData[this._shopID.toString()];return e},t.prototype.getItem=function(){null==this._shopData&&(this._shopData=RES.getRes("shopdata_json"));var e=this._shopData[this._shopID.toString()],t=e.bonus,i=t.split(","),n=ItemManager.GetXID(i[0],parseInt(i[1])),a=ItemManager.GetItemByID(n);return a},t}(AWindow);__reflect(ShopBuyPage.prototype,"ShopBuyPage");var ShopPage=function(e){function t(){var t=e.call(this)||this;return t._shopID=0,t._isSelected=!1,t._isCanBuy=!1,t._price=0,t._endPrice=0,t._dataSet=null,t._buyNum=0,t._buyGoldType="",t._defaultbuy="",t._duiyingRole=null,t._bonus=[],t._zhekouRes="",t._zhekouNum=1,t._activeTime=[],t._isZheKou=!1,t._shuaXinTime=0,t.skinName="resource/game_skins/ShopSkin.exml",t.width=135,t.height=190,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),GameEvent.AddEventListener(EventType.UserStatusChange,this.Update,this),GameEvent.AddEventListener(EventType.RoleUpLevel,this.Update,this)},t.prototype._OnClick=function(){var e=JSON.parse("{}");e.token=UnitManager.Player.GameToken;Game.IsIos?this._shopID+8:this._shopID;if(this._type==t.RechargeType){var i=StringMgr.GetText("shopbuypagetext4");return i=i.replace("&point",this._endPrice.toString()),i=i.replace("&token",this._bonus[1].toString()),void PromptManager.CreatCenterTip(!1,!1,i,null,this._BuyGold.bind(this))}this._isCanBuy&&("D"==this._buyGoldType?PromptManager.CreatShopBuyPage(this._shopID,this._BuyItem.bind(this),this._buyGoldType,this._endPrice):PromptManager.CreatShopBuyPage(this._shopID,this._BuyItem.bind(this),this._buyGoldType,this._endPrice))},t.prototype._BuyGold=function(){var e=this,t=JSON.parse("{}");t.token=UnitManager.Player.GameToken;var i=Game.IsIos?this._shopID+8:this._shopID,n=2;NetManager.SendRequest(["func="+NetNumber.BuyGold+"&itemid="+i+"&count=1&mode="+n+"&oemInfo="+JSON.stringify(t)],function(t){return e._OnBuyGoldCom.bind(e)(t,n)})},t.prototype._BuyItem=function(e){this._buyNum=e;var t=JSON.parse("{}");t.token=UnitManager.Player.GameToken;var i=this._endPrice*e;"D"==this._buyGoldType?UnitManager.Player.TestPingGai(i)&&(WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.BuyItem+"&id="+this._shopID+"&num="+e+"&oemInfo="+JSON.stringify(t)],this._OnBuyComplete.bind(this))):UnitManager.Player.TestMoney(i)&&(WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.BuyItem+"&id="+this._shopID+"&num="+e+"&oemInfo="+JSON.stringify(t)],this._OnBuyComplete.bind(this)))},t.prototype._OnBuyGoldCom=function(e,t){var i=e.code,n=e.data;if(e.code!=NetManager.SuccessCode)1004==i&&PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("shopbuypagetext9"),null,this._OnPayClick.bind(this));else{var a=n.bonus;a.split(",");switch(t){case 1:case 2:var r={cid:n.cid,sn:n.sn,price:n.price},o="/wallet/pay/"+JSON.stringify(r);window.location.href="http://h5.gamegold.xin?path="+encodeURIComponent(o)}}},t.prototype._OnPayClick=function(){Main.AddDebug("发起支付")},t.prototype._OnPaySuccess=function(){this._BuyGold()},t.prototype._OnPayError=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},t.prototype._OnPayClose=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},t.prototype._OnBuyComplete=function(e){if(WindowManager.WaitPage().IsVisibled=!1,e.code==NetManager.SuccessCode){PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("shopbuypagetext11"));var t=e.data;if(Object.keys(t).map(function(e){ItemManager.SetItemCount(parseInt(e),t[e].num)}),this.Update(),4012==this._shopID){var i=RES.getRes("shopdata_json"),n=i[this._shopID.toString()];if(null!=n){var a=n.bonus,r=a.split(","),o=0;o=3==r.length?ItemManager.GetXID(r[0],parseInt(r[1])):parseInt(r[0]);var s=JSON.parse("{}");t.token=UnitManager.Player.GameToken,ItemManager.UseItem(o,this._buyNum),NetManager.SendRequest(["func="+NetNumber.UseItem+"&id="+o+"&num="+this._buyNum+"&oemInfo="+JSON.stringify(s)],this._UseItemReturn.bind(this))}}}else PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext12"))},t.prototype._UseItemReturn=function(e){return e.code!=NetManager.SuccessCode?void Main.AddDebug("购买直接使用物品失败，商品ID："+this._shopID):void GameEvent.DispatchEvent(EventType.UseItem)},t.prototype.SetData=function(e,i){this._type=e,this._dataSet=i,this._roleGroup.visible=e==t.RoleType,this._themeGroup.visible=e==t.ThemeType,this._itemGroup.visible=e==t.ItemType,this._rmbGroup.visible=e==t.RechargeType,this._type!=t.RechargeType?(this._shopID=parseInt(i.id),this._defaultbuy=StringMgr.GetText(i.defaultbuy),this._name=StringMgr.GetText(i.name),this._buyGoldType=i.costtype):this._shopID=parseInt(i.itemid),this._activeTime=i.times.split(","),this._price=parseInt(i.price),this._zhekouRes=i.markres+StringMgr.LanguageSuffix,this._zhekouNum=i.discount,this._bonus=i.bonus.split(",");var n="shop_jinbi_png";if("D"==this._buyGoldType&&(n="shop_jifen_png"),this._bonus[1]&&ItemManager.GetItemByID(parseInt(this._bonus[1]))){var a=ItemManager.GetItemByID(parseInt(this._bonus[1])).ID+1e3;this._duiyingRole=UnitManager.GetRole(a)}switch(this._UpdataShow(),e){case t.RoleType:this._roleImage.texture=RES.getRes(i.res+"_png"),this._rolePriceLabel.text=String(this._endPrice),this._roleGoldType.texture=RES.getRes(n);break;case t.ThemeType:this._themeImage.texture=RES.getRes(i.res+"_png"),this._themePriceLabel.text=String(this._endPrice),this._themeGoldType.texture=RES.getRes(n);break;case t.ItemType:this._itemImage.texture=RES.getRes(i.res+"_png"),this._itemPriceLabel.text=String(this._endPrice),this._itemGoldType.texture=RES.getRes(n);break;case t.RechargeType:this._isZheKou?this._goldLabel.text=this._bonus[1]+"x2":this._goldLabel.text=this._bonus[1],this._rmbLabel.text=this._endPrice/10+" rmb";var r=StringMgr.LanguageSuffix;"1"==i.ischeap&&"0"==i.ishot&&0==this._zhekouIma.visible?(this._shopStateIma.texture=RES.getRes("shop_huasuan"+r+"_png"),this._shopStateIma.visible=!0):"0"==i.ischeap&&"1"==i.ishot&&0==this._zhekouIma.visible?(this._shopStateIma.texture=RES.getRes("shop_remai"+r+"_png"),this._shopStateIma.visible=!0):this._shopStateIma.visible=!1}},t.prototype._UpdataShow=function(){this.IsZheKou?(this._endPrice=Math.ceil(this._price*this._zhekouNum),this._zhekouIma.visible=!0,this._zhekouIma.texture=RES.getRes(this._zhekouRes+"_png")):(this._endPrice=this._price,this._zhekouIma.visible=!1);var e=!0;"D"==this._buyGoldType?e=UnitManager.Player.PingGai>=this._endPrice:"M"==this._buyGoldType&&(e=UnitManager.Player.Money>=this._endPrice),this._type==t.RechargeType||e?(this._bg.texture=RES.getRes("shop_kuang_lan_png"),this._rolePriceLabel.font=RES.getRes("shoplnum_fnt"),this._themePriceLabel.font=RES.getRes("shoplnum_fnt"),this._itemPriceLabel.font=RES.getRes("shoplnum_fnt")):(this._bg.texture=RES.getRes("shop_kuang_hong_png"),this._rolePriceLabel.font=RES.getRes("shophnum_fnt"),this._themePriceLabel.font=RES.getRes("shophnum_fnt"),this._itemPriceLabel.font=RES.getRes("shophnum_fnt")),""!=this._defaultbuy&&this._duiyingRole&&this._duiyingRole.Level<1?(this._bg.texture=RES.getRes("shop_kuang_hong_png"),this._roleGold.visible=!1,this._roleTipLabel.visible=!0,this._roleTipLabel.text=this._defaultbuy,this._isCanBuy=!1):(this._roleGold.visible=!0,this._roleTipLabel.visible=!1,this._isCanBuy=0!=this._endPrice)},Object.defineProperty(t.prototype,"IsZheKou",{get:function(){var e=UnitManager.FuwuduanTime,t=this._activeTime[0]?parseInt(this._activeTime[0]):0,i=this._activeTime[1]?parseInt(this._activeTime[1]):0;return e>=t&&i>=e?(this._isZheKou=!0,this._isZheKou):(this._isZheKou=!1,this._isZheKou)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsAtZheKou",{get:function(){return this._isZheKou},enumerable:!0,configurable:!0}),t.prototype._Process=function(e){this._isZheKou&&(this._shuaXinTime+=e,this._shuaXinTime>=6e4&&(this._shuaXinTime-=6e4,this.Update()))},t.prototype.Update=function(){this.SetData(this._type,this._dataSet)},t}(AWindow);ShopPage.RoleType=1,ShopPage.ThemeType=2,ShopPage.ItemType=3,ShopPage.RechargeType=4,__reflect(ShopPage.prototype,"ShopPage");var ShopWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._roleShop=[],t._sceneShop=[],t._roadShop=[],t._itemShop=[],t._rechargeShop=[],t._shuaXinTime=0,t.skinName="resource/game_skins/ShopPageSkins.exml",t._ReadData(),t.width=640,t.height=626,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._UpdataMoney(),this._UpdataPingGai();var t=new eui.RadioButtonGroup;t.addEventListener(egret.Event.CHANGE,this._UpdataPage,this),this._roleRadio.group=t,this._roleRadio.value=ShopPage.RoleType,this._themeRadio.group=t,this._themeRadio.value=ShopPage.ThemeType,this._itemRadio.group=t,this._itemRadio.value=ShopPage.ItemType,this._rechargeRadio.group=t,this._rechargeRadio.value=ShopPage.RechargeType,this._UpdataPage(null),this._themeRadio.visible=!1,this._rechargeRadio.x=this._itemRadio.x,this._itemRadio.x=this._themeRadio.x;var i=new eui.RadioButtonGroup;i.addEventListener(egret.Event.CHANGE,this._UpdataTheme,this),this._sceneRadio.group=i,this._sceneRadio.value=1,this._roadRadio.group=i,this._roadRadio.value=2,this._UpdataTheme(null),this._UpdataShop(),this.touchEnabled=!0,this.touchChildren=!0,GameEvent.AddEventListener(EventType.MoneyChange,this._UpdataMoney,this),GameEvent.AddEventListener(EventType.PingGaiChange,this._UpdataPingGai,this),GameEvent.AddEventListener(EventType.MoneyChange,this._UpdateShow,this),GameEvent.AddEventListener(EventType.PingGaiChange,this._UpdateShow,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._sceneRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_zhuti_on"+e+"_png","anniu_zhuti_off"+e+"_png"),this._roadRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_lujing_on"+e+"_png","anniu_lujing_off"+e+"_png"),this._roleRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_juese_on"+e+"_png","anniu_juese_off"+e+"_png"),this._themeRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_changjing_on"+e+"_png","anniu_changjing_off"+e+"_png"),this._itemRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_daoju_on"+e+"_png","anniu_daoju_off"+e+"_png"),this._rechargeRadio.skinName=SkinCreateMgr.CreateRadioButton("anniu_chongzhi_on"+e+"_png","anniu_chongzhi_off"+e+"_png"),this._UpdateShow()
},t.prototype.OpenRecharge=function(){this._rechargeRadio.selected=!0,this._PageUpdate(ShopPage.RechargeType)},t.prototype.OpenItemPage=function(){this._itemRadio.selected=!0,this._PageUpdate(ShopPage.ItemType)},t.prototype.OpenRolePage=function(){this._roleRadio.selected=!0,this._PageUpdate(ShopPage.RoleType)},t.prototype._ReadData=function(){var e=this,t=RES.getRes("shopdata_json");Achievement.RewardData=t,this._roleData=[],this._sceneData=[],this._roadData=[],this._itemData=[],Object.keys(t).map(function(i){var n=t[i];n.id=i;var a=n.bonus,r=a.split(","),o=r[0];if("0"==n.price);else switch(o){case"C":e._roleData.push(n);break;case"scene":e._sceneData.push(n);break;case"road":e._roadData.push(n);break;case"I":case"M":e._itemData.push(n)}});var t=RES.getRes("shopOuter_json");this._rechargeData=[],Object.keys(t).map(function(i){var n=t[i],a=n.bonus,r=a.split(","),o=r[0];1==n.zoneid&&"D"==o&&e._rechargeData.push(n)})},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._UpdateShow(),this._shuaXinTime=0,ProcessManager.AddProcess(this._Process.bind(this))):(Main.Instance.WindowBottomLayer.removeChild(this),ProcessManager.RemoveProcess(this._Process.bind(this))))},enumerable:!0,configurable:!0}),t.prototype._UpdataMoney=function(){this._totalGoldLabel.text=UnitManager.Player.Money.toString()},t.prototype._UpdataPingGai=function(){this._totalPingGaiLabel.text=UnitManager.Player.PingGai.toString()},t.prototype._UpdataPage=function(e){var t=ShopPage.RoleType;if(null!=e){var i=e.target;t=i.selectedValue}this._PageUpdate(t)},t.prototype._PageUpdate=function(e){this._roleGroup.visible=e==ShopPage.RoleType,this._themeGroup.visible=e==ShopPage.ThemeType,this._itemGroup.visible=e==ShopPage.ItemType,this._rechargeGroup.visible=e==ShopPage.RechargeType},t.prototype._UpdataTheme=function(e){var t=1;if(null!=e){var i=e.target;t=i.selectedValue}this._scene.visible=1==t,this._road.visible=2==t},t.prototype._UpdataShop=function(){null!=this._roleData&&(this._AddShop(ShopPage.RoleType,this._roleData,this._roleScroller,this._roleShop),this._AddShop(ShopPage.ThemeType,this._sceneData,this._sceneScroller,this._sceneShop),this._AddShop(ShopPage.ThemeType,this._roadData,this._roadScroller,this._roadShop),this._AddShop(ShopPage.ItemType,this._itemData,this._itemScroller,this._itemShop),this._AddShop(ShopPage.RechargeType,this._rechargeData,this._rechargeScroller,this._rechargeShop))},t.prototype._AddShop=function(e,t,i,n){for(var a=0,r=0,o=0;o<t.length;o++){var s=new ShopPage;s.x=a,s.y=r,s.SetData(e,t[o]),i.addChild(s),n.push(s),a+=s.width,a>=3*s.width+36&&(a=0,r+=s.height)}},t.prototype._UpdateShow=function(){this._roleShop.map(function(e){e.Update()}),this._itemShop.map(function(e){e.Update()}),this._rechargeShop.map(function(e){e.Update()})},t.prototype._Process=function(e){this._shuaXinTime+=e,this._roleShop[0]&&this._shuaXinTime>=6e4&&this._roleShop[0].IsAtZheKou&&(this._shuaXinTime-=6e4,this._UpdateShow())},t}(AWindow);ShopWindow.IsOpenStar=!1,__reflect(ShopWindow.prototype,"ShopWindow");var SlaveCatchList=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t.skinName="resource/game_skins/SlaveCatchListSkins.exml",t.width=466,t.height=130,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._catchButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCatchClick,this),null!=this._friend&&this.SetData(this._friend)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._catchButton.skinName=SkinCreateMgr.CreateButton("nuli_an_zhuabuh_l"+e+"_png","nuli_an_zhuabuh_a"+e+"_png")},t.prototype._OnCatchClick=function(){return SoundManager.PlayButtonMusic(),SlaveManager.CanCatch?(WindowManager.WaitPage().IsVisibled=!0,void NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType=3101","&openid="+this._friend.OpenID])):void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext2"))},t.prototype.SetData=function(e){if(this._friend=e,this._isCreated){if(this._iconImaSource!=e.IconRes&&(this._headImage.source=RES.getRes("touxiang_mr_jpg")),""!=e.IconRes){var t=new egret.ImageLoader;t.load(e.IconRes),t.addEventListener(egret.Event.COMPLETE,function(){this._headImage.source=t.data,this._iconImaSource=this._friend.IconRes},this)}this._nameLabel.text=e.Name,e.IsSlave?(this._shenfenLabel.text=StringMgr.GetText("slavepagetext3"),this._catchButton.visible=!1):e.IsMaster?(this._shenfenLabel.text=StringMgr.GetText("slavepagetext4"),this._catchButton.visible=!0):e.IsFreed&&(this._shenfenLabel.text=StringMgr.GetText("slavepagetext5"),this._catchButton.visible=!0)}},t}(AWindow);__reflect(SlaveCatchList.prototype,"SlaveCatchList");var SlaveCatchWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._listSet=[],t._showListSet=[],t.skinName="resource/game_skins/SlaveCatchWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="nulizhuabu_di"+e+"_png"},t.prototype._OnCloseClick=function(){this.IsVisibled=!1},t.prototype._UpdateShow=function(){var e=FriendManager.CatchList;if(null!=e){for(;this._showListSet.length>0;){var t=this._showListSet.shift();this._listGroup.removeChild(t),this._listSet.push(t)}for(var i=0,n=0;n<e.length;n++){var t;t=this._listSet.length>0?this._listSet.shift():new SlaveCatchList,t.SetData(e[n]),t.y=i,this._listGroup.addChild(t),this._showListSet.push(t),i+=t.height}}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._UpdateShow()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(SlaveCatchWindow.prototype,"SlaveCatchWindow");var SlaveEndWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t.skinName="resource/game_skins/SlaveEndSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._okButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._okButton.skinName=SkinCreateMgr.CreateButton("anniu_queding_l"+e+"_png","anniu_queding_a"+e+"_png")},t.prototype._OnCloseClick=function(){this.IsVisibled=!1},t.prototype.ShowWindow=function(e,t){var i="nulijs_zhuabuchenggong_png";this.IsVisibled=!0;var n=StringMgr.LanguageSuffix;1==e?i=t?"nulijs_zhuabuchenggong"+n+"_png":"nulijs_zhuabushibai"+n+"_png":2==e&&(i=t?"nulijs_taotuochenggong"+n+"_png":"nulijs_taotuoshibai"+n+"_png"),this._bgImage.source=i},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(SlaveEndWindow.prototype,"SlaveEndWindow");var SlaveHDWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._shopID=0,t._contentImageRes="nulihudong_tu_biaoyang",t.skinName="resource/game_skins/SlaveHDPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._praiseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnPraiseClick,this),this._lashButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnLashClick,this),this._snackButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSnackClick,this),this._fawnButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnFawnClick,this),this._revengeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRevengeClick,this),this._addPraiseButton.visible=!1,this._addRevengeButton.visible=!1,this._addLashButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAddLashClick,this),this._addSnackButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAddSnackClick,this),this._addFawnButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAddFawnClick,this),this._praiseTimeLabel.visible=!1,this._lashTimeLabel.visible=!1,this._snackTimeLabel.visible=!1,this._revengeTimeLabel.visible=!1,this._fawnTimeLabel.visible=!1,Facade.instance().watch(this._PraiseReturn.bind(this),NetNumber.SlavePraise),Facade.instance().watch(this._LashReturn.bind(this),NetNumber.SlaveLash),Facade.instance().watch(this._SnackReturn.bind(this),NetNumber.SlaveFood),Facade.instance().watch(this._FawnReturn.bind(this),NetNumber.SlaveFawn),Facade.instance().watch(this._RevengeReturn.bind(this),NetNumber.SlaveAvenge),GameEvent.AddEventListener(EventType.SlaveHDTimesUpdate,this._UpdateTimes,this),GameEvent.AddEventListener(EventType.SlaveItemUpdate,this._UpdateSlaveItemNum,this),GameEvent.AddEventListener(EventType.SlaveHDCDChange,this._UpdateCDTime,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._praiseButton.skinName=SkinCreateMgr.CreateButton("nuli_an_biaoyang_l"+e+"_png","nuli_an_biaoyang_a"+e+"_png"),this._lashButton.skinName=SkinCreateMgr.CreateButton("nuli_an_zema_l"+e+"_png","nuli_an_zema_a"+e+"_png"),this._snackButton.skinName=SkinCreateMgr.CreateButton("nuli_an_jiacan_l"+e+"_png","nuli_an_jiacan_a"+e+"_png"),this._revengeButton.skinName=SkinCreateMgr.CreateButton("nuli_an_baofu_l"+e+"_png","nuli_an_baofu_a"+e+"_png"),this._fawnButton.skinName=SkinCreateMgr.CreateButton("nuli_an_xianmei_l"+e+"_png","nuli_an_xianmei_a"+e+"_png"),this.updataCountentIma()},t.prototype._UpdateCDTime=function(){var e=FrequencyManager.GetFrequency(10),t=FrequencyManager.GetFrequency(8);null!=e?e.CD>0||(this._praiseTimeLabel.visible=!1):this._praiseTimeLabel.visible=!1,null!=t?t.CD>0||(this._revengeTimeLabel.visible=!1):this._revengeTimeLabel.visible=!1},t.prototype._BuyTimes=function(e){var t=FrequencyManager.GetFrequency(e);if(null!=t){var i=[10,20,50,80,100],n=t.ExtValue,a=n>=i.length?i[4]:i[n],r=null,o="";if(12==e?(r=this._BuyLashTimes.bind(this),o=StringMgr.GetText("slavepagetext6")):7==e?(r=this._BuySnackTimes.bind(this),o=StringMgr.GetText("slavepagetext7")):9==e&&(r=this._BuyFawnTimes.bind(this),o=StringMgr.GetText("slavepagetext8")),UnitManager.Player.TestPingGai(a)){var s=StringMgr.GetText("slavepagetext9");s=s.replace("&token",a.toString()),s=s.replace("&num",o),PromptManager.CreatCenterTip(!1,!1,s,"",r)}}},t.prototype._OnAddLashClick=function(){this._BuyTimes(12)},t.prototype._BuyLashTimes=function(){FrequencyManager.AddShareTime(12..toString())},t.prototype._OnAddSnackClick=function(){this._BuyTimes(7)},t.prototype._BuySnackTimes=function(){FrequencyManager.AddShareTime(7..toString())},t.prototype._OnAddFawnClick=function(){this._BuyTimes(9)},t.prototype._BuyFawnTimes=function(){FrequencyManager.AddShareTime(9..toString())},t.prototype._UpdateTimes=function(){var e=FrequencyManager.GetFrequency(10),t=FrequencyManager.GetFrequency(12),i=FrequencyManager.GetFrequency(7),n=FrequencyManager.GetFrequency(9),a=FrequencyManager.GetFrequency(8),r=SlaveManager.Level,o=0;null!=e&&(o=Math.floor(.25*e.MaxValue*r),this._praiseCountLabel.text=Math.max(o+e.ExtValue-e.Value,0)+"/"+(o+e.ExtValue)),null!=t&&(o=Math.floor(.25*t.MaxValue*r),this._lashCountLabel.text=Math.max(o+t.ExtValue-t.Value,0)+"/"+(o+t.ExtValue)),null!=i&&(o=Math.floor(.25*i.MaxValue*r),this._snackCountLabel.text=Math.max(o+i.ExtValue-i.Value,0)+"/"+(o+i.ExtValue)),null!=n&&(o=Math.floor(.25*n.MaxValue*r),this._fawnCountLabel.text=Math.max(o+n.ExtValue-n.Value,0)+"/"+(o+n.ExtValue)),null!=a&&(o=Math.floor(.25*a.MaxValue*r),this._revengeCountLabel.text=Math.max(o+a.ExtValue-a.Value,0)+"/"+(o+a.ExtValue))},t.prototype._UpdateSlaveItemNum=function(){var e=Math.min(99,ItemManager.GetItemCount(402));this._snackNumLabel.text=e.toString();var t=Math.min(99,ItemManager.GetItemCount(401));this._lashNumLabel.text=t.toString();var i=Math.min(99,ItemManager.GetItemCount(403));this._fawnNumLabel.text=i.toString()},t.prototype._OnPraiseClick=function(){SoundManager.PlayButtonMusic();var e=FrequencyManager.GetFrequency(10);if(null!=e){if(e.CD>0)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext12"));var t=SlaveManager.Level,i=Math.floor(.25*e.MaxValue*t);return e.Value>=i+e.ExtValue?void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext13")):void this._HuDong(NetNumber.SlavePraise,this._slaveOpenid)}},t.prototype._PraiseReturn=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.info.code;if(t!=NetManager.SuccessCode)return void Main.AddDebug("表扬返回错误,code="+t);this._contentImageRes="nulihudong_tu_biaoyang",this.updataCountentIma();var i=e.info.bonus,n=StringMgr.GetText("slavepagetext14"),a=FriendManager.GetFriendByID(this._slaveOpenid);null!=a&&(n=a.Name),Game.GameStatus||PromptManager.SlaveTip(i,StringMgr.GetText("slavepagetext15"),n+StringMgr.GetText("slavepagetext16"))},t.prototype._OnLashClick=function(){SoundManager.PlayButtonMusic();var e=FrequencyManager.GetFrequency(12);if(null!=e){var t=SlaveManager.Level,i=Math.floor(.25*e.MaxValue*t);if(e.Value>=i+e.ExtValue)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext17"));if(ItemManager.GetItemCount(401)<=0)return this._shopID=4021,void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext18"),"",this._OnBuyItem.bind(this));var n=ItemManager.GetItemByID(401);if(null!=n){var a=StringMgr.GetText("slavepagetext19");a=a.replace("&item",n.Name),PromptManager.CreatCenterTip(!1,!1,a,"",this._Lash.bind(this))}}},t.prototype._Lash=function(){this._HuDong(NetNumber.SlaveLash,this._slaveOpenid)},t.prototype._LashReturn=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.info.code;if(t!=NetManager.SuccessCode)return Main.AddDebug("责骂返回错误,code="+t),void(501==t&&(ItemManager.SetItemCount(40401,0),this._shopID=4021,PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext21"),"",this._OnBuyItem.bind(this))));ItemManager.UseItem(40401,1),this._contentImageRes="nulihudong_tu_zema",this.updataCountentIma();var i=e.info.bonus,n=StringMgr.GetText("slavepagetext14"),a=FriendManager.GetFriendByID(this._slaveOpenid);if(null!=a&&(n=a.Name),!Game.GameStatus){var r=StringMgr.GetText("slavepagetext23");r=r.replace("&slave",n),PromptManager.SlaveTip(i,StringMgr.GetText("slavepagetext22"),r)}},t.prototype._OnSnackClick=function(){SoundManager.PlayButtonMusic();var e=FrequencyManager.GetFrequency(7);if(null!=e){var t=SlaveManager.Level,i=Math.floor(.25*e.MaxValue*t);if(e.Value>=i+e.ExtValue)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext17"));if(ItemManager.GetItemCount(402)<=0)return this._shopID=4022,void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext25"),this._OnBuyItem.bind(this));var n=ItemManager.GetItemByID(402);if(null!=n){var a=StringMgr.GetText("slavepagetext26");a=a.replace("&item",n.Name),PromptManager.CreatCenterTip(!1,!1,a,"",this._Snack.bind(this))}}},t.prototype._Snack=function(){this._HuDong(NetNumber.SlaveFood,this._slaveOpenid)},t.prototype._SnackReturn=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.info.code;if(t!=NetManager.SuccessCode)return Main.AddDebug("加餐返回错误,code="+t),void(501==t&&(ItemManager.SetItemCount(40402,0),this._shopID=4022,PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext25"),"",this._OnBuyItem.bind(this))));ItemManager.UseItem(40402,1),this._contentImageRes="nulihudong_tu_jiacan",this.updataCountentIma();var i=e.info.bonus,n=StringMgr.GetText("slavepagetext14"),a=FriendManager.GetFriendByID(this._slaveOpenid);null!=a&&(n=a.Name),Game.GameStatus||PromptManager.SlaveTip(i,StringMgr.GetText("slavepagetext28"),StringMgr.GetText("slavepagetext29")+n)},t.prototype._OnFawnClick=function(){SoundManager.PlayButtonMusic();var e=FrequencyManager.GetFrequency(9);if(null!=e){var t=SlaveManager.Level,i=Math.floor(.25*e.MaxValue*t);if(e.Value>=i+e.ExtValue)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext17"));if(ItemManager.GetItemCount(403)<=0)return this._shopID=4023,void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext21"),"",this._OnBuyItem.bind(this));var n=ItemManager.GetItemByID(403);if(null!=n){var a=StringMgr.GetText("slavepagetext26");a=a.replace("&item",n.Name),PromptManager.CreatCenterTip(!1,!1,a,"",this._Fawn.bind(this))}}},t.prototype._Fawn=function(){var e=SlaveManager.Master;null!=e&&this._HuDong(NetNumber.SlaveFawn,e.openid)},t.prototype._FawnReturn=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.info.code;if(t!=NetManager.SuccessCode)return Main.AddDebug("谄媚返回错误,code="+t),void(501==t&&(ItemManager.SetItemCount(40403,0),this._shopID=4023,PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext21"),"",this._OnBuyItem.bind(this))));ItemManager.UseItem(40403,1),this._contentImageRes="nulihudong_tu_xianmei",this.updataCountentIma();var i=e.info.bonus,n="";if(null!=SlaveManager.Master)var a=FriendManager.GetFriendByID(SlaveManager.Master.openid);if(null!=a&&(n=a.Name),!Game.GameStatus){var r=StringMgr.GetText("slavepagetext31");r=r.replace("&master",n),PromptManager.SlaveTip(i,StringMgr.GetText("slavepagetext30"),r)}},t.prototype._OnRevengeClick=function(){SoundManager.PlayButtonMusic();var e=FrequencyManager.GetFrequency(8);if(null!=e){if(e.CD>0)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext12"));var t=SlaveManager.Level,i=Math.floor(.25*e.MaxValue*t);if(e.Value>=i+e.ExtValue)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext13"));var n=SlaveManager.Master;null!=n&&this._HuDong(NetNumber.SlaveAvenge,n.openid)}},t.prototype._RevengeReturn=function(e){WindowManager.WaitPage().IsVisibled=!1;var t=e.info.code;if(t!=NetManager.SuccessCode)return void Main.AddDebug("报复返回错误,code="+t);this._contentImageRes="nulihudong_tu_baofu",this.updataCountentIma();var i=e.info.bonus,n="";if(null!=SlaveManager.Master)var a=FriendManager.GetFriendByID(SlaveManager.Master.openid);if(null!=a&&(n=a.Name),!Game.GameStatus){var r=StringMgr.GetText("slavepagetext34");r=r.replace("&master",n),PromptManager.SlaveTip(i,StringMgr.GetText("slavepagetext33"),r)}},t.prototype._HuDong=function(e,t){WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType="+e,"&openid="+t])},t.prototype._OnBuyItem=function(){var e=!1;if(4021==this._shopID?e=UnitManager.Player.TestMoney(1e3):4022==this._shopID?e=UnitManager.Player.TestPingGai(20):4023==this._shopID&&(e=UnitManager.Player.TestMoney(1e3)),e){var t=JSON.parse("{}");t.token=UnitManager.Player.GameToken,NetManager.SendRequest(["func="+NetNumber.BuyItem+"&id="+this._shopID+"&num=1&oemInfo="+JSON.stringify(t)],this._OnBuyItemReturn.bind(this))}},t.prototype._OnBuyItemReturn=function(e){var t=e.code;if(t!=NetManager.SuccessCode)return void(9009==t&&PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("commontext1")));if(4021==this._shopID)ItemManager.AddItem(40401,1),this._HuDong(NetNumber.SlaveLash,this._slaveOpenid);else if(4022==this._shopID)ItemManager.AddItem(40402,1),this._HuDong(NetNumber.SlaveFood,this._slaveOpenid);else if(4023==this._shopID){ItemManager.AddItem(40402,1);var i=SlaveManager.Master;if(null==i)return;this._HuDong(NetNumber.SlaveFawn,i.openid)}},t.prototype._OnCloseClick=function(){this.IsVisibled=!1},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowTopLayer.addChild(this),this._UpdateTimes(),this._UpdateCDTime(),this._UpdateSlaveItemNum()):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype.Show=function(e,t){void 0===t&&(t=""),this.IsVisibled=!0,this._slaveOpenid=t,e?(this._masterGroup.visible=!0,this._slaveGroup.visible=!1):(this._masterGroup.visible=!1,this._slaveGroup.visible=!0)},t.prototype.updataCountentIma=function(){var e=StringMgr.LanguageSuffix;if(this._contentImageRes){var t=this._contentImageRes+"_png";RES.getRes(this._contentImageRes+e+"_png")&&(t=this._contentImageRes+e+"_png"),this._contentImage.source=t}},t}(AWindow);__reflect(SlaveHDWindow.prototype,"SlaveHDWindow");var SlavePage=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._index=0,t._timer=0,t._time=0,t.skinName="resource/game_skins/SlavePageSkins.exml",t.width=266,t.height=141,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,ProcessManager.AddProcess(this._Process.bind(this)),this._rentButton.visible=!1,this._fCatchButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCatchClick,this),this._rentButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRentClick,this),this._mInterctiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnMasterHDClick,this),this._freedButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnFreedClcik,this),this._ransomButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRansomClick,this),this._sInterctiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSlaveHDClick,this),this._rebellionButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRebellionClick,this)},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._freeLabel.text=StringMgr.GetText("slavepagetext1"),this._mInterctiveButton.skinName=SkinCreateMgr.CreateButton("nuli_an_hudong_l"+e+"_png","nuli_an_hudong_a"+e+"_png"),this._freedButton.skinName=SkinCreateMgr.CreateButton("nuli_an_shifang_l"+e+"_png","nuli_an_shifang_a"+e+"_png"),this._rentButton.skinName=SkinCreateMgr.CreateButton("nuli_an_shouzu_l"+e+"_png","nuli_an_shouzu_a"+e+"_png"),this._ransomButton.skinName=SkinCreateMgr.CreateButton("nuli_an_shushen_l"+e+"_png","nuli_an_shushen_a"+e+"_png"),this._sInterctiveButton.skinName=SkinCreateMgr.CreateButton("nuli_an_hudong_l"+e+"_png","nuli_an_hudong_a"+e+"_png"),this._rebellionButton.skinName=SkinCreateMgr.CreateButton("nuli_an_fankang_l"+e+"_png","nuli_an_fankang_a"+e+"_png"),this._fCatchButton.skinName=SkinCreateMgr.CreateButton("nuli_an_zhuabu_l"+e+"_png","nuli_an_zhuabu_a"+e+"_png")},t.prototype._OnRentClick=function(){SoundManager.PlayButtonMusic()},t.prototype._OnMasterHDClick=function(){SoundManager.PlayButtonMusic(),WindowManager.SlaveHDWindow().Show(!0,this._slaveOpenid)},t.prototype._OnFreedClcik=function(){SoundManager.PlayButtonMusic(),PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("slavepagetext36"),"",this._Freed.bind(this))},t.prototype._Freed=function(){WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType="+NetNumber.SlaveRelease,"&openid="+this._slaveOpenid],this._ReleaseReturn.bind(this))},t.prototype._ReleaseReturn=function(e){},t.prototype._OnRansomClick=function(){SoundManager.PlayButtonMusic();var e=1*Math.ceil(this._time/3600);if(UnitManager.Player.TestPingGai(e)){var t=StringMgr.GetText("slavepagetext37");t=t.replace("&token",e.toString()),PromptManager.CreatCenterTip(!1,!1,t,"",this._Ransom.bind(this))}},t.prototype._Ransom=function(){var e=(1*Math.ceil(this._time/3600),SlaveManager.Master);null!=e&&(WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType="+NetNumber.SlaveRansom,"&openid="+e.openid],this._RansomReturn.bind(this)))},t.prototype._RansomReturn=function(e){},t.prototype._OnSlaveHDClick=function(){SoundManager.PlayButtonMusic(),WindowManager.SlaveHDWindow().Show(!1)},t.prototype._OnRebellionClick=function(){if(SoundManager.PlayButtonMusic(),!SlaveManager.CanEsvape)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("slavepagetext39"));WindowManager.WaitPage().IsVisibled=!0;var e=SlaveManager.Master;null!=e&&NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType=3103","&openid="+e.openid])},t.prototype._OnCatchClick=function(){WindowManager.SlaveCatchWindow().IsVisibled=!0},Object.defineProperty(t.prototype,"OpenCheckpointID",{get:function(){return this._openCheckpointID},set:function(e){this._openCheckpointID=e},enumerable:!0,configurable:!0}),t.prototype.UpdateShow=function(e){var t=CheckpointManager.MaxCheckpointID;if(t<this._openCheckpointID){this._closeGroup.visible=!0,this._openGroup.visible=!1;var i=StringMgr.GetText("slavepagetext40");i=i.replace("&stage",this._openCheckpointID.toString()),this._closeLabel.text=i}else this._closeGroup.visible=!1,this._openGroup.visible=!0;if(this.visible=!0,UnitStatusMgr.IsSlave){this.visible=0==e;var n=SlaveManager.Master;if(null==n)return void Main.AddDebug("奴隶主获取错误");var a=FriendManager.GetFriendByID(n.openid);if(null==a)return void Main.AddDebug("奴隶主获取好友错误");this._mButtonGroup.visible=!1,this._fButtonGroup.visible=!1,this._freeLabel.visible=!1,this._contentGroup.visible=!0,this._sButtonGroup.visible=!0,this._headImage.source=a.IconRes,this._nameLabel.text=a.Name,this._borderImage.visible=!1,this._time=n.time,this._UpdateTime()}else if(UnitStatusMgr.IsMaster){var r=SlaveManager.SlaveList;if(e>=r.length)return this._mButtonGroup.visible=!1,this._sButtonGroup.visible=!1,this._contentGroup.visible=!1,this._fButtonGroup.visible=!0,void(this._freeLabel.visible=!0);this._slaveOpenid=r[e].openid;var a=FriendManager.GetFriendByID(this._slaveOpenid);if(null==a)return void Main.AddDebug("奴隶获取好友错误");this._mButtonGroup.visible=!0,this._fButtonGroup.visible=!1,this._freeLabel.visible=!1,this._contentGroup.visible=!0,this._sButtonGroup.visible=!1,this._headImage.source=a.IconRes,this._nameLabel.text=a.Name,this._borderImage.visible=!0,this._time=r[e].time,this._UpdateTime()}else UnitStatusMgr.IsFreed&&(this._contentGroup.visible=!1,this._mButtonGroup.visible=!1,this._sButtonGroup.visible=!1,this._fButtonGroup.visible=!0,this._freeLabel.visible=!0)},t.prototype._UpdateTime=function(){},t.prototype._Process=function(e){if(this._contentGroup.visible&&!(this._time<=0)){var t=1e3;this._timer+=e,this._timer>=t&&(this._timer-=t,this._time-=1,this._UpdateTime())}},t}(AWindow);__reflect(SlavePage.prototype,"SlavePage");var SlaveWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._isCreated=!1,t._pageSet=[],t.skinName="resource/game_skins/SlaveWindowSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this._InitPage(),GameEvent.AddEventListener(EventType.SlaveInfoChange,this._UpdateShow,this),GameEvent.AddEventListener(EventType.SlaveTimesUpdate,this._UpdateTimes,this),this._addButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAddClick,this)},t.prototype._UpdataText=function(){StringMgr.Language==StringMgr.CN?(this._text1.text="你的身份：",this._text2.text="你的称号：",this._ciLabel.visible=!0):(this._text1.text="Identity:",this._text2.text="Title:",this._ciLabel.visible=!1),this._UpdateShow()},t.prototype._OnAddClick=function(){var e,t=[10,20,50,80,100];if(UnitStatusMgr.IsSlave){e=FrequencyManager.GetFrequency(6);var i=e.ExtValue,n=i>=t.length?t[4]:t[i];if(UnitManager.Player.TestPingGai(n)){var a=StringMgr.GetText("slavepagetext43");a=a.replace("&token",n.toString()),PromptManager.CreatCenterTip(!1,!1,a,"",this._BuyEscapeTimes.bind(this))}}else{e=FrequencyManager.GetFrequency(5);var i=e.ExtValue,n=i>=t.length?t[4]:t[i];if(UnitManager.Player.TestPingGai(n)){var a=StringMgr.GetText("slavepagetext44");a=a.replace("&token",n.toString()),PromptManager.CreatCenterTip(!1,!1,a,"",this._BuyCatchTimes.bind(this))}}},t.prototype._BuyEscapeTimes=function(){FrequencyManager.AddShareTime(6..toString())},t.prototype._BuyCatchTimes=function(){FrequencyManager.AddShareTime(5..toString())},t.prototype._InitPage=function(){for(var e=[5,5,20,20,35,35,50,50],t=0;8>t;t++){var i=new SlavePage;i.OpenCheckpointID=e[t],i.x=t%2==0?52:322,i.y=Math.floor(t/2)*(i.height+16)+157,this.addChild(i),this._pageSet.push(i)}},t.prototype._UpdateShow=function(){for(var e=[50,35,20,5],t=0;t<this._pageSet.length;t++)this._pageSet[t].UpdateShow(t);var i=StringMgr.LanguageSuffix;UnitStatusMgr.IsMaster?this._sfImage.source="nuli_kuangxia_zhuren"+i+"_png":UnitStatusMgr.IsSlave?this._sfImage.source="nuli_kuangxia_nuli"+i+"_png":UnitStatusMgr.IsFreed&&(this._sfImage.source="nuli_kuangxia_ziyoushen"+i+"_png"),this._UpdateTimes();for(var n=Math.max(5,CheckpointManager.MaxCheckpointID),a=["nuli_chuo_wfbr","nuli_chuo_hxxl","nuli_chuo_hxlb","nuli_chuo_xfja"],t=0;t<e.length;t++)if(n>=e[t]){this._levelImage.source=a[t]+i+"_png";break}},t.prototype._UpdateTimes=function(){var e=FrequencyManager.GetFrequency(5);if(null==e)return void Main.AddDebug("获取不到次数信息，type=5");var t=FrequencyManager.GetFrequency(6);return null==t?void Main.AddDebug("获取不到次数信息，type=6"):void(UnitStatusMgr.IsMaster?(this._desLabel.text=StringMgr.GetText("slavepagetext45"),null!=e&&(this._timesLabel.text=(e.MaxValue+e.ExtValue-e.Value).toString())):UnitStatusMgr.IsSlave?(this._desLabel.text=StringMgr.GetText("slavepagetext46"),null!=t&&(this._timesLabel.text=(t.MaxValue+t.ExtValue-t.Value).toString())):UnitStatusMgr.IsFreed&&(this._desLabel.text=StringMgr.GetText("slavepagetext45"),null!=e&&(this._timesLabel.text=(e.MaxValue+e.ExtValue-e.Value).toString())))},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(Main.Instance.WindowBottomLayer.addChild(this),this._UpdateShow()):Main.Instance.WindowBottomLayer.removeChild(this))},enumerable:!0,configurable:!0}),t}(AWindow);__reflect(SlaveWindow.prototype,"SlaveWindow");var StarWindow=function(e){function t(){var t=e.call(this)||this;return t._isCreated=!1,t._isVisibled=!1,t._dailyActiveJingGuoTime=0,t._dailyActiveEndJingGuoTime=0,t._checkpointPageSet=[],t._checkBgSet=[],t._checkBgItemSet=[],t.skinName="resource/game_skins/StarPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._isCreated=!0,this.addChildAt(Main.Instance.WindowBottomLayer,0),this._shareGroup.touchEnabled=!0,this._setGroup.touchEnabled=!0,this._checkPointGroup.touchEnabled=!0,this._moreGroup.touchEnabled=!0,this._buttonGroup.touchEnabled=!0,this._returnButton.visible=!1,this._buttonGroup.visible=!1,this._integralButton.visible=!1,this._integralRedIma.visible=!1,this._receiveButton.visible=!1,this._receiveRedIma.visible=!1,this._noticeRedIma.visible=!1,this._activeGroup.visible=!1,this._checkpointScroller.bounces=!1,CheckpointManager.ChooseCheckPointId=-1,this._returnButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnReturnClick,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnShareClick,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._OnShareBegin,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_END,this._OnShareEnd,this),this._setButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._OnSetBegin,this),this._setButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSetClick,this),this._moreButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnMoreClick,this),this._noticeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnNoticeClick,this),this._achievementButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAchievementClick,this),this._roleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRoleClick,this),this._friendButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnFriendClick,this),this._shopButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnShopClick,this),this._rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRankClick,this),this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStarClick,this),this._keepButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._OnKeepBegin,this),this._keepButton.addEventListener(egret.TouchEvent.TOUCH_END,this._OnKeepEnd,this),this._keepButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKeepClick,this),this._guideKeepButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKeepClick,this),this._vipButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnVipClick,this),this._integralButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnIntegralClick,this),this._endlessButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnEndlessClick,this),this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnIntegralReceiveClick,this),this._bagButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBagClick,this),this._slaveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSlaveClick,this),this._firstChargeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnFirstClick,this),this._dailyActiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnDailyActiveClick,this),this._activeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnActiveClick,this),this._UpdatePhysical(),this._UpdatePhysicalTime(),this._UpdateHead(),GameEvent.AddEventListener(EventType.PhysicalChange,this._UpdatePhysical,this),GameEvent.AddEventListener(EventType.MaxPhysicalChange,this._UpdatePhysical,this),GameEvent.AddEventListener(EventType.PhysicalTimeChange,this._UpdatePhysicalTime,this),GameEvent.AddEventListener(EventType.PlayerHeadChange,this._UpdateHead,this),GameEvent.AddEventListener(EventType.ShouHello,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.AchieveUpdata,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.RoleSuiPianItemUpdate,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.RoleSkillUpLevel,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.ActivityExchangeState,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.UserStatusChange,this.updataRedIsVisible,this),GameEvent.AddEventListener(EventType.UserStatusChange,this._UpdataFirstCharge,this),GameEvent.AddEventListener(EventType.DailyAcitveStateUpData,this._UpdateDailyActiveButtonVisible,this),GameEvent.AddEventListener(EventType.UserStatusChange,this._UpdateDailyActiveButtonVisible,this),GameEvent.AddEventListener(EventType.ChooseCheckPonit,this.creatCheckPoint,this),GameEvent.AddEventListener(EventType.UserStatusChange,this.creatCheckPoint,this),this._nameLabel.filters=[FilterManage.AddMiaoBian(3,1133663)],this._nameLabel.text=UnitManager.Player.Name,ProcessManager.AddProcess(this._Process.bind(this)),this.UpdateFirstShare(),UnitManager.CheckDayGift(),ActiveManager.CheckBonus(),UnitManager.CheckPlayGift(),GuideManager.GuideCheck(),ResReadyMgr.IsReady("prompt"),PromptManager.CheckGenXin(),this._UpdateButton(),this._AddActiveButtonAni(),this._UpdateDailyActiveButtonVisible()
},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._setButton.skinName=SkinCreateMgr.CreateButton("shezhi_l"+e+"_png","shezhi_l"+e+"_png"),this._shareButton.skinName=SkinCreateMgr.CreateButton("fenxiang_l"+e+"_png","fenxiang_l"+e+"_png"),this._keepButton.skinName=SkinCreateMgr.CreateButton("shoucang_l"+e+"_png","shoucang_l"+e+"_png"),this._guideKeepButton.skinName=SkinCreateMgr.CreateButton("shoucang_l2"+e+"_png","shoucang_l2"+e+"_png"),this._activeButton.skinName=SkinCreateMgr.CreateButton("huodong_l"+e+"_png","huodong_a"+e+"_png"),this._dailyActiveButton.skinName=SkinCreateMgr.CreateButton("tiaozhan_l"+e+"_png","tiaozhan_a"+e+"_png"),this._integralButton.skinName=SkinCreateMgr.CreateButton("jifen_l"+e+"_png","jifen_a"+e+"_png"),this._vipButton.skinName=SkinCreateMgr.CreateButton("vipyueka_l"+e+"_png","vipyueka_a"+e+"_png"),this._firstChargeButton.skinName=SkinCreateMgr.CreateButton("shouchong_l"+e+"_png","shouchong_a"+e+"_png"),this._moreButton.skinName=SkinCreateMgr.CreateButton("gengduo_l"+e+"_png","gengduo_a"+e+"_png"),this._slaveButton.skinName=SkinCreateMgr.CreateButton("nuli_l"+e+"_png","nuli_a"+e+"_png"),this._achievementButton.skinName=SkinCreateMgr.CreateButton("chengjiu_l"+e+"_png","chengjiu_a"+e+"_png"),this._bagButton.skinName=SkinCreateMgr.CreateButton("beibao_l"+e+"_png","beibao_a"+e+"_png"),this._noticeButton.skinName=SkinCreateMgr.CreateButton("xinxi_l"+e+"_png","xinxi_a"+e+"_png"),this._returnButton.skinName=SkinCreateMgr.CreateButton("fanhui_l"+e+"_png","fanhui_a"+e+"_png"),this._roleButton.skinName=SkinCreateMgr.CreateButton("juese_l"+e+"_png","juese_a"+e+"_png"),this._friendButton.skinName=SkinCreateMgr.CreateButton("haoyou_l"+e+"_png","haoyou_a"+e+"_png"),this._shopButton.skinName=SkinCreateMgr.CreateButton("shangcheng_l"+e+"_png","shangcheng_a"+e+"_png"),this._rankButton.skinName=SkinCreateMgr.CreateButton("paihang_l"+e+"_png","paihang_a"+e+"_png"),this._startButton.skinName=SkinCreateMgr.CreateButton("kaishi_l"+e+"_png","kaishi_l"+e+"_png"),this._endlessButton.skinName=SkinCreateMgr.CreateButton("kaishi_wujin_l"+e+"_png","kaishi_wujin_a"+e+"_png"),this._receiveButton.skinName=SkinCreateMgr.CreateButton("lingjiang_l"+e+"_png","lingjiang_a"+e+"_png"),this._UpdatePhysicalTime()},t.prototype._OnActiveClick=function(){this._activeGroup.visible=!this._activeGroup.visible},t.prototype._OnGuoQingClick=function(){return null!=WindowManager.GuoQingActiveWindow()?void this._OpenGuoQingActive():void WindowManager.SetWindowFunction(this._OpenGuoQingActive.bind(this))},t.prototype._OnGuoQingSceneClick=function(){return null!=WindowManager.GuoQingSceneWindow()?void this._OpenGuoQingScene():void WindowManager.SetWindowFunction(this._OpenGuoQingScene.bind(this))},t.prototype._OpenGuoQingActive=function(){WindowManager.GuoQingActiveWindow().IsVisibled=!0},t.prototype._OpenGuoQingScene=function(){WindowManager.GuoQingSceneWindow().IsVisibled=!0},t.prototype._UpdateDailyActiveButtonVisible=function(){UnitManager.DailyActiveState?(this._dailyActiveButton.visible=!0,this._AddDailyMovie(),UnitManager.DailyActiveStartTimeNum>0?(this._dailyActiveTimeLabel.visible=!0,this._dailyActiveTimeLabel.text=FBSDKMgr.FormatTime(UnitManager.DailyActiveStartTimeNum)):this._dailyActiveTimeLabel.visible=!1,null!=this._currentWindow):(this._dailyActiveButton.visible=!1,this._dailyActiveTimeLabel.visible=!1,this._dailyActiveButtonMovie&&(this._dailyActiveButtonMovie.stop(),this._activeGroup.removeChild(this._dailyActiveButtonMovie),this._dailyActiveButtonMovie=null))},t.prototype.UpdateFirstShare=function(){UnitStatusMgr.IsFirstShare?(null==this._shareMovie&&(this._shareMovie=new egret.MovieClip(MovieManager.GetMovieClipData("sharemovie_json","sharemovie_png","toucishoucang")),this._shareMovie.x=-25,this._shareMovie.y=-25,this._shareMovie.touchEnabled=!1),null==this._shareImage&&(this._shareImage=new eui.Image("shoucang_li_png"),this._shareImage.x=12,this._shareImage.y=8),this._shareMovie.play(-1),this._shareGroup.addChild(this._shareMovie),this._shareGroup.addChild(this._shareImage)):(null!=this._shareMovie&&null!=this._shareMovie.parent&&(this._shareMovie.stop(),this._shareMovie.parent.removeChild(this._shareMovie)),null!=this._shareImage&&null!=this._shareImage.parent&&this._shareImage.parent.removeChild(this._shareImage))},t.prototype.updataRedIsVisible=function(){this._achievementRedIma.visible=NewPointManager.AchiRedPointIsVisible(),this._roleRedIma.visible=NewPointManager.RoleRedPointIsVisible(),this._friendRedIma.visible=NewPointManager.friendRedPointIsVisible(),this._noticeRedIma.visible=UnitStatusMgr.HasNewMail,this._slaveRedIma.visible=NewPointManager.SlaveRedIsVisible,this._vipRedIma.visible=NewPointManager.VIPRedIsVisible,this._achievementRedIma.visible||this._noticeRedIma.visible?this._moreRedIma.visible=!0:this._moreRedIma.visible=!1,"Bonus"==IntegralManager.State?(this._receiveButton.visible=NewPointManager.ReceiveButtonIsVisible(),this._receiveRedIma.visible=NewPointManager.ReceiveButtonIsVisible(),this._integralRedIma.visible=!1,this._integralButton.visible=!1):(this._receiveButton.visible=!1,this._receiveRedIma.visible=!1,this._integralRedIma.visible=NewPointManager.ActivityRedPointIsVisible(),this._integralButton.visible=!0)},t.prototype._UpdateHead=function(){this._headImage.source=UnitManager.Player.HearUrl},t.prototype._UpdatePhysical=function(){var e=UnitManager.Player.Physical,t=UnitManager.Player.MaxPhysical;this._tiliLabel.text=e+"/"+t},t.prototype._UpdatePhysicalTime=function(){var e=UnitManager.Player.PhysicalTime;if(UnitManager.Player.Physical<UnitManager.Player.MaxPhysical?this._timeLabel.visible=!0:this._timeLabel.visible=!1,this._timeLabel.visible=0!=e,0!=e){var t=Math.floor(e/3600),i=Math.floor(e%3600/60),n=e%60|0,a=10>t?"0"+t.toString():t.toString(),r=10>i?"0"+i.toString():i.toString(),o=10>n?"0"+n.toString():n.toString(),s="后";StringMgr.Language==StringMgr.EN&&(s="  "),this._timeLabel.text=a+":"+r+":"+o+s+"+1"}},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?Main.Instance.WindowTopLayer.addChild(this):Main.Instance.WindowTopLayer.removeChild(this))},enumerable:!0,configurable:!0}),t.prototype._OnReturnClick=function(){SoundManager.PlayButtonMusic(),this.CloseWindow()},t.prototype._OnShareBegin=function(){this._shareGroup.y=-8,egret.Tween.removeTweens(this._shareGroup);var e=egret.Tween.get(this._shareGroup);e.to({y:0},100)},t.prototype._OnShareEnd=function(){this._shareGroup.y=0,egret.Tween.removeTweens(this._shareGroup);var e=egret.Tween.get(this._shareGroup);e.to({y:-8},100)},t.prototype._OnShareClick=function(){window.location.href="http://h5.gamegold.xin"},t.prototype._FirstShareReturn=function(e){},t.prototype._OnKeepBegin=function(){this._keepGroup.y=-8,egret.Tween.removeTweens(this._keepGroup);var e=egret.Tween.get(this._keepGroup);e.to({y:0},100)},t.prototype._OnKeepEnd=function(){this._keepGroup.y=0,egret.Tween.removeTweens(this._keepGroup);var e=egret.Tween.get(this._keepGroup);e.to({y:-8},100)},t.prototype._OnKeepClick=function(){SoundManager.PlayButtonMusic(),this._guideKeepButton.visible=!1,GuideManager.IsGuide&&8==GuideManager.GuideID&&(WindowManager.KeepRewardTip().IsVisibled=!0,GuideManager.GuideFinish(8))},t.prototype._OnSetBegin=function(){this._setGroup.y=-8,egret.Tween.removeTweens(this._setGroup);var e=egret.Tween.get(this._setGroup);e.to({y:0},100)},t.prototype._OnSetClick=function(){SoundManager.PlayButtonMusic(),this._setGroup.y=0,egret.Tween.removeTweens(this._setGroup);var e=egret.Tween.get(this._setGroup);return e.to({y:-8},100),null!=WindowManager.SetWindow()?void this._OpenSet():void WindowManager.SetWindowFunction(this._OpenSet.bind(this))},t.prototype._OpenSet=function(){WindowManager.SetWindow().IsVisibled=!0},t.prototype._OnMusicBegin=function(){this._setGroup.y=-8,egret.Tween.removeTweens(this._setGroup);var e=egret.Tween.get(this._setGroup);e.to({y:0},100)},t.prototype._OnMusicEnd=function(){this._setGroup.y=0,egret.Tween.removeTweens(this._setGroup);var e=egret.Tween.get(this._setGroup);e.to({y:-8},100)},t.prototype._OnMusicChange=function(){SoundManager.PlayBackgroundMusic(),SoundManager.PlayButtonMusic()},Object.defineProperty(t.prototype,"MusicStatus",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._OnMoreClick=function(){SoundManager.PlayButtonMusic(),this._buttonGroup.visible=!this._buttonGroup.visible},t.prototype._OnNoticeClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.NoticeWindow()?void WindowManager.SetWindowFunction(this._OpenNotice.bind(this)):void this._OpenNotice()},t.prototype._OpenNotice=function(){this.OpenWindow(WindowManager.NoticeWindow())},t.prototype._OnAchievementClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.AchievementWindow()?void WindowManager.SetWindowFunction(this._OpenAchievement.bind(this)):void this._OpenAchievement()},t.prototype._OpenAchievement=function(){this.OpenWindow(WindowManager.AchievementWindow())},t.prototype._OnBagClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.BagWindow()?void WindowManager.SetWindowFunction(this._OpenBag.bind(this)):void this._OpenBag()},t.prototype._OpenBag=function(){this.OpenWindow(WindowManager.BagWindow())},t.prototype._OnSlaveClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.SlaveWindow()?void WindowManager.SetWindowFunction(this._OpenSlave.bind(this)):void this._OpenSlave()},t.prototype._OpenSlave=function(){this.OpenWindow(WindowManager.SlaveWindow())},t.prototype._OnVipClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.VIPWindow()?void WindowManager.SetWindowFunction(this._OpenVIP.bind(this)):void this._OpenVIP()},t.prototype._OpenVIP=function(){this.OpenWindow(WindowManager.VIPWindow())},t.prototype._OnDailyActiveClick=function(){SoundManager.PlayButtonMusic(),WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.GetDailyActiveInfo],this._ReceiveDailyActiveInfo.bind(this))},t.prototype._ReceiveDailyActiveInfo=function(e){if(WindowManager.WaitPage().IsVisibled=!1,e.code!=NetManager.SuccessCode)return void PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("startpagetext2"));var t=e.data;if("Active"==t.state){if(null==WindowManager.DailyActiveStartWindow())return void WindowManager.SetWindowFunction(this._OpenDailyActiveStartWindow.bind(this),e);this._OpenDailyActiveStartWindow(e)}else if("End"==t.state||"Bonus"==t.state){if(null==WindowManager.DailyActiveStartWindow())return void WindowManager.SetWindowFunction(this._OpenDailyActiveStartWindow.bind(this),e);this._OpenDailyActiveStartWindow(e)}else{if(null==WindowManager.DailyActiveYuReWindow())return void WindowManager.SetWindowFunction(this._OpenDailyActiveYuReWindow.bind(this),e);this._OpenDailyActiveYuReWindow(e)}},t.prototype._OpenDailyActiveYuReWindow=function(e){WindowManager.DailyActiveYuReWindow().IsVisibled=!0,WindowManager.DailyActiveYuReWindow().Show(e)},t.prototype._OpenDailyActiveStartWindow=function(e){WindowManager.DailyActiveStartWindow().IsVisibled=!0,WindowManager.DailyActiveStartWindow().Show(e)},t.prototype._OnFirstClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.FirstChargeWindow()?void WindowManager.SetWindowFunction(this._OpenFirst.bind(this)):void this._OpenFirst()},t.prototype._OpenFirst=function(){this.OpenWindow(WindowManager.FirstChargeWindow())},t.prototype._OnIntegralClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.IntegralWindow()?void WindowManager.SetWindowFunction(this._OpenIntegral.bind(this)):void this._OpenIntegral()},t.prototype._OnIntegralReceiveClick=function(){SoundManager.PlayButtonMusic(),NetManager.SendRequest(["func="+NetNumber.ActivityGetBonus+"&id=0"],this._ReveiveActivityGetBonus.bind(this))},t.prototype._ReveiveActivityGetBonus=function(e){var t=e.code,i=e.data;t==NetManager.SuccessCode&&(IntegralManager.GitStateById(0,1),PromptManager.ShowGit(i.bonus))},t.prototype._OpenIntegral=function(){this.OpenWindow(WindowManager.IntegralWindow())},t.prototype._OnEndlessClick=function(){return SoundManager.PlayButtonMusic(),this._starGroup.visible=!1,CheckpointManager.CurrentCheckpointID=CheckpointManager.EndlessCheckpointID,null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(this._OpenRoleSelect.bind(this)):void this._OpenRoleSelect()},t.prototype._OpenRoleSelect=function(){WindowManager.RoleSelectWindow().IsVisibled=!0},t.prototype._OnRoleClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.RoleWindow()?void WindowManager.SetWindowFunction(this._OpenRole.bind(this)):void this._OpenRole()},t.prototype._OpenRole=function(){this.OpenWindow(WindowManager.RoleWindow())},t.prototype._OnFriendClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.FriendWindow()?void WindowManager.SetWindowFunction(this._OpenFriend.bind(this)):void this._OpenFriend()},t.prototype._OpenFriend=function(){this.OpenWindow(WindowManager.FriendWindow())},t.prototype._OnShopClick=function(){SoundManager.PlayButtonMusic(),this.GoShop()},t.prototype.GoShop=function(){return null==WindowManager.ShopWindow()?void WindowManager.SetWindowFunction(this._OpenShop.bind(this)):void this._OpenShop()},t.prototype._OpenShop=function(){this.OpenWindow(WindowManager.ShopWindow())},t.prototype._OnRankClick=function(){return SoundManager.PlayButtonMusic(),null==WindowManager.RankWindow()?void WindowManager.SetWindowFunction(this._OpenRank.bind(this)):void this._OpenRank()},t.prototype._OpenRank=function(){this.OpenWindow(WindowManager.RankWindow())},t.prototype._OnStarClick=function(){this._starGroup.visible=!this._starGroup.visible},t.prototype.OpenWindow=function(e){null!=this._currentWindow&&(this._currentWindow.IsVisibled=!1),this._currentWindow=e,this._checkPointGroup.visible=!1,this._headGroup.visible=!1,this._tiliGroup.visible=!1,this._moreGroup.visible=!1,this._nameLabel.visible=!1,this._moreButtonGroup.visible=!1,this._slaveGroup.visible=!1,this._starGroup.visible=!1,this._returnButton.visible=!0,this._checkBgIma2.visible=!1,this._activeGroup.visible=!1,this._activeButtonGroup.visible=!1,null!=this._currentWindow&&(this._currentWindow.IsVisibled=!0),this._UpdateButton()},t.prototype.CloseWindow=function(){this._checkPointGroup.visible=!0,this._headGroup.visible=!0,this._tiliGroup.visible=!0,this._moreGroup.visible=!0,this._nameLabel.visible=!0,this._moreButtonGroup.visible=!0,this._slaveGroup.visible=!0,this._checkBgIma2.visible=!0,this._activeButtonGroup.visible=!0,this._returnButton.visible=!1,this._starGroup.visible=!1,null!=this._currentWindow&&(this.upDataShowCheckPoint(),this._currentWindow.IsVisibled=!1,this._currentWindow=null),this._UpdateButton()},t.prototype._UpdateButton=function(){var e=995,t=970,i=987,n=962;this.updataRedIsVisible(),null!=this._currentWindow?(this._roleButton.y=this._currentWindow==WindowManager.RoleWindow(!1)?t:e,this._friendButton.y=this._currentWindow==WindowManager.FriendWindow(!1)?t:e,this._shopButton.y=this._currentWindow==WindowManager.ShopWindow(!1)?t:e,this._rankButton.y=this._currentWindow==WindowManager.RankWindow(!1)?t:e,this._roleRedIma.y=this._currentWindow==WindowManager.RoleWindow(!1)?n:i,this._friendRedIma.y=this._currentWindow==WindowManager.FriendWindow(!1)?n:i):(this._roleButton.y=e,this._friendButton.y=e,this._shopButton.y=e,this._rankButton.y=e,this._roleRedIma.y=i,this._friendRedIma.y=i),this._UpdataFirstCharge(),this._vipButton.visible=!1},t.prototype._UpdataFirstCharge=function(){this._firstChargeButton.visible=!1},t.prototype._AddActiveButtonAni=function(){if(null==this._activeButtonMovie){var e=MovieManager.GetMovieClipData("huodongtx_json","huodongtx_png","huodongtx");this._activeButtonMovie=new egret.MovieClip(e),this._activeButtonMovie.play(-1),this._activeButtonMovie.x=this._dailyActiveButton.x+this._dailyActiveButton.width/2-17,this._activeButtonMovie.y=this._dailyActiveButton.y+this._dailyActiveButton.height/2,this._activeButtonGroup.addChildAt(this._activeButtonMovie,0)}},t.prototype._AddDailyMovie=function(){if(null==this._dailyActiveButtonMovie){var e=MovieManager.GetMovieClipData("activemovie_json","activemovie_png","tiaozhantx");this._dailyActiveButtonMovie=new egret.MovieClip(e),this._dailyActiveButtonMovie.play(-1),this._dailyActiveButtonMovie.x=this._dailyActiveButton.x+this._dailyActiveButton.width/2,this._dailyActiveButtonMovie.y=this._dailyActiveButton.y+this._dailyActiveButton.height/2}},t.prototype.upDataShowCheckPoint=function(){null==this._currentWindow&&this.creatCheckPoint()},t.prototype.creatCheckPoint=function(){if(ResReadyMgr.IsReady("checkpointwindow")&&ResReadyMgr.IsReady("startrole")&&this._isCreated&&CheckpointManager.IsRevice){if(0==this._checkpointPageSet.length){var e=200,t=250;this._checkpointPageSet=[];for(var i=[250,100,250,400],n=CheckpointManager.GetCheckpointSet(),a=0,r=(this._checkBgSet[0]?this._checkBgSet[this._checkBgSet.length-1].y+this._checkBgSet[this._checkBgSet.length-1].height:0,0),o=0;26>o;o++){var s=new eui.Image;this._checkPointGroup.addChild(s),t=o%4==0&&0!=o?427:250,o%4==0&&(s.source="zhujiemianxg_biud4_png",s.y=r+t-s.height/2,s.x=0),o%4==1&&(s.source="zhujiemianxg_biud1_png",s.y=r+t-s.height/2,s.x=404),o%4==2&&(s.source="zhujiemianxg_biud2_png",s.y=r+t-s.height/2+15,s.x=0),o%4==3&&(s.source="zhujiemianxg_biud5_png",s.y=r+t-s.height/2,s.x=343),25==o&&(s.source="zhujiemianxg_biud5_png",s.y=r+t-s.height/2,s.x=343),r+=t}for(var o=0;o<n.length;o++)if(o+1>this._checkpointPageSet.length){var u=new CheckPage;u.Show(n[o].ID),u.y=e,e+=u.height,u.x=i[a],a+=1,a>=i.length&&(a=0),this._checkPointGroup.addChild(u),this._checkpointPageSet.push(u)}this._checkBgIma1.height=e+this._checkpointPageSet[this._checkpointPageSet.length-1].height}this.updataCheckRole()}},t.prototype.updataCheckRole=function(){var e=CheckpointManager.ChooseCheckPointId;-1==e&&(e=CheckpointManager.MaxCheckpointID),this._checkpointPageSet[e]&&(e>3&&47>e?egret.Tween.get(this._checkpointScroller.viewport).to({scrollV:this._checkpointPageSet[e-4].y},300):3>=e?egret.Tween.get(this._checkpointScroller.viewport).to({scrollV:0},300):e>47&&egret.Tween.get(this._checkpointScroller.viewport).to({scrollV:this._checkpointPageSet[this._checkpointPageSet.length-1].y+this._checkpointPageSet[this._checkpointPageSet.length-1].height},300),this.creatCheckPonitRole())},t.prototype.creatCheckPonitRole=function(){if(null!=UnitManager.CurrentRole){(null==this._startRoleArmature||this._startRoleArmature.roleName!=UnitManager.CurrentRole.Name)&&(this.returnRoleArmature(),this._startRoleArmature=ArmaturePool.GetArmature(UnitManager.CurrentRole.Res+"_01_json",UnitManager.CurrentRole.Res+"_01texture_json",UnitManager.CurrentRole.Res+"_01texture_png",UnitManager.CurrentRole.Res+"_01"),this._checkPointGroup.addChild(this._startRoleArmature.display),this._startRoleArmature.addEventListener(dragonBones.Event.COMPLETE,this._OnReviveEnd,this));var e=CheckpointManager.ChooseCheckPointId;-1==CheckpointManager.ChooseCheckPointId&&(e=CheckpointManager.MaxCheckpointID);var t=this._checkpointPageSet[e-1];this._startRoleArmature.roleName=UnitManager.CurrentRole.Name,t&&(this._startRoleArmature.display.y!=t.y+t.RolePosi[1]&&this._startRoleArmature.animation.play("revive",1),this._startRoleArmature.display.scaleX=1.3,this._startRoleArmature.display.scaleY=1.3,this._startRoleArmature.display.x=t.x+t.RolePosi[0],this._startRoleArmature.display.y=t.y+t.RolePosi[1],this._checkPointGroup.setChildIndex(this._startRoleArmature.display,this._checkPointGroup.numChildren-1))}},t.prototype._OnReviveEnd=function(){this._startRoleArmature.animation.play("walk",0)},t.prototype.returnRoleArmature=function(){null!=this._startRoleArmature&&(this._startRoleArmature.removeEventListener(dragonBones.Event.COMPLETE,this._OnReviveEnd,this),ArmaturePool.ReturnPool(this._startRoleArmature),this._startRoleArmature=null)},t.prototype._Process=function(e){if(UnitManager.DailyActiveState&&UnitManager.DailyActiveStartTimeNum>0&&(this._dailyActiveJingGuoTime+=e,this._dailyActiveJingGuoTime>=1e3&&(this._dailyActiveJingGuoTime-=1e3,UnitManager.DailyActiveStartTimeNum-=1),UnitManager.DailyActiveStartTimeNum<=0&&(this._dailyActiveTimeLabel.visible=!1)),CheckpointManager.MaxCheckpointID<45&&this._checkpointPageSet.length>=50){var t=this._checkpointPageSet[CheckpointManager.MaxCheckpointID+5];this._checkpointScroller.viewport.scrollV>=t.y&&(this._checkpointScroller.viewport.scrollV=t.y,this._checkpointScroller.stopAnimation())}},t.prototype.WindowGuide=function(){this.CloseWindow(),GuideManager.ShowGuideWindow(1,0,0,0,0),CheckpointManager.ChooseCheckPointId=-1},t.prototype.CheckGuide1=function(){this.CloseWindow(),CheckpointManager.ChooseCheckPointId=-1;var e=270,t=160,i=130,n=220;GuideManager.ShowGuideWindow(2,e,t,i,n)},t.prototype.CheckGuide2=function(){this.CloseWindow(),CheckpointManager.ChooseCheckPointId=-1;var e=270,t=160,i=130,n=220;GuideManager.ShowGuideWindow(0,e,t,i,n)},t.prototype.CheckpointGuide=function(){CheckpointManager.ChooseCheckPointId=1,null!=WindowManager.RoleSelectWindow()&&WindowManager.RoleSelectWindow().IsVisibled&&(WindowManager.RoleSelectWindow().IsVisibled=!1);var e=274,t=240,i=122,n=47;GuideManager.ShowGuideWindow(0,e,t,i,n)},t.prototype.ShouCangGuide=function(){this._guideKeepButton.visible=!0;var e=this._keepGroup.x,t=0,i=this._keepGroup.width,n=this._keepGroup.height-8;GuideManager.ShowGuideWindow(4,e,t,i,n)},t}(AWindow);__reflect(StarWindow.prototype,"StarWindow");var VIPWindow=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._price=100,t.skinName="resource/game_skins/VIPPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.updateButton(),this._buyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBuyClick,this),this._rewardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRewardClcik,this),this._giftTip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._TipBegin,this),this._giftTip.addEventListener(egret.TouchEvent.TOUCH_END,this._TipEnd,this),GameEvent.AddEventListener(EventType.VIPTimeUpdate,this._UpdateTime,this),GameEvent.AddEventListener(EventType.VIPRewardTimesChange,this._UpdateMovie,this),this._vipGroup.visible=!1,this._tipGroup.visible=!1,this._UpdateTime()},t.prototype._UpdataText=function(){var e=StringMgr.LanguageSuffix;this._bg.source="vipyueka_di"+e+"_png",this._buyButton.skinName=SkinCreateMgr.CreateButton("vipyueka_an_goumaiyueka_l"+e+"_png","vipyueka_an_goumaiyueka_a"+e+"_png"),this._rewardButton.skinName=SkinCreateMgr.CreateButton("vipyueka_an_dianjilingqu_l"+e+"_png","vipyueka_an_dianjilingqu_a"+e+"_png"),StringMgr.Language==StringMgr.CN?(this._tipLabel.text="爱的鞭子*3\n过期蛋糕*3\n小丑面具*3",this._noRewardText.text="明日可领取"):StringMgr.Language==StringMgr.EN&&(this._tipLabel.text="Whip of Love*3\nExpired Cake*3\nClown Mask*3",this._noRewardText.text="Can receive tomorrow")},t.prototype._TipBegin=function(){this._tipGroup.visible=!0},t.prototype._TipEnd=function(){this._tipGroup.visible=!1},t.prototype._OnRewardClcik=function(){var e=FrequencyManager.GetFrequency(21);return null!=e&&e.Value>=e.MaxValue?void PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext8")):void NetManager.SendRequest(["func="+NetNumber.VipDayGift],this._ReceiveDayGift.bind(this))},t.prototype._ReceiveDayGift=function(e){var t=e.code;if(t!=NetManager.SuccessCode)return void Main.AddDebug("Vip每日领取返回错误：code="+t);var i=e.data,n=i.bonus;PromptManager.GetBonusResData(n,!0),PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext9")),this.updateButton()},t.prototype._OnBuyClick=function(){PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext10"),null,this._BuyVIP.bind(this))},t.prototype._BuyVIP=function(){var e=JSON.parse("{}");e.token=UnitManager.Player.GameToken;var t=Game.IsIos?13161:13160;NetManager.SendRequest(["func="+NetNumber.BuyGold+"&itemid="+t+"&count=1&oemInfo="+JSON.stringify(e)],this._OnBuyVIPCom.bind(this))},t.prototype._OnBuyVIPCom=function(e){var t=e.code;e.data;if(e.code!=NetManager.SuccessCode)1004==t&&PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("vippagetext6"),null,this._OnPayClick.bind(this));else if(e.code==NetManager.SuccessCode){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("vippagetext11"));var i=e.data.bonus;if(null!=i){var n=i.split(",");if("V"==n[0]){var a=parseInt(n[1]),r=24*a*60*60;UnitManager.Player.VIPTime+=r}}this._UpdateMovie(),WindowManager.StarWindow().CloseWindow()}},t.prototype._OnPayClick=function(){Main.AddDebug("发起支付")},t.prototype._OnPaySuccess=function(){this._BuyVIP()},t.prototype._OnPayError=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},t.prototype._OnPayClose=function(){PromptManager.CreatCenterTip(!1,!0,StringMgr.GetText("shopbuypagetext10"))},t.prototype._UpdateTime=function(){if(this.IsVisibled){var e=UnitManager.Player.VIPTime;if(0!=e){var t=Math.floor(e/86400),i=Math.floor(e/3600%24),n=Math.floor(e%3600/60),a=e%60,r=10>i?"0"+i.toString():i.toString(),o=10>n?"0"+n.toString():n.toString();10>a?"0"+a.toString():a.toString();this._dayLabel.text=t.toString(),this._hourLabel.text=r,this._minLabel.text=o}}},t.prototype._UpdateMovie=function(){var e=UnitManager.Player.IsVIP;if(this._buyButton.visible=!e,this._rewardButton.visible=e,this._vipGroup.visible=e,e&&null==this._vipMovieSet){this._vipMovieSet=[];for(var t=MovieManager.GetMovieClipData("vipmovie_json","vipmovie_png","vipyueka_quangyiytx"),i=40,n=40,a=0;6>a;a++){var r=new egret.MovieClip(t);r.x=i+a%2*252,r.y=n+90*Math.floor(a/2),r.play(-1),this._vipGroup.addChild(r),this._vipMovieSet.push(r)}}else if(!e&&null!=this._vipMovieSet&&this._vipMovieSet.length>0){for(var a=0;a<this._vipMovieSet.length;a++)this._vipMovieSet[a].stop(),this._vipGroup.removeChild(this._vipMovieSet[a]);this._vipMovieSet=null}var o=FrequencyManager.GetFrequency(21);if(o.Value<o.MaxValue&&null==this._rewardMovie){var t=MovieManager.GetMovieClipData("boxmovie_json","boxmovie_png","vipyueka_baoxiangtx");this._rewardMovie=new egret.MovieClip(t),this._rewardMovie.x=this._giftTip.x+this._giftTip.width/2,this._rewardMovie.y=this._giftTip.y+this._giftTip.height/2+3,this._rewardMovie.play(-1),this.addChild(this._rewardMovie)}else o.Value>=o.MaxValue&&null!=this._rewardMovie&&this.contains(this._rewardMovie)&&(this._rewardMovie.stop(),this.removeChild(this._rewardMovie),this._rewardMovie=null)},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){if(this._isVisibled!=e)if(this._isVisibled=e,e){if(Main.Instance.WindowBottomLayer.addChild(this),null!=this._vipMovieSet)for(var t=0;t<this._vipMovieSet.length;t++)this._vipMovieSet[t].play(-1);null!=this._rewardMovie&&this._rewardMovie.play(-1),this._UpdateMovie(),this.updateButton()}else{if(Main.Instance.WindowBottomLayer.removeChild(this),null!=this._vipMovieSet)for(var t=0;t<this._vipMovieSet.length;t++)this._vipMovieSet[t].stop();null!=this._rewardMovie&&this._rewardMovie.stop()}},enumerable:!0,configurable:!0}),t.prototype.updateButton=function(){var e=FrequencyManager.GetFrequency(21);null!=e&&e.Value>=e.MaxValue?(this._rewardButton.visible=!1,this._noRewardText.visible=!0,this._giftTip.filters=[FilterManage.HuiDu]):(this._rewardButton.visible=UnitManager.Player.IsVIP,this._giftTip.filters=[],this._noRewardText.visible=!1)},t}(AWindow);__reflect(VIPWindow.prototype,"VIPWindow");var WaitPage=function(e){function t(){var t=e.call(this)||this;return t._isVisibled=!1,t._waitWenBenSet=[],t._isCreated=!1,t._waitTime=0,t._waitDianTime=0,t._dianNum=0,t.skinName="resource/game_skins/WaitPageSkins.exml",t}return __extends(t,e),t.prototype.createChildren=function(){var t=this;if(e.prototype.createChildren.call(this),this._waitArm=new egret.MovieClip,this._waitArm.movieClipData=MovieManager.GetMovieClipData("wait_json","wait_png","wait"),this.addChild(this._waitArm),this._waitArm.play(-1),this._waitArm.x=320,this._waitArm.y=568,this._isCreated=!0,0==this._waitWenBenSet.length){var i=RES.getRes("loadingtip_json");Object.keys(i).map(function(e){t._waitWenBenSet.push(i[e])}),this._waitTime=0,this._waitDianTime=0,this._dianNum=0,this.RandXianShiWenBen(),this.judgeDianNum()}ProcessManager.AddProcess(this._Process.bind(this))},t.prototype._UpdataText=function(){StringMgr.LanguageSuffix;StringMgr.Language==StringMgr.CN?(this._cnImage.visible=!0,this._enImage.visible=!1,this._dianIma1.x=528,this._dianIma2.x=551,this._dianIma3.x=574):(this._cnImage.visible=!1,this._enImage.visible=!0,this._dianIma1.x=376,this._dianIma2.x=399,this._dianIma3.x=422)},t.prototype.Show=function(e){void 0===e&&(e=null),this._function=e,this.IsVisibled=!0},Object.defineProperty(t.prototype,"IsVisibled",{get:function(){return this._isVisibled},set:function(e){this._isVisibled!=e&&(this._isVisibled=e,e?(null!=this._waitArm&&this._waitArm.play(-1),this._isCreated&&(this._waitTime=0,this._waitDianTime=0,this._dianNum=0,this.RandXianShiWenBen(),this.judgeDianNum()),Main.Instance&&Main.Instance.TopLayer.addChild(this)):(this._waitArm&&this._waitArm.stop(),this.parent&&Main.Instance.TopLayer.removeChild(this),null!=this._function&&this._function(),this._function=null))},enumerable:!0,configurable:!0}),t.prototype.RandXianShiWenBen=function(){for(var e=[],t=0,i=0;2>i;i++){do t=Math.random()*this._waitWenBenSet.length|0;while(-1!=e.indexOf(t));e.push(t),0==i?this._waitTipLabel1.text=StringMgr.GetText(this._waitWenBenSet[e[i]].desc):1==i&&(this._waitTipLabel2.text=StringMgr.GetText(this._waitWenBenSet[e[i]].desc))}},t.prototype._Process=function(e){this.IsVisibled&&(this._waitTime+=e,this._waitDianTime+=e,this._waitTime>=5e3&&(this._waitTime-=5e3,this.RandXianShiWenBen()),this._waitDianTime>=1e3&&(this._waitDianTime-=1e3,this._dianNum+=1,this.judgeDianNum()))},t.prototype.judgeDianNum=function(){var e=this._dianNum%3;this._dianIma1.visible=!0,this._dianIma2.visible=e>=1,this._dianIma3.visible=e>=2},t}(AWindow);__reflect(WaitPage.prototype,"WaitPage");var ResReadyMgr=function(){function e(){}return e.IsReady=function(t,i){if(e.s_resReadys[t])return e.s_resReadys[t].IsReady();var n=new ResReady;return e.s_resReadys[t]=n,i?n.SetGroupName(t,e.s_priority):n.SetGroupName(t,++e.s_priority),n.IsReady()},e.ResetLoadPriority=function(t){e.s_priority=t},e.LoadGroup=function(){for(var t=0;t<e._groupSet.length;t++)if(!e.IsReady(e._groupSet[t]))return},e.GroupLoadEnd=function(e){switch(e){case"startsound":Game.GameStatus||SoundManager.PlayBackgroundMusic();break;case"checkpointwindow":WindowManager.StarWindow().creatCheckPoint();break;case"startrole":WindowManager.StarWindow().creatCheckPoint();break;case"jixiaode":case"xiaomei":case"alian":case"fatiao":case"gulaobang":case"huihui":case"shasha":case"xiaoying":case"mingrn":case"zuozhu":case"yujie":ArmaturePool.InitRole(e),null!=WindowManager.RoleSelectWindow(!1)&&WindowManager.RoleSelectWindow().ResLoadEnd()}},e}();ResReadyMgr.s_resReadys={},ResReadyMgr.s_priority=10,ResReadyMgr._groupSet=["startrole","checkpointwindow","startsound","itemres","game","prompt","jixiaode","xiaomei","alian","fatiao","gulaobang","huihui","shasha","yujie","xiaoying","mingrn","zuozhu"],__reflect(ResReadyMgr.prototype,"ResReadyMgr");var ResReady=function(){function e(){this.m_resGroupName="",this.m_bReady=!1,this.m_maxRetryTime=3,this.m_nowRetryTime=0}return e.prototype.SetGroupName=function(e,t){this.m_resGroupName=e,this.m_priority=t,RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.loadGroup(e,t)},e.prototype.GetGroupName=function(){return this.m_resGroupName},e.prototype.IsReady=function(){return this.m_bReady},e.prototype.onResourceLoadError=function(e){e.groupName==this.GetGroupName()&&(console.warn("Group:"+e.groupName+" has failed to load"),++this.m_nowRetryTime<this.m_maxRetryTime?RES.loadGroup(e.groupName):this.onResourceLoadComplete(e))
},e.prototype.onResourceLoadComplete=function(e){e.groupName==this.GetGroupName()&&(this.m_bReady=!0,RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResProgress,this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),(null==Game.Instance||null!=Game.Instance&&null==Game.Instance.parent)&&ResReadyMgr.LoadGroup(),ResReadyMgr.GroupLoadEnd(e.groupName),WindowManager.ResLoadEnd())},e.prototype.onResProgress=function(e){},e}();__reflect(ResReady.prototype,"ResReady");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function a(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Achievement=function(){function e(e){this._completeTime="",this._curCon=0,this._status=0,this._time=0,this._priority=0,this._id=e.id,this._name=e.name,this._res=e.res,this._achType=e.sharetype,this._achValue=e.sharevalue,this._desc=e.desc,this._rarity=e.rarity,this._priority=parseInt(e.priority),this.rewardStr=e.rewardtype,this._ParseReward(this.rewardStr);var t=e.condition,i=t.split(",");1==i.length?(this._conditionType="",this._condition=parseInt(i[0])):2==i.length&&(this._conditionType=i[0],this._condition=parseInt(i[1]))}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return StringMgr.GetText(this._name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImageRes",{get:function(){return this._res},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Description",{get:function(){return StringMgr.GetText(this._desc)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rarity",{get:function(){return this._rarity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Time",{set:function(e){this._time=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CompleteTime",{get:function(){if(!this.IsCompleted)return"";if(""==this._completeTime){var e=new Date(1e3*this._time);this._completeTime+=e.getFullYear()+".",this._completeTime+=e.getMonth()+1+".",this._completeTime+=e.getDate()}return this._completeTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsCompleted",{get:function(){return 0!=this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Condition",{get:function(){return this._condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurCondition",{set:function(e){this._curCon=e,(this.IsCompleted||this._curCon>this._condition)&&(this._curCon=this._condition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Status",{get:function(){return this._status},set:function(e){this._status=e},enumerable:!0,configurable:!0}),e.prototype._ParseReward=function(e){var t=e.split(","),i=t[0];switch(i){case"M":this._rewardImageRes="fenxiang_jinbi_png",this._rewardNum=parseInt(t[1]),this._rewardDesc=StringMgr.GetText("rewardtext1")+"*"+this._rewardNum;break;case"D":this._rewardImageRes="fenxiang_jifen_png",this._rewardNum=parseInt(t[1]),this._rewardDesc=StringMgr.GetText("rewardtext2")+"*"+this._rewardNum;break;case"I":case"C":var n=parseInt(t[1]);this._rewardNum=parseInt(t[2]);var a=ItemManager.GetItemByID(n);null!=a&&(this._rewardImageRes=a.ImageRes,this._rewardDesc=a.TypeDesc+":"+a.Name+"*"+this._rewardNum);break;case"scene":case"road":var n=parseInt(t[1]);this._rewardNum=parseInt(t[2]);var a=ItemManager.GetItemByID(n);null!=a&&(this._rewardImageRes=a.ImageRes,this._rewardDesc=a.TypeDesc+":"+a.Name)}},Object.defineProperty(e.prototype,"RewardImageRes",{get:function(){return this._rewardImageRes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RewardDesc",{get:function(){return this._ParseReward(this.rewardStr),this._rewardDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConditionDesc",{get:function(){null==e.AchTypeData&&(e.AchTypeData=RES.getRes("achievetype_json"));var t=e.AchTypeData[this._achType];if(null!=t){var i=StringMgr.GetText(t.desc);i=i.replace("&data",this._condition.toString());var n=this._achValue.split(","),a=null,r=null;1==n.length?(a=UnitManager.GetRole(parseInt(n[0])),r=ItemManager.GetItemByID(parseInt(n[0]))):2==n.length&&(a=UnitManager.GetRole(parseInt(n[1])),r=ItemManager.GetItemByID(parseInt(n[1]))),i=i.replace("&role",null==a?"":a.Name),i=i.replace("&sence",null==r?"":r.Name),i=i.replace("&road",null==r?"":r.Name);var o=null,s=null;return""!=this._conditionType?"role"==this._conditionType?o=UnitManager.GetRole(this._condition):("I"==this._conditionType||"role"==this._conditionType||"scene"==this._conditionType)&&(s=ItemManager.GetItemByID(this._condition)):(o=UnitManager.GetRole(this._condition),s=ItemManager.GetItemByID(this._condition)),i=null!=o?i.replace("&name",o.Name):null!=s?i.replace("&name",s.Name):i.replace("&name",""),16!=this._achType&&17!=this._achType&&18!=this._achType&&25!=this._achType&&26!=this._achType&&27!=this._achType&&(i+=":"+this._curCon.toString()+"/"+this._condition.toString()),i}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShareContent",{get:function(){null==e.ShareData&&(e.ShareData=RES.getRes("sharetext_json")),null==e.AchTypeData&&(e.AchTypeData=RES.getRes("achievetype_json"));var t=e.AchTypeData[this._achType];if(null!=t){var i=t.textid,n=i.split(","),a=Math.floor(Math.random()*n.length),r=parseInt(n[a]),o=e.ShareData[r],s=StringMgr.GetText(o.desc);return null!=s&&(s=s.replace("&star",CheckpointManager.StarCount.toString()),s=s.replace("&chapter",CheckpointManager.MaxCheckpointID.toString())),[null==s?"":s,null==o.pic?"":o.pic]}return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Priority",{get:function(){return this._priority},enumerable:!0,configurable:!0}),e}();Achievement.RewardData=null,Achievement.AchTypeData=null,Achievement.ShareData=null,__reflect(Achievement.prototype,"Achievement");var AchievementManager=function(){function e(){}return e.Init=function(){var t=RES.getRes("achievedata_json");Object.keys(t).map(function(i){var n=t[i],a=parseInt(n.id);if(1==Math.floor(a/1e3)){var r=new Achievement(n);e._achSet.push(r)}}),e._achSet=e._achSet.sort(function(e,t){return e.Priority-t.Priority}),Achievement.AchTypeData=RES.getRes("achievetype_json"),e.GetAchievementData(),Facade.instance().watch(e._AchievementComplete,NetNumber.AchievementComplete),Facade.instance().watch(e._UpdateAchievement,NetNumber.AchievementUpdate)},e.GetAchievementData=function(){NetManager.SendRequest(["func="+NetNumber.AchievementList+"&typ=0&status=-1"],e._AchievementInfo.bind(e))},e._AchievementInfo=function(t){if(t.code==NetManager.SuccessCode){for(var i=t.data,n=0;n<i.length;n++){var a=i[n],r=a.id,o=a.status,s=a.time,u=a.value,l=e.GetAchievementByID(r);null!=l&&(l.Status=o,l.CurCondition=u,l.Time=s)}GameEvent.DispatchEvent(EventType.AchieveUpdata)}},e._AchievementComplete=function(t){var i=t.info.id;1055==i&&(ActiveManager.GuoQingValue=100);var n=e.GetAchievementByID(i);return null!=n&&(n.CurCondition=n.Condition,n.Status=1),Game.IsShowTopTip?null==WindowManager.AchievementTip()?void WindowManager.SetWindowFunction(e._ShowAchievementTip.bind(e),t):void e._ShowAchievementTip(t):void(e._lastCompleteID=i)},e._ShowAchievementTip=function(t){var i=t.info.id,n=e.GetAchievementByID(i);if(null!=n&&!WindowManager.AchievementTip().IsVisibled){n.CurCondition=n.Condition,n.Status=1;var a=StringMgr.GetText("achievementtext3");a=a.replace("&achievement",n.Name);var r=StringMgr.LanguageSuffix,o=n.ImageRes+"_jpg";null!=RES.getRes(n.ImageRes+r+"_png")&&(o=n.ImageRes+r+"_png"),WindowManager.AchievementTip().Show(o,a)}e._lastCompleteID=i},Object.defineProperty(e,"AchievementSet",{get:function(){return e._achSet},enumerable:!0,configurable:!0}),e.GetAchievementByID=function(t){for(var i=0;i<e._achSet.length;i++)if(e._achSet[i].ID==t)return e._achSet[i];return null},e.AchievementGetBonus=function(t){NetManager.SendRequest(["func="+NetNumber.AchGetBonus+"&id="+t],e._GetBonusReturn.bind(e))},e._UpdateAchievement=function(t){var i=parseInt(t.info.id),n=parseInt(t.info.data[0].num),a=e.GetAchievementByID(i);null!=a&&(a.CurCondition=n,GameEvent.DispatchEvent(EventType.AchieveUpdata)),1055==i&&(ActiveManager.GuoQingValue=n)},e._GetBonusReturn=function(e){if(e.code==NetManager.SuccessCode){var t=e.data,i=t.split(",");switch(i[0]){case"M":var n=parseInt(i[1]);PromptManager.CreatTopTip(StringMgr.GetText("achievementtext5")+n);break;case"item":case"role":case"scene":case"road":case"C":case"I":var a=parseInt(i[1]),n=parseInt(i[2]),r=ItemManager.GetXID(i[0],a);ItemManager.AddItem(r,n);var o=ItemManager.GetItemByID(r);null!=o&&PromptManager.CreatTopTip(StringMgr.GetText("achievementtext6")+o.Name+"x"+n,o.ImageRes)}GameEvent.DispatchEvent(EventType.AchieveUpdata)}},e.ShowLastCompleteAch=function(){return 0!=e._lastCompleteID?null==WindowManager.AchievementDetailPage()?void WindowManager.SetWindowFunction(e._ShowLastCompleteAch):void e._ShowLastCompleteAch():void 0},e._ShowLastCompleteAch=function(){var t=e.GetAchievementByID(e._lastCompleteID);null!=t&&WindowManager.AchievementDetailPage().ShowPage(t),e._lastCompleteID=0},e}();AchievementManager._achSet=[],AchievementManager._lastCompleteID=0,__reflect(AchievementManager.prototype,"AchievementManager");var ActiveManager=function(){function e(){}return e.Init=function(){NetManager.SendRequest(["func="+NetNumber.ActiveInfo+"&id=1055"],e._GuoQing)},e._ReceiveActiveBonus=function(t){var i=t.code;i==NetManager.SuccessCode&&null!=t.data&&null!=t.data.bonus&&(e._activeBonus=t.data.bonus,null!=e._activeBonus&&(null!=WindowManager.ActiveBonusWindow()?e._ShowActiveGift([StringMgr.GetText("guoqinguitext2"),e._activeBonus]):WindowManager.SetWindowFunction(e._ShowActiveGift,[StringMgr.GetText("guoqinguitext2"),e._activeBonus],WindowManager.ActiveBonusWindow)))},e._ShowActiveGift=function(e){WindowManager.ActiveBonusWindow().Show(e[0],e[1])},e.CheckBonus=function(){UnitStatusMgr.IsGetNinjaGift||NetManager.SendRequest(["func="+NetNumber.ActiveBonus+"&type=1"],e._ReceiveActiveBonus)},e._GuoQing=function(t){var i=t.code;if(i==NetManager.SuccessCode){var n=t.data;null==n?e._gqValue=0:null!=n.conditionMgr&&null!=n.conditionMgr.conList&&null!=n.conditionMgr.conList[38]&&(e._gqValue=n.conditionMgr.conList[38].value)}},Object.defineProperty(e,"GuoQingValue",{get:function(){return e._gqValue},set:function(t){e._gqValue=t},enumerable:!0,configurable:!0}),e}();ActiveManager._gqValue=0,__reflect(ActiveManager.prototype,"ActiveManager");var ArmaturePool=function(){function e(){}return e.Init=function(){if(e.IsInit)return Game._isInitArm=!0,void(Game._isInitArm&&Game._isInitMap&&Game._isStarReturn&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1));e.IsInit=!0;for(var t=0;t<e._resName.length;t++)for(var i=e._resName[t],n=0;n<i.count;n++){var a=e.GetMovieArmature(i.name+"_json",i.name+"_png",i.name);a[e.PoolName]=i.name+"_json",e.ReturnMoviePool(a)}Game._isInitArm=!0,Game._isInitArm&&Game._isInitMap&&Game._isStarReturn&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1)},e.InitRole=function(t){var i=UnitManager.GetRoleSet();Object.keys(i).map(function(n){if(i[n].ResGroupName==t)for(var a=i[n].Res,r=0;6>r;r++){var o=MovieManager.GetDragonBonesMovie(a+"_01_json",a+"_01texture_json",a+"_01texture_png",a+"_01"),s=MovieManager.GetDragonBonesMovie(a+"_02_json",a+"_02texture_json",a+"_02texture_png",a+"_02");o[e.PoolName]=a+"_01_json",s[e.PoolName]=a+"_02_json",e.ReturnPool(o),e.ReturnPool(s)}})},e.GetArmature=function(t,i,n,a){null==e._armSet[t]&&(e._armSet[t]=[]);var r=e._armSet[t];if(r.length>0){var o=r.shift();return MovieManager.ADDArmature(o),o}var s=MovieManager.GetDragonBonesMovie(t,i,n,a);return s[e.PoolName]=t,s},e.ReturnPool=function(t){if(null!=t){var i=t[e.PoolName];null==e._armSet[i]&&(e._armSet[i]=[]);var n=t.display;n.visible=!0,n.scaleX=1,n.scaleY=1,null!=n.parent&&n.parent.removeChild(n),MovieManager.RemoveArmature(t),e._armSet[i].push(t)}},e.GetMovieArmature=function(t,i,n){null==e._movSet[t]&&(e._movSet[t]=[]);var a=e._movSet[t];if(a.length>0){var r=a.shift();return r}var o=new egret.MovieClip;return o.movieClipData=MovieManager.GetMovieClipData(t,i,n),o[e.PoolName]=t,o},e.ReturnMoviePool=function(t){if(null!=t){var i=t[e.PoolName];null==e._movSet[i]&&(e._movSet[i]=[]),t.visible=!0,t.scaleX=1,t.scaleY=1,t.stop(),null!=t.parent&&t.parent.removeChild(t),e._movSet[i].push(t)}},e}();ArmaturePool.PoolName="PoolName",ArmaturePool.IsInit=!1,ArmaturePool._armSet=[],ArmaturePool._movSet=[],ArmaturePool._resName=[{name:"entrance01_idle",count:5},{name:"entrance01_open",count:5},{name:"entrance02_idle",count:5},{name:"entrance02_open",count:5},{name:"exit01_idle",count:15},{name:"exit01_open",count:15},{name:"exit02_idle",count:15},{name:"exit02_open",count:15},{name:"balloon",count:15},{name:"house",count:15},{name:"paperair1",count:5},{name:"paperair2",count:5},{name:"snowman",count:15},{name:"snowsmall",count:15},{name:"snow1",count:5},{name:"snow2",count:5},{name:"aircraft",count:15},{name:"building",count:15},{name:"house_qixi",count:15},{name:"xique_qix",count:15}],__reflect(ArmaturePool.prototype,"ArmaturePool");var Checkpoint=function(){function e(e){this._maxScore=0,this._isPass=!1,this._star=0,this._timer=0,this._luckyRate=0,this._randomRate=0,this._airRate=0,this._bombRate=0,this._consumePhy=0,this._sceneId=0,this._roadRes="k",this._id=e.id,this._name=e.name,this._passTime=e.time,this._difficulty=e.difficulty;var t=e.award,i=t.split(",");(3==i.length&&"I"==i[0]||"C"==i[0])&&(this._rewardItemID=parseInt(i[1]),this._rewardCount=parseInt(i[2])),this._baseScore=e.basescore,this._shouyilv=e.moneyplus,this._baseeffect=e.baseeffect,this._tipID=e.tipid,this._consumePhy=e.costap,this._isbubble=e.isbubble,this._sceneId=e.scene,this._roadRes=e.road;var n=e.randomeventrate;if(null!=n&&""!=n)for(var a=n.split(";"),r=0;r<a.length;r++)if(""!=a[r]){var o=a[r].split(",");if(null!=o&&2==o.length){var s=o[0],u=parseFloat(o[1])/100;switch(s){case"E1":this._airRate=u;break;case"E2":this._bombRate=u;break;case"E3":this._luckyRate=u;break;case"E4":this._randomRate=u}}}}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PassTime",{get:function(){return this._passTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Difficulty",{get:function(){return this._difficulty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Effect",{get:function(){return this._baseeffect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SceneId",{get:function(){return this._sceneId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RoadRes",{get:function(){return this._roadRes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LuckyRate",{get:function(){return this._luckyRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RandomRate",{get:function(){return this._randomRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AirRate",{get:function(){return this._airRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BombRate",{get:function(){return this._bombRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BaseScore",{get:function(){return this._baseScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShouYiLv",{get:function(){return this._shouyilv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxScore",{get:function(){return this._maxScore||0},set:function(e){this._maxScore=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConsumePhy",{get:function(){return this._consumePhy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RewardImage",{get:function(){var e=ItemManager.GetItemByID(this._rewardItemID);return null!=e?e.ImageRes:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RewardDes",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPass",{get:function(){return this._isPass},set:function(e){this._isPass||(this._isPass=e,GameEvent.DispatchEvent(EventType.CheckpointPass))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Star",{get:function(){return this._isPass?this._star:0},set:function(e){0>e&&(e=0),e>3&&(e=3),this._star=e,GameEvent.DispatchEvent(EventType.CheckpointStarUpdata)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanChallenge",{get:function(){if(1==this._id)return!0;var e=CheckpointManager.GetCheckpointByID(this._id-1);return e.IsPass?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TipID",{get:function(){return this._tipID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Isbubble",{get:function(){return 1==this._isbubble?!0:!1},enumerable:!0,configurable:!0}),e}();__reflect(Checkpoint.prototype,"Checkpoint");var CheckpointManager=function(){function e(){}return e.Init=function(){var t=RES.getRes("chapterdata_json");Object.keys(t).map(function(i){var n=t[i],a=new Checkpoint(n);e._checkpointSet.push(a)}),NetManager.SendRequest(["func="+NetNumber.CheckpointList],function(t){if(t.code==NetManager.SuccessCode){var i=t.data.battle,n=i.state;e.BattleStatus=n,e.RaidCheckpointID=2==n||3==n?i.id:0,e.RaidTime=2==n?i.time:0;var a=t.data.list,r=1;t.data.hisGateNo&&(r=t.data.hisGateNo);for(var o=0;o<a.length;o++){var s=a[o],u=parseInt(s.id),l=s.score,h=s.star,n=s.state;s.time;u>=r&&(h=0);var c=e.GetCheckpointByID(u);null!=c&&(c.MaxScore=l,c.Star=h,c.IsPass=h>0)}e._isRevice=!0,GameEvent.DispatchEvent(EventType.UserStatusChange)}}),ProcessManager.AddProcess(e._Process)},e.GetCheckpointByID=function(t){for(var i=0;i<e._checkpointSet.length;i++)if(e._checkpointSet[i].ID==t)return e._checkpointSet[i];return null},Object.defineProperty(e,"IsEndless",{get:function(){return e._currentCheckpointID==e.EndlessCheckpointID},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsDailyActive",{get:function(){return e._currentCheckpointID==e.DailyActiveActiveCheckpointID},enumerable:!0,configurable:!0}),e.GetCheckpointSet=function(){return e._checkpointSet},Object.defineProperty(e,"CurrentCheckpoint",{get:function(){return e.IsEndless?null:e.GetCheckpointByID(e._currentCheckpointID)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CurrentCheckpointID",{get:function(){return e._currentCheckpointID},set:function(t){e._currentCheckpointID=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BattleStatus",{get:function(){return e._battleStats},set:function(t){t!=e._battleStats&&(e._battleStats=t,2==t&&(e._timer=0))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RaidTime",{get:function(){return e._raidTime},set:function(t){0>t&&(t=0),e._raidTime!=t&&(e._raidTime=t,GameEvent.DispatchEvent(EventType.CheckpointRaidTimeUpdate))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StarCount",{get:function(){for(var t=0,i=0;i<e._checkpointSet.length&&e._checkpointSet[i].IsPass;i++)t+=e._checkpointSet[i].Star;return t},enumerable:!0,configurable:!0}),e.PassCheckpoint=function(e){GameEvent.DispatchEvent(EventType.UserStatusChange)},Object.defineProperty(e,"MaxCheckpointID",{get:function(){for(var t=1,i=0;i<e._checkpointSet.length&&e._checkpointSet[i].IsPass;i++)t=e._checkpointSet[i].ID;return t},enumerable:!0,configurable:!0}),e._Process=function(t){if(0!=e.RaidTime){e._timer+=t;var i=1e3;e._timer>=i&&(e._timer-=i,e.RaidTime-=1)}},Object.defineProperty(e,"IsCatch",{get:function(){return e._isCatch},set:function(t){e._isCatch=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsRunaway",{get:function(){return e._isRunaway},set:function(t){e._isRunaway=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChooseCheckPointId",{get:function(){return e._chooseCheckPointId},set:function(t){e._chooseCheckPointId=t,GameEvent.DispatchEvent(EventType.ChooseCheckPonit)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsRevice",{get:function(){return e._isRevice},enumerable:!0,configurable:!0}),e}();CheckpointManager.EndlessCheckpointID=10001,CheckpointManager.DailyActiveActiveCheckpointID=20001,CheckpointManager.RaidCheckpointID=0,CheckpointManager._checkpointSet=[],CheckpointManager._currentCheckpointID=0,CheckpointManager._raidTime=0,CheckpointManager._battleStats=0,CheckpointManager._timer=0,CheckpointManager._isCatch=!1,CheckpointManager._isRunaway=!1,CheckpointManager._chooseCheckPointId=-1,CheckpointManager._isRevice=!1,__reflect(CheckpointManager.prototype,"CheckpointManager");var EventType=function(){function e(){}return Object.defineProperty(e,"MoneyChange",{get:function(){return"moneyChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PingGaiChange",{get:function(){return"pingGaiChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AchieveUpdata",{get:function(){return"achieveUpata"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleLifeChange",{get:function(){return"roleLifeChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameScoreChange",{get:function(){return"gameScroeChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameMoneyChange",{get:function(){return"gameMoneyChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PlayerHeadChange",{get:function(){return"playerHeadChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PhysicalTimeChange",{get:function(){return"physicalTimeChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PhysicalChange",{get:function(){return"physicalChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxPhysicalChange",{get:function(){return"maxPhysicalChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameTimeChange",{get:function(){return"gameTimeChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameEnd",{get:function(){return"gameEnd"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointPass",{get:function(){return"checkpointPass"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleUpLevel",{get:function(){return"roleUpLevel"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameStart",{get:function(){return"gameStart"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointRaidTimeUpdate",{get:function(){return"checkpointRaidTimeUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FriendUpData",{get:function(){return"friendUpData"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShouHello",{get:function(){return"shouHello"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FriendChangState",{get:function(){return"friendChangState"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleLifeEmpty",{get:function(){return"roleLifeEmpty"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleRevive",{get:function(){return"roleRevive"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CheckpointStarUpdata",{get:function(){return"checkPointStarUpdata"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReviveItemUpdate",{get:function(){return"reviveItemUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleSuiPianItemUpdate",{get:function(){return"roleSuiPianItemUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VIPTimeUpdate",{get:function(){return"vipTimeUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityExchangeState",{get:function(){return"ActivityExchangeState"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ActivityScore",{get:function(){return"ActivityScore"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UseItem",{get:function(){return"useItem"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoticeUpData",{get:function(){return"noticeUpData"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UserStatusChange",{get:function(){return"userStatusChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveInfoChange",{get:function(){return"slaveInfoChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoticeUpDataResIma",{get:function(){return"noticeUpDataResIma"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveTimesUpdate",{get:function(){return"slaveTimesUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveHDTimesUpdate",{get:function(){return"slaveHDTimesUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveItemUpdate",{get:function(){return"slaveItemUpdate"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveTimeChange",{get:function(){return"slaveTimeChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveHDCDChange",{get:function(){return"SlaveHDCDChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VIPRewardTimesChange",{get:function(){return"vipRewardTimesChange"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DailyAcitveStateUpData",{get:function(){return"dailyAcitveStateUpData"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleSkillUpLevel",{get:function(){return"roleSkillUpLevel"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChooseCheckPonit",{get:function(){return"chooseCheckPonit"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StartCheckPassAni",{get:function(){return"startCheckPassAni"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LanguageChange",{get:function(){return"languagechange"},enumerable:!0,configurable:!0}),e}();__reflect(EventType.prototype,"EventType");var GameEvent=function(){function e(){}return e.AddEventListener=function(t,i,n){e._eventDis.addEventListener(t,i,n)},e.RemoveEventListener=function(t,i,n){e._eventDis.removeEventListener(t,i,n)},e.DispatchEvent=function(t,i){void 0===i&&(i=null),egret.Event.dispatchEvent(e._eventDis,t,!1,i)},e}();GameEvent._eventDis=new egret.DisplayObject,__reflect(GameEvent.prototype,"GameEvent");var FBSDKMgr=function(){function e(){}return e.Init=function(){Main.IsLocationDebug},e.PopPayTips=function(e){Main.IsLocationDebug||PopPayTips(e)},e.Share=function(t,i,n,a){return void 0===t&&(t=""),void 0===i&&(i=""),void 0===n&&(n=0),void 0===a&&(a=null),e._Share(t,i,"",n,a)},e._Share=function(t,i,n,a,r){void 0===a&&(a=0),e._shareCallback=r;var o=JSON.parse("{}");return o.title=StringMgr.GetText("sharetext3"),o.desc=""!=t?t:StringMgr.GetText("sharetext4"),o.share_type=a,o.share_url="window.OPEN_DATA && window.OPEN_DATA.shareurl || window.location.href",o.image_url=""!=i?i:"https://res.cdn.173kw.com/jxd/100px.png",o.back=!0,o.desc},e._OnShareReturn=function(t){Main.IsLocationDebug||("0"==t.retCode?null!=e._shareCallback&&e._shareCallback():PromptManager.CreatCenterTip(!1,!0,"分享失败"),e._shareCallback=null,WindowManager.WaitPage().IsVisibled&&ResReadyMgr.IsReady("prompt"))},e.ReportRegister=function(){Main.IsLocationDebug||ReportRegister()},e.ReportLogin=function(){Main.IsLocationDebug||ReportLogin()},e.SetPaySuccess=function(e){Main.IsLocationDebug||SetPaySuccess(e)},e.SetPayError=function(e){Main.IsLocationDebug||SetPayError(e)},e.SetPayClose=function(e){Main.IsLocationDebug||SetPayClose(e)},e.GetPF=function(){return Main.IsLocationDebug?"wanba_ts":GetPF()},e.GetPlatform=function(){return Main.IsLocationDebug?2:GetPlatform()},Object.defineProperty(e,"AppInBackground",{get:function(){return Main.IsLocationDebug?!1:!1},enumerable:!0,configurable:!0}),e.FormatTime=function(e){var t="";0>e&&(e=0);var i=Math.floor(e/3600),n=Math.floor(e%3600/60),a=e%60|0,r=10>i?"0"+i.toString():i.toString(),o=10>n?"0"+n.toString():n.toString(),s=10>a?"0"+a.toString():a.toString();return t=r+":"+o+":"+s},e.HtmlParser=function(t){return null==e._htmlParser&&(e._htmlParser=new egret.HtmlTextParser),e._htmlParser.parse(t)},e.Login=function(){return Main.IsLocationDebug?void LoginMgr.Login():void 0},e._LoginReturn=function(t){var i=t,n=i.code;if(n!=NetManager.SuccessCode)return Main.AddDebug("登入腾讯出错，code="+n),void e.Login();var a=i.data.openid,r=i.data.openkey;e._openid=a,e._openkey=r,LoginMgr.Login()},Object.defineProperty(e,"BanBenNum",{get:function(){return e._banbenNum},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpenID",{get:function(){return Main.IsLocationDebug?"118935915563834":e._openid},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpenKey",{get:function(){return Main.IsLocationDebug?"EAAEbE7cMEpABAJJbg18ocHCiXJASIZCYQ71vNcoUnjeGAL9sfN047jna6XxEJPOhqx8BDXeq00a0KcttAJx45WC8LqaVZBB8zuxbJBPgZA6TnB2bT5fGwbFRbIcqQmYOGqkBtuufpSGjk3AgKMeZBVQNEMtOUg0oOjk1y6ZA6nYs4kNUdP6fizqzDQQXpbJZBm0LXzZCXK4GkP3Mx16ZAfUMpBAPURvWvGEGuCKbxuQjBn94IXfdTkDd":e._openkey},enumerable:!0,configurable:!0}),e.GetOpenid=function(){return Main.IsLocationDebug?"118935915563834":GetOpenid()},e.GetOpenkey=function(){return Main.IsLocationDebug?"EAAEbE7cMEpABAJJbg18ocHCiXJASIZCYQ71vNcoUnjeGAL9sfN047jna6XxEJPOhqx8BDXeq00a0KcttAJx45WC8LqaVZBB8zuxbJBPgZA6TnB2bT5fGwbFRbIcqQmYOGqkBtuufpSGjk3AgKMeZBVQNEMtOUg0oOjk1y6ZA6nYs4kNUdP6fizqzDQQXpbJZBm0LXzZCXK4GkP3Mx16ZAfUMpBAPURvWvGEGuCKbxuQjBn94IXfdTkDd":GetOpenkey()},e}();FBSDKMgr._shareCallback=null,FBSDKMgr._banbenNum="",__reflect(FBSDKMgr.prototype,"FBSDKMgr");var FilterManage=function(){function e(){}return Object.defineProperty(e,"HuiDu",{get:function(){var e=[.33,.33,.33,0,0,.33,.33,.33,0,0,.33,.33,.33,0,0,0,0,0,1,0],t=new egret.ColorMatrixFilter(e);return t},enumerable:!0,configurable:!0}),e.AddMiaoBian=function(e,t){void 0===e&&(e=0),void 0===t&&(t=16777215);var i=new egret.GlowFilter(t,1,e,e,10,1,!1,!1);return i},e}();__reflect(FilterManage.prototype,"FilterManage");var FrequencyManager=function(){function e(){}return e.UpdateShareTime=function(t){e._isInit||ProcessManager.AddProcess(e._Process.bind(ProcessManager)),e._isInit=!0;var i=t.info,n=i.max,a=i.num,r=i.extNum,o=i.time;Object.keys(n).map(function(t){var i=parseInt(t);null==e._frequencySet[i]&&(e._frequencySet[i]=new Frequency(i));var a=e._frequencySet[i];a.MaxValue=n[t].num,a.MaxCD=n[t].cd}),Object.keys(a).map(function(t){var i=parseInt(t);null==e._frequencySet[i]&&(e._frequencySet[i]=new Frequency(i));var n=e._frequencySet[i];n.Value=a[t]}),Object.keys(r).map(function(t){var i=parseInt(t);null==e._frequencySet[i]&&(e._frequencySet[i]=new Frequency(i));var n=e._frequencySet[i];n.ExtValue=r[t]}),Object.keys(o).map(function(t){var i=parseInt(t);null==e._frequencySet[i]&&(e._frequencySet[i]=new Frequency(i));var n=e._frequencySet[i];n.CD=o[t]}),null!=Main.Instance&&Main.Instance.IsResourceLoadEnd&&WindowManager.WaitPage().IsVisibled&&(WindowManager.WaitPage().IsVisibled=!1),GameEvent.DispatchEvent(EventType.UserStatusChange)},e.GetFrequency=function(t){return e._frequencySet[t]},e.AddShareTime=function(t){WindowManager.WaitPage().IsVisibled=!0,NetManager.SendRequest(["func="+NetNumber.SendHello,"&actionType="+NetNumber.BuyTimes,"&act="+t],e._BuyTimeReturn)},e._BuyTimeReturn=function(e){},e._Process=function(t){e._timer+=t;var i=1e3;if(e._timer>=i){e._timer-=i;var n=!1;Object.keys(e._frequencySet).map(function(t){var i=e._frequencySet[t];i.CD>0&&(i.CD-=1,(10==i.Type||8==i.Type)&&(n=!0))}),n&&GameEvent.DispatchEvent(EventType.SlaveHDCDChange)}},e}();FrequencyManager._isInit=!1,FrequencyManager._frequencySet=[],FrequencyManager._timer=0,__reflect(FrequencyManager.prototype,"FrequencyManager");var Frequency=function(){function e(e){this._type=0,this._maxValue=0,this._value=0,this._extValue=0,this._maxCD=0,this._cd=0,this._type=e
}return Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxValue",{get:function(){return this._maxValue},set:function(e){this._maxValue!=e&&(this._maxValue=e,(5==this._type||6==this._type)&&GameEvent.DispatchEvent(EventType.SlaveTimesUpdate),(10==this._type||12==this._type||7==this._type||8==this._type||9==this._type)&&GameEvent.DispatchEvent(EventType.SlaveHDTimesUpdate),21==this._type&&GameEvent.DispatchEvent(EventType.VIPRewardTimesChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Value",{get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,(5==this._type||6==this._type)&&GameEvent.DispatchEvent(EventType.SlaveTimesUpdate),(10==this._type||12==this._type||7==this._type||8==this._type||9==this._type)&&GameEvent.DispatchEvent(EventType.SlaveHDTimesUpdate),21==this._type&&GameEvent.DispatchEvent(EventType.VIPRewardTimesChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExtValue",{get:function(){return this._extValue},set:function(e){this._extValue!=e&&(this._extValue=e,(5==this._type||6==this._type)&&GameEvent.DispatchEvent(EventType.SlaveTimesUpdate),(10==this._type||12==this._type||7==this._type||8==this._type||9==this._type)&&GameEvent.DispatchEvent(EventType.SlaveHDTimesUpdate),21==this._type&&GameEvent.DispatchEvent(EventType.VIPRewardTimesChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxCD",{get:function(){return this._maxCD},set:function(e){e!=this._maxCD&&(this._maxCD=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CD",{get:function(){return this._cd},set:function(e){this._cd!=e&&(this._cd=e)},enumerable:!0,configurable:!0}),e}();__reflect(Frequency.prototype,"Frequency");var Friend=function(){function e(e){this._openId=null==e.openid?"":e.openid,this._uId=null==e.uid?0:e.uid,this._maxScore=null==e.score?0:e.score,this._iconRes=null==e.icon?"":e.icon,this._name=null==e.name?"":decodeURIComponent(e.name),this._curRoleId=null==e.o?1001:e.o,this._curState=null==e.status?0:e.status,this._qinmiNum=null==e.h?0:e.h,this._shouZan=null==e.r?0:e.r,this._senZan=null==e.s?0:e.s,this._checkpointID=null==e.hisGateNo?1:e.hisGateNo}return Object.defineProperty(e.prototype,"UID",{get:function(){return this._uId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OpenID",{get:function(){return this._openId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IconRes",{get:function(){return this._iconRes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxScore",{get:function(){return this._maxScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurRoleId",{get:function(){return this._curRoleId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"QinMiNum",{get:function(){return this._qinmiNum},set:function(e){this._qinmiNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurState",{get:function(){return this._curState},set:function(e){this._curState=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOnline",{get:function(){return 64==(64&this._curState)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsGaming",{get:function(){return 128==(128&this._curState)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShouZan",{get:function(){return this._shouZan},set:function(e){this._shouZan=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SendZan",{get:function(){return this._senZan},set:function(e){this._senZan=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMaster",{get:function(){return 512==(512&this._curState)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSlave",{get:function(){return 256==(256&this._curState)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFreed",{get:function(){return!this.IsMaster&&!this.IsSlave},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CheckpointID",{get:function(){return Math.max(this._checkpointID-1,1)},enumerable:!0,configurable:!0}),e.prototype.SetValue=function(e,t){void 0===t&&(t=!0),t?this._curState=this._curState|e:this._curState=this._curState&~e},e}();__reflect(Friend.prototype,"Friend");var FriendManager=function(){function e(){}return e.Init=function(){},e.FriendInfo=function(t){if(null!=t.info)for(var i=0;i<t.info.length;i++){var n=t.info[i];if(n){var a=new Friend(n);null==e.GetFriendByID(n.openid)?e._AddFriend(a):e.updataFrien=a}}e.AddJiQiFriend(),GameEvent.DispatchEvent(EventType.FriendUpData)},e.AddJiQiFriend=function(){if(e.AllFrienSet.length<8){var t={openid:"-1",h:0,icon:"",name:"鸡小萌",o:1002,r:0,s:1,score:1e7,sid:"2",status:1,uid:-1};if(null==e.JiQiFriend){var i=new Friend(t);e.JiQiFriend=i}}else e.JiQiFriend=null},e.ShouHello=function(t){for(var i=0;i<e.AllFrienSet.length;i++)if(e.AllFrienSet[i].OpenID==t.info.src)return e.AllFrienSet[i].ShouZan+=1,void GameEvent.DispatchEvent(EventType.ShouHello)},e.UpDataFriendState=function(t){for(var i=0;i<e.AllFrienSet.length;i++)if(e.AllFrienSet[i].OpenID==t.info.id)return e.AllFrienSet[i].CurState=t.info.value,void GameEvent.DispatchEvent(EventType.FriendChangState)},e._AddFriend=function(t){e._friendSet.push(t)},Object.defineProperty(e,"AllFrienSet",{get:function(){return e._friendSet},enumerable:!0,configurable:!0}),e.GetFriendByID=function(t){for(var i=0;i<e._friendSet.length;i++)if(e._friendSet[i].OpenID==t)return e._friendSet[i];return null},Object.defineProperty(e,"updataFrien",{set:function(t){for(var i=0;i<e._friendSet.length;i++)e._friendSet[i].OpenID==t.OpenID&&(e._friendSet[i]=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"JiQiFriend",{get:function(){return e._jiqiFriend},set:function(t){e._jiqiFriend=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CatchList",{get:function(){for(var t=[],i=[],n=[],a=0;a<e._friendSet.length;a++){var r=e._friendSet[a];r.IsSlave?i.push(r):n.push(r)}return t=n.concat(i)},enumerable:!0,configurable:!0}),e}();FriendManager._friendSet=[],__reflect(FriendManager.prototype,"FriendManager");var GameConstData=function(){function e(){}return Object.defineProperty(e,"_JsonData",{get:function(){return null==e._data&&(e._data=RES.getRes("constdata_json")),e._data},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HopeDefense",{get:function(){var t=e._JsonData.hopeDefense;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"InjuryFreeRate",{get:function(){var t=e._JsonData.injuryFreeRate;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HopeLucky",{get:function(){var t=e._JsonData.hopeLucky;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LuckyRate",{get:function(){var t=e._JsonData.luckyRate;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BuckleBlood",{get:function(){var t=e._JsonData.buckleBlood;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetRoleNum",{get:function(){var t=e._JsonData.getRoleNum;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DebrisConumRate",{get:function(){var t=e._JsonData.debrisConumRate;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SkillUnlockLev1",{get:function(){var t=e._JsonData.skillUnlockLev1;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SkillUnlockLev2",{get:function(){var t=e._JsonData.skillUnlockLev2;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SkillUnlockLev3",{get:function(){var t=e._JsonData.skillUnlockLev3;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RoleMaxLevel",{get:function(){var t=e._JsonData.maxLev;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShareTextCount",{get:function(){var t=e._JsonData.shareTextCount;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DieShareMaxTime",{get:function(){var t=e._JsonData.deadMaxShareTime;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PhyShareMaxTime",{get:function(){var t=e._JsonData.apMaxShareTime;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShareContent",{get:function(){var t=[],i=e.ShareTextCount,n=Math.ceil(Math.random()*i),a=RES.getRes("sharetext_json"),r=a[n.toString()];if(null!=r){var o=StringMgr.GetText(r.desc),s=r.pic;o=o.replace("&star",CheckpointManager.StarCount.toString()),o=o.replace("&chapter",CheckpointManager.MaxCheckpointID.toString()),t.push(o),t.push(s)}return t},enumerable:!0,configurable:!0}),e.GetShareContentByID=function(e){var t=[],i=RES.getRes("sharetext_json"),n=i[e.toString()];if(null!=n){var a=StringMgr.GetText(n.desc),r=n.pic;a=a.replace("&star",CheckpointManager.StarCount.toString()),a=a.replace("&chapter",CheckpointManager.MaxCheckpointID.toString()),t.push(a),t.push(r)}return t},Object.defineProperty(e,"SkillMoneyBase",{get:function(){var t=e._JsonData.skillMoneyBase;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnergySmall",{get:function(){var t=e._JsonData.energySmall;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnergyBig",{get:function(){var t=e._JsonData.energyBig;return null!=t?t.num:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EnergyTime",{get:function(){var t=e._JsonData.energyTime;return null!=t?t.num:0},enumerable:!0,configurable:!0}),e.GetValue=function(t){var i=e._JsonData[t];return null!=i?i.num:0},e.GetTestString=function(){var t=e._JsonData.aaaa;return null!=t?t.des:""},e}();__reflect(GameConstData.prototype,"GameConstData");var GuideManager=function(){function e(){}return e.Init=function(){Facade.instance().watch(e._Guide,NetNumber.Guide),Facade.instance().watch(e._GuideBonus,NetNumber.GuideBonus),NetManager.SendRequest(["func="+NetNumber.GuideInfo],e._GuideReturn.bind(e))},e._GuideReturn=function(t){var i=t;e._guideID=i,e._isStarGuide=0!=e._guideID||e._isStarGuide,e.GuideCheck()},e._Guide=function(t){var i=t.info.gid;e._guideID=i,e._isStarGuide=0!=e._guideID||e._isStarGuide,e.GuideCheck()},e._GuideBonus=function(e){null!=e&&PromptManager.ShowGit(e.info)},e.GuideFinish=function(t){void 0===t&&(t=0),(0==t||t==e._guideID)&&(NetManager.SendRequest(["func="+NetNumber.GuideFinish,"&gid="+e._guideID]),7==e._guideID&&(WindowManager.GuideWindow().IsVisibled=!1))},e.GuideCheck=function(){return 0},e.ShowGuideWindow=function(t,i,n,a,r,o){return void 0===o&&(o=""),null==WindowManager.GuideWindow()?void WindowManager.SetWindowFunction(e._OpenWindow,[t,i,n,a,r,o],WindowManager.GuideWindow):void e._OpenWindow([t,i,n,a,r,o])},e._OpenWindow=function(e){WindowManager.GuideWindow().Show(e[0],e[1],e[2],e[3],e[4],e[5])},Object.defineProperty(e,"IsGuide",{get:function(){return e._isGuide},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GuideID",{get:function(){return e._guideID},enumerable:!0,configurable:!0}),e}();GuideManager._isStarGuide=!1,GuideManager._isGuide=!1,__reflect(GuideManager.prototype,"GuideManager");var ImagePool=function(){function e(){}return e.GetImage=function(t){null==e._imaSet[t]&&(e._imaSet[t]=[]);var i=e._imaSet[t];if(null!=i&&i.length>0){var n=i.shift();return n}var a=new eui.Image(t);return a[e.PoolName]=t,a},e.ReturnPool=function(t){if(null!=t){t.visible=!0;var i=t[e.PoolName];null==e._imaSet[i]&&(e._imaSet[i]=[]),e._imaSet[i].push(t)}},e}();ImagePool.PoolName="PoolName",ImagePool._imaSet=[],__reflect(ImagePool.prototype,"ImagePool");var IntegralManager=function(){function e(){}return e._ReceiveActivityInfo=function(t){var i=t.code,n=t.data;i==NetManager.SuccessCode&&(n.act&&(e.GitState=n.act),e.ID=n.id,e.Type=n.type,e.State=n.state,n.score&&(e.Score=n.score),n.starttime&&(e.StartTime=n.starttime),n.endtime&&(e.EndTime=n.endtime),n.rank&&(e.RankNum=n.rank))},e.Init=function(){var t=RES.getRes("eventsdata_json");Object.keys(t).map(function(i){var n=t[i];n.id=i,e._IntegralTypeDataSet.push(n)});var i=RES.getRes("integralrewards_json");Object.keys(i).map(function(t){var n=i[t];e._IntegralExchangeDataSet.push(n)});var n=RES.getRes("integralrankrewards_json");Object.keys(n).map(function(t){var i=n[t];e._IntegralRankDataSet.push(i)})},e.UpDataScore=function(t){var i=t.info;e.Score=i},e.IntegralInformation=function(){for(var t=null,i=0;i<e._IntegralTypeDataSet.length;i++)e._IntegralTypeDataSet[i].id==e.Type&&(t=e._IntegralTypeDataSet[i]);return t},e.IntegralExchangeRewardsData=function(){for(var t=[],i=0;i<e._IntegralExchangeDataSet.length;i++)e._IntegralExchangeDataSet[i].eventid==e.Type&&t.push(e._IntegralExchangeDataSet[i]);return t},e.IntegralRankRewards=function(){for(var t=[],i=0;i<e._IntegralRankDataSet.length;i++)e._IntegralRankDataSet[i].eventid==e.Type&&t.push(e._IntegralRankDataSet[i]);return t},Object.defineProperty(e,"RankNum",{get:function(){return e._rankNum},set:function(t){e._rankNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ID",{get:function(){return e._id},set:function(t){e._id=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Type",{get:function(){return e._type},set:function(t){e._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"State",{get:function(){return e._state},set:function(t){e._state=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Score",{get:function(){return e._score},set:function(t){e._score=t,GameEvent.DispatchEvent(EventType.ActivityScore)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StartTime",{get:function(){return e._startTime},set:function(t){e._startTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EndTime",{get:function(){return e._endTime},set:function(t){e._endTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GitState",{get:function(){return e._gitState},set:function(t){e._gitState=t,GameEvent.DispatchEvent(EventType.ActivityExchangeState)},enumerable:!0,configurable:!0}),e.GitStateById=function(t,i){e._gitState[t]=i,GameEvent.DispatchEvent(EventType.ActivityExchangeState)},e}();IntegralManager._IntegralTypeDataSet=[],IntegralManager._IntegralRankDataSet=[],IntegralManager._IntegralExchangeDataSet=[],IntegralManager._state="",IntegralManager._score=0,IntegralManager._startTime="xxxx/xx/xx",IntegralManager._endTime="xxxx/xx/xx",IntegralManager._gitState=[],IntegralManager._rankNum=0,__reflect(IntegralManager.prototype,"IntegralManager");var Item=function(){function e(e){this._xid=e.xid,this._id=e.id,this._name=e.name,this._res=e.pic,this._type=e.type,this._desc=e.desc,this._price=e.price}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"XID",{get:function(){return this._xid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return StringMgr.GetText(this._name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImageRes",{get:function(){var e=StringMgr.LanguageSuffix;return RES.getRes(this._res+e+"_png")?this._res+e+"_png":this._res+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TypeDesc",{get:function(){var e="";switch(this._type){case"I":e=StringMgr.GetText("commontext2");break;case"M":e=StringMgr.GetText("commontext3");break;case"C":e=StringMgr.GetText("commontext4");break;case"scene":e=StringMgr.GetText("commontext5");break;case"road":e=StringMgr.GetText("commontext6")}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Desc",{get:function(){return StringMgr.GetText(this._desc)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Price",{get:function(){return this._price},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsDebris",{get:function(){return"C"==this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsItem",{get:function(){return"I"==this._type},enumerable:!0,configurable:!0}),e}();__reflect(Item.prototype,"Item");var ItemManager=function(){function e(){}return e.Init=function(){var t=RES.getRes("itemdata_json");Object.keys(t).map(function(i){var n=t[i];n.xid=i,e._itemSet.push(new Item(n))})},e.AddItem=function(t,i){null==e._itemCountSet[t]?e._itemCountSet[t]=i:e._itemCountSet[t]+=i,t==e.ReviveItemID&&GameEvent.DispatchEvent(EventType.ReviveItemUpdate),e.JudgeIsRoleSuiPian(t)&&GameEvent.DispatchEvent(EventType.RoleSuiPianItemUpdate)},e.JudgeIsRoleSuiPian=function(t){var i=e.GetItemByID(t);return null!=i?i.IsDebris:!1},e.SetItemCount=function(t,i){return null==e._itemCountSet[t]?void e.AddItem(t,i):(e._itemCountSet[t]=i,t==e.ReviveItemID&&GameEvent.DispatchEvent(EventType.ReviveItemUpdate),e.JudgeIsRoleSuiPian(t)&&GameEvent.DispatchEvent(EventType.RoleSuiPianItemUpdate),void((40401==t||40402==t||40403==t)&&GameEvent.DispatchEvent(EventType.SlaveItemUpdate)))},e.GetItemCount=function(t){return null==e._itemCountSet[t]?0:e._itemCountSet[t]},e.UseItem=function(t,i){if(null==e._itemCountSet[t])return!1;if(e._itemCountSet[t]>=i){if(e._itemCountSet[t]-=i,t==e.ReviveItemID&&GameEvent.DispatchEvent(EventType.ReviveItemUpdate),e.JudgeIsRoleSuiPian(t)&&GameEvent.DispatchEvent(EventType.RoleSuiPianItemUpdate),(401==t||402==t||403==t)&&GameEvent.DispatchEvent(EventType.SlaveItemUpdate),22==t){var n=StringMgr.GetText("itemusertext1");n=n.replace("&num",i.toString()),PromptManager.CreatTopTip(n)}return 23==t&&PromptManager.CreatTopTip(StringMgr.GetText("itemusertext3")),!0}return!1},e.GetItemByID=function(t){for(var i=0;i<e._itemSet.length;i++)if(e._itemSet[i].XID==t)return e._itemSet[i];return null},e.GetXID=function(e,t){switch(e){case"C":return 1e3+t;case"road":return 1e4+t;case"role":return 2e4+t;case"scene":return 3e4+t;case"I":return 4e4+t;case"box":return 5e4+t;case"D":return 1;case"M":return 2;case"A":return 9;case"V":return 20;default:return 0}},e.GetItemIDSet=function(){var t=[];return Object.keys(e._itemCountSet).map(function(i){var n=parseInt(i),a=e.GetItemByID(n),r=e.GetItemCount(n);null!=a&&r>0&&(a.IsItem||a.IsDebris)&&t.push(n)}),t},e}();ItemManager.ReviveItemID=40020,ItemManager._itemCountSet={},ItemManager._itemSet=[],__reflect(ItemManager.prototype,"ItemManager");var LoginMgr=function(){function e(){}return e.Login=function(t){void 0===t&&(t=null),e.$callback=t,Main.IsNeedNetDebug||(e.LoginSuccess=!0,UnitManager.CreatePlayer("1","测试",1e6,1e6,0,"","resource/res/common/anniu_off.png"),UnitManager.Player.VIPTime=2592e3,null!=Main.Instance&&Main.Instance.StartCreateScene());var i=JSON.parse(egret.localStorage.getItem("kyc"));Game.IsIos=!0;var n=i;n.domain="authgg.Chick",n.openid=i.openid,n.openkey=i.openkey,Facade.instance().watch(UnitManager.ReceivePhysical,NetNumber.ReceivePhysical),Facade.instance().watch(FriendManager.FriendInfo,NetNumber.FriendInfor.toString()),Facade.instance().watch(FriendManager.ShouHello,NetNumber.SendHelloNum.toString()),Facade.instance().watch(FriendManager.UpDataFriendState,NetNumber.FriendUserStatus.toString()),Facade.instance().watch(FrequencyManager.UpdateShareTime,NetNumber.ShareTimeUpdate),Facade.instance().watch(IntegralManager.UpDataScore,NetNumber.ActivityScore.toString()),Facade.instance().watch(UnitStatusMgr.UpdateStatus,NetNumber.UserStatusUpdate),Facade.instance().watch(UnitManager.ReveiceDailyActiveState,NetNumber.DailyActiveButtonVisible),Facade.instance().watch(RollingNoticeManager.ReceiveRollingNotice,NetNumber.RollingNotice),Facade.instance().watch(UnitManager.ReceiveBonus,NetNumber.ReceiveBonus),Facade.instance().watch(UnitManager.ReceiveBonus,NetNumber.ReceiveShareScenceBonus),SlaveManager.InitWatch();var a="control=lb&func=getServerInfo&oemInfo="+encodeURIComponent(JSON.stringify(n));console.log("lb",a),NetManager.SendRequest([a],e._LoginReturn)},e._LoginReturn=function(t){if(t.code!=NetManager.SuccessCode)return void(e._reLoginTime<3&&(setTimeout(function(){e.Login()},2e3),e._reLoginTime++));e.loginedIndexServer=!0;var i=t.data.ip,n=t.data.port;NetManager.ServerUrl=i,NetManager.ServerPort=n,Facade.instance().SocketInit(i,n)},e.RealLogin=function(t){if(void 0===t&&(t=!0),e.loginedIndexServer&&!e.loginedLogicServer){e.loginedLogicServer=!0,Game.IsIos=!0;var i=JSON.parse(egret.localStorage.getItem("kyc")),n=Math.floor((new Date).getTime()/1e3),a=0,r="",o=egret.localStorage.getItem(e.LocalOpenid);t?i.openid==o&&null!=egret.localStorage.getItem(e.LocalTokenKey)&&(a=parseInt(egret.localStorage.getItem(e.LocalTimeKey)),5400>n-a&&(r=egret.localStorage.getItem(e.LocalTokenKey))):r="";var s=i;s.domain="authgg.Chick",s.openid=i.openid,s.openkey=i.openkey,s.pubkey=i.pubkey,s.sig=i.sig,s.cid="xxxxxxxx-game-gold-root-xxxxxxxxxxxx",s.token=r;var u="func="+NetNumber.Logoin+"&oemInfo="+encodeURIComponent(JSON.stringify(s));console.log("login",u),NetManager.SendRequest([u],e._ReceiveInit);var l=new Date;e._time=l.getTime()}},e._ReceiveInit=function(t){new Date;if(t.code!=NetManager.SuccessCode)return Main.AddDebug("游服返回:"+t.code),void e.RealLogin(!1);e.LoginSuccess=!0;var i=t.data,n=i.openid,a=i.info.money;(null==a||0>a)&&Main.AddDebug("金钱数据异常：money="+a);var r=i.info.diamond;(null==r||0>r)&&Main.AddDebug("瓶盖数据异常：pinggai="+r);var o=i.info.score;(null==o||0>o)&&(Main.AddDebug("分数数据异常：maxScore="+o),o=0);var s=decodeURIComponent(i.name);s||Main.AddDebug("名字异常：name="+s);var u=i.token;u||Main.AddDebug("Token异常：token="+u);var l=i.time;(!l||0>l)&&Main.AddDebug("时间异常：time="+l);var h=i.item;h||Main.AddDebug("道具异常：itemData="+h);var c=i.info.status;null!=c&&(UnitStatusMgr.Status=c,UnitStatusMgr.IsNewPlay&&UnitStatusMgr.SetValue(16,!1)),Object.keys(h).map(function(e){ItemManager.SetItemCount(parseInt(e),h[e].num)});var _=i.info.role;_?UnitManager.ChangeRole(i.info.role):(Main.AddDebug("角色形象异常：roleID="+_),UnitManager.ChangeRole(21001));var d=i.info.headIcon;UnitManager.CreatePlayer(n,s,a,r,o,u,d),egret.localStorage.setItem(e.LocalTimeKey,l.toString()),egret.localStorage.setItem(e.LocalTokenKey,u),null!=Main.Instance&&Main.Instance.StartCreateScene(),e.$callback&&e.$callback(),NetManager.SendRequest(["func="+NetNumber.VIPCheck],e._VIPCom),NetManager.SendRequest(["func="+NetNumber.GetSlaveList]),NetManager.SendRequest(["func="+NetNumber.ActivityInfo],IntegralManager._ReceiveActivityInfo),NetManager.SendRequest(["func=getTime"],UnitManager.ReceiveFuwuduanTime),GuideManager.Init(),ActiveManager.Init()},e._VIPCom=function(e){if(e.code!=NetManager.SuccessCode)return void Main.AddDebug("VIP查询出错:"+e.code);var t=e.data.time;UnitManager.Player.VIPTime=t},e}();LoginMgr.LoginSuccess=!1,LoginMgr.LocalTimeKey="localtime",LoginMgr.LocalTokenKey="localtoken",LoginMgr.LocalOpenid="localopenid",LoginMgr.$callback=null,LoginMgr.loginedIndexServer=!1,LoginMgr.loginedLogicServer=!1,LoginMgr._reLoginTime=0,__reflect(LoginMgr.prototype,"LoginMgr");var MovieManager=function(){function e(){}return e.GetMovieClipData=function(t,i,n){null==e._movieDataFactorySet&&(e._movieDataFactorySet=[]);var a,r=RES.getRes(t),o=RES.getRes(i),s=t+i;a=e._movieDataFactorySet[s],null==a&&(a=new egret.MovieClipDataFactory(r,o),e._movieDataFactorySet[s]=a);var u=a.generateMovieClipData(n);return u},e.GetDragonBonesMovie=function(t,i,n,a){if(null==e._dragonBonesFactory&&(e._dragonBonesFactory=new dragonBones.EgretFactory),null==e._dragonMovieSet&&(e._dragonMovieSet=[]),null==e._dragonMovieSet[t]){var r=RES.getRes(t),o=RES.getRes(i),s=RES.getRes(n);null==r&&console.log("Data:"+t),null==o&&console.log("Texturejson:"+i),null==s&&console.log("Texture:"+n),e._dragonBonesFactory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(r)),e._dragonBonesFactory.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,o)),e._dragonMovieSet[t]="1"}var u=e._dragonBonesFactory.buildArmature(a);return e.ADDArmature(u),e._isTickerRegister||(egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(e/1e3)},this),e._isTickerRegister=!0),u},e.ADDArmature=function(e){null!=e&&dragonBones.WorldClock.clock.add(e)},e.RemoveArmature=function(e){null!=e&&dragonBones.WorldClock.clock.remove(e)},e}();MovieManager._isTickerRegister=!1,__reflect(MovieManager.prototype,"MovieManager");var NewPointManager=function(){function e(){}return e.friendRedPointIsVisible=function(){for(var e=0;e<FriendManager.AllFrienSet.length;e++)if(FriendManager.AllFrienSet[e].ShouZan>0)return!0;return!1},e.RoleRedPointIsVisible=function(){for(var e=0;e<UnitManager.GetRoleSet().length;e++)if(UnitManager.GetRoleSet()[e].IsHave){if(UnitManager.GetRoleSet()[e].Level<GameConstData.RoleMaxLevel&&UnitManager.GetRoleSet()[e].GetCurRoleNum>=UnitManager.GetRoleSet()[e].UpLevelDebrisNum)return!0;for(var t=UnitManager.GetRoleSet()[e].UseSkillSet,i=0;i<t.length;i++){var n=Math.ceil(GameConstData.SkillMoneyBase*Math.pow(t[i].Level,1.6));if(t[i].IsCanUp&&UnitManager.Player.Money>=n)return!0}}else if(UnitManager.GetRoleSet()[e].Level<GameConstData.RoleMaxLevel&&UnitManager.GetRoleSet()[e].GetCurRoleNum>=UnitManager.GetRoleSet()[e].GetRoleNum)return!0;return!1},e.AchiRedPointIsVisible=function(){for(var e=0;e<AchievementManager.AchievementSet.length;e++)if(1==AchievementManager.AchievementSet[e].Status)return!0;return!1},e.ActivityRedPointIsVisible=function(){var e=IntegralManager.IntegralExchangeRewardsData();if(e.length>0)for(var t=0;t<IntegralManager.GitState.length;t++)if(0==IntegralManager.GitState[t+1]&&IntegralManager.Score>=e[t].condition)return!0;return!1},e.ReceiveButtonIsVisible=function(){var e=IntegralManager.IntegralExchangeRewardsData();return e.length>0&&0==IntegralManager.GitState[0]&&0!=IntegralManager.RankNum?!0:!1},e.NoticeRedPointIsVisible=function(){var e=NoticeManager.AllNoticeSet;if(e.length>0)for(var t=0;t<e.length;t++)if(0==e[t].IsRead)return!0;return!1},Object.defineProperty(e,"SlaveRedIsVisible",{get:function(){if(CheckpointManager.MaxCheckpointID<5)return!1;if(SlaveManager.HasSpace)return!0;var e=SlaveManager.Level,t=0;if(UnitStatusMgr.IsMaster&&SlaveManager.SlaveList.length>0){var i=FrequencyManager.GetFrequency(10),n=FrequencyManager.GetFrequency(12),a=FrequencyManager.GetFrequency(7);if(null!=i&&(t=Math.floor(.25*i.MaxValue*e),i.CD<=0&&t+i.ExtValue-i.Value>0))return!0;if(null!=n&&(t=Math.floor(.25*n.MaxValue*e),t+n.ExtValue-n.Value>0&&ItemManager.GetItemCount(401)>0))return!0;if(null!=a&&(t=Math.floor(.25*a.MaxValue*e),t+a.ExtValue-a.Value>0&&ItemManager.GetItemCount(402)>0))return!0}if(UnitStatusMgr.IsSlave){var r=FrequencyManager.GetFrequency(9),o=FrequencyManager.GetFrequency(8);if(null!=o&&(t=Math.floor(.25*o.MaxValue*e),o.CD<=0&&t+o.ExtValue-o.Value>0))return!0;if(null!=r&&(t=Math.floor(.25*r.MaxValue*e),t+r.ExtValue-r.Value>0&&ItemManager.GetItemCount(403)>0))return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VIPRedIsVisible",{get:function(){if(!UnitManager.Player.IsVIP)return!0;var e=FrequencyManager.GetFrequency(21);return null!=e&&e.Value<e.MaxValue?!0:!1},enumerable:!0,configurable:!0}),e}();__reflect(NewPointManager.prototype,"NewPointManager");var Notice=function(){function e(e){this._isMySend=!1,this._bonus=[],this._rank=0,this._time=e.time,this._isRead=e.state,this._bonus=[];var t=null;t=e.content.constructor==String?JSON.parse(e.content):e.content,t.type&&(this._type=t.type),t.info&&(this._info=t.info),this._info&&(this._sendOpenId=this._info.src,this._reviceOpenId=this._info.dst,this._info.bonus&&(this._bonus=this._info.bonus),this._info.rank?this._rank=this._info.rank:this._rank=0)}return Object.defineProperty(e.prototype,"Des",{get:function(){if(4100==this.Type)if(1==this._rank)this._des=StringMgr.GetText("noticetext1");else if(2==this._rank)this._des=StringMgr.GetText("noticetext2");else if(3==this._rank)this._des=StringMgr.GetText("noticetext3");else if(this._rank>3&&this._rank<=100){var e=StringMgr.GetText("noticetext4");e=e.replace("&rank",this._rank.toString()),this._des=e}else this._des=StringMgr.GetText("noticetext6");else if(4104==this.Type){for(var t="",i=0;i<this.BonusRes.length;i++)"pinggai"==this.BonusRes[i].type&&(t=this.BonusRes[i].num);if(this._rank>0&&this._rank<=10){var e=StringMgr.GetText("noticetext7");e=e.replace("&rank",this._rank.toString()),e=e.replace("&token",t),this._des=e}else{var e=StringMgr.GetText("noticetext10");e=e.replace("&token",t),this._des=e}}else{var n="",a=!1;if(this._sendOpenId==UnitManager.Player.ID&&(a=!0),3121==this.Type?n=0==this._info.code?"1":"2":3105==this.Type?(n=1==this._info.early?"10":"12",1==this.Bonus.length?n="4":2==this.Bonus.length&&(n="13")):3103==this.Type?n=0==this._info.code?"7":"8":3104==this.Type?n="9":3102==this.Type?n="19":3107==this.Type?n="20":3108==this.Type?n="22":3109==this.Type?n="21":3110==this.Type&&(n="18"),""==n&&(Main.AddDebug("出现没定义的消息类型："+this.Type),n="12"),this._des=StringMgr.GetText(NoticeManager.GetNoticeDes(n).des),null!=this._des){var r=FriendManager.GetFriendByID(this._sendOpenId),o=FriendManager.GetFriendByID(this._reviceOpenId),s=StringMgr.GetText("noticetext12"),u=StringMgr.GetText("noticetext12");r?s=r.Name:this._sendOpenId==UnitManager.Player.ID&&(s=UnitManager.Player.Name),o?u=o.Name:this._reviceOpenId==UnitManager.Player.ID&&(u=UnitManager.Player.Name),this._des=this._des.replace("&master",s),this._des=this._des.replace("&slave",u)}}return this._des},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Time",{get:function(){return this._time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMySend",{get:function(){return this._sendOpenId!=UnitManager.PlayerID?this._isMySend=!1:this._isMySend=!0,this._isMySend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsRead",{get:function(){return 0==this._isRead?!1:!0},set:function(e){e?this._isRead=1:this._isRead=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bonus",{get:function(){return this._bonus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BonusRes",{get:function(){var e=PromptManager.GetBonusResData(this.Bonus,!1);return e},enumerable:!0,configurable:!0}),e}();__reflect(Notice.prototype,"Notice");var NoticeManager=function(){function e(){}return e.updataNoticeReturn=function(t){if(e._allNoticeSet=[],t.code!=NetManager.SuccessCode)return void Main.AddDebug("获取消息列表出错："+t.code);var i=t.data;Object.keys(i).map(function(t){var n=new Notice(i[t]);e._allNoticeSet.push(n)}),GameEvent.DispatchEvent(EventType.NoticeUpData)},Object.defineProperty(e,"AllNoticeSet",{get:function(){return e._allNoticeSet},enumerable:!0,configurable:!0}),e.GetNoticeByPosiId=function(t){return e._allNoticeSet[t]},e.GetNoticeDes=function(t){return null==e._noticeJsonData&&(e._noticeJsonData=RES.getRes("maildata_json")),e._noticeJsonData[t]},e}();NoticeManager._allNoticeSet=[],NoticeManager._noticeDesSet=[],__reflect(NoticeManager.prototype,"NoticeManager");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}return e.prototype.borrowObject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.list.length>0){var i=this.list.shift();return"function"==typeof i.onInit?i.onInit():i}var n=egret.getDefinitionByName(this.className);return new(n.bind.apply(n,[void 0].concat(e)))},e.prototype.returnObject=function(e){"function"==typeof e.onReturn?this.list.push(e.onReturn()):this.list.push(e)},e.getPool=function(t){return e.pool[t]||(e.pool[t]=new e(t)),e.pool[t]},e}();ObjectPool.pool={},__reflect(ObjectPool.prototype,"ObjectPool");var Player=function(){function e(e,t,i,n,a,r,o){this._name="",this._maxScore=0,this._maxPhysical=0,this._physical=0,this._physicalTime=0,this._timer=0,this._physicalMaxTime=0,this._vipTime=0,this._id=e,this.Name=t,this.Money=i,this.PingGai=n,this.MaxScore=a,this._gameToken=r,this.HearUrl=o,ProcessManager.AddProcess(this._Process.bind(this)),GameEvent.AddEventListener(EventType.MaxPhysicalChange,this._PhysicalChange,this),GameEvent.AddEventListener(EventType.PhysicalChange,this._PhysicalChange,this)
}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GameToken",{get:function(){return this._gameToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Money",{get:function(){return this._money},set:function(e){this._money=e,GameEvent.DispatchEvent(EventType.MoneyChange)},enumerable:!0,configurable:!0}),e.prototype.ConsumeMoney=function(e){this.Money-=e},e.prototype.TestMoney=function(e){if(this._money>=e)return!0;var t=e-this._money,i=StringMgr.GetText("playertext1");return i=i.replace("&money",t.toString()),PromptManager.CreatCenterTip(!1,!1,i,null,this._GoShopItemPage.bind(this)),!1},e.prototype._GoShopItemPage=function(){return null==WindowManager.ShopWindow()?void WindowManager.SetWindowFunction(this._GoItemShop.bind(this)):void this._GoItemShop()},e.prototype._GoItemShop=function(){WindowManager.RoleDetailWindow().IsVisibled&&(WindowManager.RoleDetailWindow().IsVisibled=!1),WindowManager.StarWindow().OpenWindow(WindowManager.ShopWindow()),WindowManager.ShopWindow().OpenItemPage();var e=WindowManager.SlaveHDWindow();null!=e&&e.IsVisibled&&(e.IsVisibled=!1)},Object.defineProperty(e.prototype,"PingGai",{get:function(){return this._pingGai},set:function(e){this._pingGai=e,GameEvent.DispatchEvent(EventType.PingGaiChange)},enumerable:!0,configurable:!0}),e.prototype.TestPingGai=function(e){if(this._pingGai>=e)return!0;var t=e-this._pingGai,i=StringMgr.GetText("playertext3");return i=i.replace("&token",t.toString()),PromptManager.CreatCenterTip(!1,!1,i,null,this._GoShopRechargePage.bind(this)),!1},e.prototype._GoShopRechargePage=function(){return null==WindowManager.ShopWindow()?void WindowManager.SetWindowFunction(this._GoRechargeShop.bind(this)):void this._GoRechargeShop()},e.prototype._GoRechargeShop=function(){WindowManager.StarWindow().OpenWindow(WindowManager.ShopWindow()),WindowManager.ShopWindow().OpenRecharge();var e=WindowManager.SlaveHDWindow();null!=e&&e.IsVisibled&&(e.IsVisibled=!1)},Object.defineProperty(e.prototype,"Name",{get:function(){return this._name?this._name:"Vallnet"+(1e5*Math.random()|0)},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HearUrl",{get:function(){return""==this._headUrl?"resource/res/common/anniu_off.png":this._headUrl},set:function(e){this._headUrl!=e&&(this._headUrl=e,GameEvent.DispatchEvent(EventType.PlayerHeadChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxScore",{get:function(){return this._maxScore},set:function(e){e>this._maxScore&&(this._maxScore=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxPhysical",{get:function(){return this._maxPhysical},set:function(e){this._maxPhysical!=e&&(this._maxPhysical=e,GameEvent.DispatchEvent(EventType.MaxPhysicalChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Physical",{get:function(){return this._physical},set:function(e){this._physical!=e&&(this._physical=e,this._physical==this._maxPhysical&&(this.PhysicalTime=0),GameEvent.DispatchEvent(EventType.PhysicalChange))},enumerable:!0,configurable:!0}),e.prototype.PhysicalConsume=function(e){var t=this._TestPhysical(e);return t&&(this.Physical-=e),t},e.prototype._TestPhysical=function(e){return this.Physical>=e?!0:(UnitManager.PhysicalNoEnough(),!1)},Object.defineProperty(e.prototype,"PhysicalTime",{get:function(){return this._physicalTime},set:function(e){e!=this._physicalTime&&(this.Physical==this.MaxPhysical&&(e=0),this._physicalTime=e,GameEvent.DispatchEvent(EventType.PhysicalTimeChange))},enumerable:!0,configurable:!0}),e.prototype._Process=function(e){var t=1e3;this._timer+=e,this._timer>=t&&(this._timer-=t,this.PhysicalTime>0&&(this.PhysicalTime-=1,0==this.PhysicalTime&&(this.Physical+=1)),this._vipTime>0&&(this.VIPTime-=1))},e.prototype._PhysicalChange=function(){this.Physical==this.MaxPhysical&&(this.PhysicalTime=0),this.Physical<this.MaxPhysical&&0==this.PhysicalTime&&(this.PhysicalTime=this.PhysicalMaxTime)},Object.defineProperty(e.prototype,"PhysicalMaxTime",{get:function(){return this._physicalMaxTime},set:function(e){this._physicalMaxTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsVIP",{get:function(){return this._vipTime>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VIPTime",{get:function(){return this._vipTime},set:function(e){0>e&&(e=0),e!=this._vipTime&&(this._vipTime=e,GameEvent.DispatchEvent(EventType.VIPTimeUpdate))},enumerable:!0,configurable:!0}),e}();__reflect(Player.prototype,"Player");var Role=function(){function e(e){this._skillRunnerLv=0,this._immuneHurt=!1,this._skillStatus=!1,this._itemRecoverLife=0,this._isscene=0,this._id=e.id,this._name=e.name,this._res=e.res,this._sJumpMusic=e.sjump+SoundManager.Music_Suffix,this._bJumpMusic=e.bjump+SoundManager.Music_Suffix,this._dieMusic=e.die+SoundManager.Music_Suffix,this._lifeBase=e.basehp,this._lifeRate=e.hprate,this._defenseBase=e.basedef,this._defenseRate=e.defrate,this._luckyBase=e.baselucy,this._luckyRate=e.lucyrate,this._pieceid=e.pieceid,this._headRes=e.headres,this._resGroupName=e.resgroupname,this._skillID1=e.skill1,this._skillID2=e.skill2,this._skillID3=e.skill3,this._skillSound=e.skillv,this._specialty=e.specialty,this._unlockskill1=e.unlockskill1,this._unlockskill2=e.unlockskill2,this._unlockskill3=e.unlockskill3,this._skill1=SkillManager.creatSkill(this._skillID1,this._id,this._unlockskill1),this._skill2=SkillManager.creatSkill(this._skillID2,this._id,this._unlockskill2),this._skill3=SkillManager.creatSkill(this._skillID3,this._id,this._unlockskill3),this._getImaRes=e.resget,this._isscene=e.isscene,this._level=0}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return StringMgr.GetText(this._name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Res",{get:function(){return this._res},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResGroupName",{get:function(){return this._resGroupName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeadRes",{get:function(){return this._headRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pieceid",{get:function(){return this._pieceid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SmallJumpMusic",{get:function(){return this._sJumpMusic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BigJumpMusic",{get:function(){return this._bJumpMusic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DieMusic",{get:function(){return this._dieMusic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},set:function(e){this._level!=e&&(this._level=e,this._UpdateSkillRunner(),this.MaxLife,GameEvent.DispatchEvent(EventType.RoleUpLevel))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Specialty",{get:function(){return StringMgr.GetText(this._specialty)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsHave",{get:function(){return this.Level>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnlockSkillSet",{get:function(){return[this._unlockskill1,this._unlockskill2,this._unlockskill3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillIdSet",{get:function(){return[this._skillID1,this._skillID2,this._skillID3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllSkillSet",{get:function(){return[this._skill1,this._skill2,this._skill3]},enumerable:!0,configurable:!0}),e.prototype.SetSkillLevelByNum=function(e,t){this.AllSkillSet[t-1].Level=e,this._UpdateSkillRunner()},Object.defineProperty(e.prototype,"UseSkillSet",{get:function(){for(var e=[],t=0;t<this.AllSkillSet.length;t++)this.AllSkillSet[t].IsJieSuo&&e.push(this.AllSkillSet[t]);return e},enumerable:!0,configurable:!0}),e.prototype.IsUseSkillById=function(e){for(var t=0;t<this.UseSkillSet.length;t++)if(e==this.UseSkillSet[t].ID)return!0;return!1},Object.defineProperty(e.prototype,"MaxLife",{get:function(){var e=this.SkillRunner.Properties.life,t=0,i=0==this.Level?1:this.Level;return t=this._lifeBase*Math.pow(i-1+this._lifeRate*i,.6),null!=e&&(t*=1+e),t=Math.floor(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentLife",{get:function(){return this._currentLife},set:function(e){0>e&&(e=0),e>this.MaxLife&&(e=this.MaxLife),this._currentLife!=e&&(this._currentLife=e,GameEvent.DispatchEvent(EventType.RoleLifeChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Defense",{get:function(){var e=0,t=0==this.Level?1:this.Level;e=this._defenseBase*Math.pow(2*(t-1)+this._defenseRate*t,.6);var i=this.SkillRunner.Properties.defense;return null!=i&&(e*=1+i),e=Math.floor(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lucky",{get:function(){var e=0,t=0==this.Level?1:this.Level;e=this._luckyBase*Math.pow(2*(t-1)+this._luckyRate*t,.6);var i=this.SkillRunner.Properties.fare;return null!=i&&(e*=1+i),e=Math.floor(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RealLucky",{get:function(){var e=0;e=this.Lucky/(this.Lucky+GameConstData.HopeLucky+GameConstData.LuckyRate*this.Level);var t=this.SkillRunner.Properties.lucky;return null!=t&&(e*=1+t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InjuryFreeRate",{get:function(){var e=0;e=this.Defense/(this.Defense+GameConstData.HopeDefense+GameConstData.InjuryFreeRate*this.Level);var t=this.SkillRunner.Properties.protect;return null!=t&&(e*=1+t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GetRoleNum",{get:function(){return GameConstData.GetRoleNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GetCurRoleNum",{get:function(){return ItemManager.GetItemCount(this._pieceid)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UpLevelDebrisNum",{get:function(){var e=this._GetDebrisNum(this.Level);return e=Math.ceil(e)},enumerable:!0,configurable:!0}),e.prototype._GetDebrisNum=function(e){if(0==e)return this.GetRoleNum;var t=0;return t=this._GetDebrisNum(e-1)+GameConstData.DebrisConumRate*e,t=Math.ceil(t)},e.prototype._UpdateSkillRunner=function(){return this._skillRunnerLv=this._level,this._skillRunner=SkillManager.GetSkillRunner(this),this._skillRunner},Object.defineProperty(e.prototype,"SkillRunner",{get:function(){return null==this._skillRunner&&this._UpdateSkillRunner(),this._level!=this._skillRunnerLv&&this._UpdateSkillRunner(),this._skillRunner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScoreRate",{get:function(){var e=0,t=this.SkillRunner.Properties.score;return null!=t&&(e=t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MoneyRate",{get:function(){var e=0,t=this.SkillRunner.Properties.money;return null!=t&&(e=t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BonusRate",{get:function(){var e=0,t=this.SkillRunner.Properties.bonus;return null!=t&&(e=t),e},enumerable:!0,configurable:!0}),e.prototype.HurtAction=function(e){if(!(0>=e)){SkillManager.HurtBlood=e;var t=this.SkillRunner.Notify(NotifyEnum_s.Hurt,{value:e});return this.HandleAction(t),SkillManager.HurtBlood}},e.prototype.JumpAction=function(){var e=this.SkillRunner.Notify(NotifyEnum_s.Jump);this.HandleAction(e)},e.prototype.DeadAction=function(){var e=this.SkillRunner.Notify(NotifyEnum_s.Dead);this.HandleAction(e)},e.prototype.FenShenAction=function(){var e=this.SkillRunner.Notify(NotifyEnum_s.Dead);this.HandleAction(e)},Object.defineProperty(e.prototype,"VictoryAction",{get:function(){var e=this.SkillRunner.Notify(NotifyEnum_s.Victory),t=!1;return Object.keys(e).map(function(i){e[i].map(function(e){var i=e.type;switch(i){case ActionEnum_s.GetAction:t=!0}})}),t},enumerable:!0,configurable:!0}),e.prototype.HandleAction=function(e){var t=this;null!=e&&(CheckpointManager.IsEndless||CheckpointManager.IsDailyActive||Object.keys(e).map(function(i){e[i].map(function(e){var i=e.type;switch(i){case ActionEnum_s.FlyBoat:if(0==t.CurrentLife)break;Game.Instance.ChangeRoleStatus(2),t.creatSkillTip(8);break;case ActionEnum_s.Recover:if(0==t.CurrentLife)break;var n=e.param;Game.Instance.ChangeRoleStatus(1,-n),t.creatSkillTip(9);break;case ActionEnum_s.Shield:if(0==t.CurrentLife)break;var n=(e.param.duration,e.param.value);Game.Instance.ChangeRoleStatus(4,-n),t.creatSkillTip(11);break;case ActionEnum_s.Revive:t.CurrentLife=Math.floor(t.MaxLife*(e.param/100)),Game.Instance.GameRevive(),t.creatSkillTip(7);break;case ActionEnum_s.Release:var a=e.param.id;if(a){if(a==SkillEnum_s.FenShen){var n=e.param.value;Game.Instance.ChangeRoleStatus(5,n)}else if(a==SkillEnum_s.ZhaoHuanXuZuo)Game.Instance.ChangeRoleStatus(6);else if(a==SkillEnum_s.ZhiHuoZaiSheng){var r=e.param.isshow,o=r?1:0;Game.Instance.ChangeRoleStatus(7,o)}t.creatSkillTip(a),SoundManager.PlayMusic(t.SkillSoundName,1)}break;case ActionEnum_s.FSRecover:if(0==t.CurrentLife)break;var n=e.param.value,s=n;Game.Instance.ChangeRoleStatus(1,-s);break;case ActionEnum_s.HurtRecover:if(0==t.CurrentLife)break;var a=e.param.id,n=e.param.value;Game.Instance.ChangeRoleStatus(1,-n),t.creatSkillTip(a);break;case ActionEnum_s.SkillEnd:if(0==t.CurrentLife)break;var a=e.param.id,n=e.param.value;Game.Instance.ChangeRoleStatus(1,-n),t.creatSkillTip(a)}})}))},e.prototype.creatSkillTip=function(e){for(var t=0;t<this.UseSkillSet.length;t++)if(this.UseSkillSet[t].ID==e){Game.Instance.creatZhuDongSkillTip(e);break}},Object.defineProperty(e.prototype,"GetRes",{get:function(){return this._getImaRes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillStatus",{get:function(){return this._skillStatus},set:function(e){this._skillStatus=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemRecoverLife",{get:function(){return this._itemRecoverLife},set:function(e){this._itemRecoverLife=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImmuneHurt",{get:function(){return this._immuneHurt},set:function(e){this._immuneHurt=e},enumerable:!0,configurable:!0}),e.prototype.GameInit=function(){this._immuneHurt=!1,this._skillStatus=!1,this._itemRecoverLife=0},Object.defineProperty(e.prototype,"Scene",{get:function(){return this._isscene},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSceneStart",{get:function(){return UnitStatusMgr.IsUnlockNinjaScene?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillSoundName",{get:function(){return this._skillSound+SoundManager.Music_Suffix},enumerable:!0,configurable:!0}),e}();__reflect(Role.prototype,"Role");var UnitManager=function(){function e(){}return e.Init=function(){e._LoadRole()},e.CreatePlayer=function(t,i,n,a,r,o,s){null==e._player?(e._player=new Player(t,i,n,a,r,o,s),e._UpdatePlayerPhysical(),NetManager.SendRequest(["func="+NetNumber.DayGift],e._ReceiveDayGift.bind(e)),Facade.instance().watch(e._ReceiveFirstShare.bind(e),NetNumber.ShareFirstBonus)):(e._player.Money=n,e._player.PingGai=a,e._player.Name=i,e._player.MaxScore=r,e._player.HearUrl=s)},e._LoadRole=function(){e._roleSet=[];var t=RES.getRes("roledata_json");Object.keys(t).map(function(i){var n=t[i],a=new Role(n);-1==e._currentRoleID&&(a.Level=1,e._currentRoleID=a.ID),e._roleSet.push(a)}),NetManager.SendRequest(["func="+NetNumber.RoleList],e.updataRoleReturn.bind(e))},e.updataRoleReturn=function(t){if(t.code!=NetManager.SuccessCode)return void Main.AddDebug("获取角色列表出错："+t.code);var i=t.data;Object.keys(i).map(function(t){var n=i[t],a=parseInt(n.id),r=n.lv,o=n.sk1,s=n.sk2,u=n.sk3,l=e.GetRole(a);null!=l&&(l.Level=r,l.SetSkillLevelByNum(o,1),l.SetSkillLevelByNum(s,2),l.SetSkillLevelByNum(u,3))}),GameEvent.DispatchEvent(EventType.RoleUpLevel)},e.GetRole=function(t){for(var i=0;i<e._roleSet.length;i++)if(t==e._roleSet[i].ID)return e._roleSet[i];return null},e.GetRoleByPiece=function(t){for(var i=0;i<e._roleSet.length;i++)if(t==e._roleSet[i].Pieceid)return e._roleSet[i];return null},e._ReceiveDayGift=function(t){var i=t.code;if(i==NetManager.SuccessCode||801==i){e._dayGiftData=t;var n=t.data.time;null!=e.Player&&(e.Player.VIPTime=n),Main.IsCreated&&e.CheckDayGift()}},e.CheckDayGift=function(){if(null!=e._dayGiftData){var t=-1,i=egret.getOption("GIFT");null!=i&&""!=i&&(t=parseInt(i));var n=e._dayGiftData.code;if(n==NetManager.SuccessCode||801==n&&-1!=t){var a=e._dayGiftData.data,r=801==n,o=a.bonus;if(801==n&&-1!=t||n==NetManager.SuccessCode){if(null==WindowManager.GiftWindow())return void WindowManager.SetWindowFunction(e._ShowGiftWindow,[r,o],WindowManager.GiftWindow);e._ShowGiftWindow([r,o])}}e._dayGiftData=null}},e._ShowGiftWindow=function(e){WindowManager.GiftWindow().Show(e[0],e[1])},e.CheckPlayGift=function(){var t=egret.getOption("GIFT");if(null!=t&&""!=t){switch(t){case"20001":e._playGiftType=1;break;case"30001":e._playGiftType=2;break;case"40001":e._playGiftType=3}NetManager.SendRequest(["func="+NetNumber.PlayGift+"&type="+e._playGiftType],e.ReceivePlayGift.bind(e))}},e.ReceivePlayGift=function(t){var i=t.code;if(i==NetManager.SuccessCode){var n=t.data.bonus;null!=WindowManager.PlayGiftWindow()?e._ShowPlayGift([e._playGiftType,n]):WindowManager.SetWindowFunction(e._ShowPlayGift,[e._playGiftType,n],WindowManager.PlayGiftWindow)}else{if(102==i){var a="";switch(e._playGiftType){case 1:a=StringMgr.GetText("giftpagetext3");break;case 2:a=StringMgr.GetText("giftpagetext4");break;case 3:a=StringMgr.GetText("giftpagetext5")}a+=StringMgr.GetText("giftpagetext6"),PromptManager.CreatCenterTip(!1,!1,a)}if(103==i){var a=StringMgr.GetText("giftpagetext7");PromptManager.CreatCenterTip(!1,!1,a)}}},e._ShowPlayGift=function(e){WindowManager.PlayGiftWindow().Show(e[0],e[1])},Object.defineProperty(e,"CurrentRole",{get:function(){return e.GetRole(e._currentRoleID)},enumerable:!0,configurable:!0}),e.GetRoleSet=function(){return e._roleSet},e.ChangeRole=function(t){e._currentRoleID=t},Object.defineProperty(e,"PlayerID",{get:function(){return null==e._player?"":e._player.ID},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Player",{get:function(){return e._player},enumerable:!0,configurable:!0}),e._ReceiveFirstShare=function(e){var t=e.info;if(null!=t){var i=t.bonus;PromptManager.ShowGit(i),UnitStatusMgr.SetValue(32,!0),WindowManager.StarWindow().UpdateFirstShare()}},e.ReceivePhysical=function(t){var i=t.info;i.refreshTime=Math.floor(i.refreshTime),e._physicalData[0]=i.cur,e._physicalData[1]=i.max,e._physicalData[2]=i.refreshTime,e._physicalData[3]=i.peroid,e._moneyData[0]=i.diamond,e._moneyData[1]=i.money,null!=e._player&&e._UpdatePlayerPhysical()},e._UpdatePlayerPhysical=function(){e._player.MaxPhysical=e._physicalData[1],e._player.Physical=e._physicalData[0],e._player.PhysicalTime=e._physicalData[2],e._player.PhysicalMaxTime=e._physicalData[3],e._player.PingGai=e._moneyData[0],e._player.Money=e._moneyData[1]},e.PhysicalNoEnough=function(){var t=FrequencyManager.GetFrequency(3);if(null==t)return void Main.AddDebug("获取不到次数信息，type=3");var i=t.Value,n=t.MaxValue+t.ExtValue;if(i=n-i,i>0){var a=StringMgr.GetText("sharetext1")+i+"/"+n;PromptManager.CreatCenterTip(!1,!1,a,null,e._OnShareTipYes.bind(e))}else PromptManager.CreatCenterTip(!1,!1,StringMgr.GetText("sharetext2"))},e._OnShareTipYes=function(){if(Main.IsLocationDebug)e._ShareTask();else{var t=GameConstData.ShareContent;2==t.length?(window.shareCont=FBSDKMgr.Share(t[0],t[1]),window.share()):(window.shareCont=FBSDKMgr.Share(),window.share()),e._ShareTask()}},e._ShareTask=function(){NetManager.SendRequest(["func="+NetNumber.ShareEnd+"&type="+e.PhyShareType],e._OnShareTaskReturn)},e._OnShareTaskReturn=function(e){if(e.code!=NetManager.SuccessCode)return void Main.AddDebug("分享任务返回错误，错误码："+e.code);var t=e.data;Object.keys(t).map(function(e){ItemManager.SetItemCount(parseInt(e),t[e].num)})},e.ReveiceDailyActiveState=function(t){t.info.cd?e.DailyActiveStartTimeNum=t.info.cd:e.DailyActiveStartTimeNum=0,e.SetDailyActiveState(t.info.status)},e.SetDailyActiveState=function(e){this._dailyActiveState="open"==e?!0:!1,GameEvent.DispatchEvent(EventType.DailyAcitveStateUpData)},Object.defineProperty(e,"DailyActiveState",{get:function(){return this._dailyActiveState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DailyActiveStartTimeNum",{get:function(){return this._dailyActiveStartTimeNum},set:function(e){this._dailyActiveStartTimeNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DailyActiveCurScore",{set:function(e){this._dailyActiveScore=e},enumerable:!0,configurable:!0}),e.ReceiveBonus=function(e){PromptManager.ShowGit(e.info.bonus)},e.ReceiveFuwuduanTime=function(t){e._fuwuduanTime=t.data.time,ProcessManager.AddProcess(e._Process)},Object.defineProperty(e,"FuwuduanTime",{get:function(){return e._fuwuduanTime},set:function(t){e._fuwuduanTime=t},enumerable:!0,configurable:!0}),e._Process=function(t){if(0!=e.FuwuduanTime){e._timer+=t;var i=1e3;e._timer>=i&&(e._timer-=i,e.FuwuduanTime+=1)}},e}();UnitManager.DieShareType="2",UnitManager.PhyShareType="3",UnitManager.CatchType="5",UnitManager.EscapeType="6",UnitManager.ChaoYueFriendShareType="4",UnitManager.MingRenID=21031,UnitManager.ZuoZuID=21032,UnitManager.XiaoYingID=21033,UnitManager._roleSet=[],UnitManager._currentRoleID=-1,UnitManager._physicalData=[100,100,0,360],UnitManager._moneyData=[0,0],UnitManager._playGiftType=0,UnitManager._dailyActiveStartTimeNum=0,UnitManager._dailyActiveState=!0,UnitManager._dailyActiveScore=0,UnitManager._dailyActiveMaxScore=3e8,UnitManager._fuwuduanTime=0,UnitManager._timer=0,__reflect(UnitManager.prototype,"UnitManager");var UnitStatusMgr=function(){function e(){}return e.UpdateStatus=function(t){e.Status=t.info},Object.defineProperty(e,"Status",{get:function(){return e._userStatus},set:function(t){t!=e._userStatus&&(e._userStatus=t,GameEvent.DispatchEvent(EventType.UserStatusChange))},enumerable:!0,configurable:!0}),e.SetValue=function(t,i){void 0===i&&(i=!0),i?e.Status=e.Status|t:e.Status=e.Status&~t},Object.defineProperty(e,"IsFirstShare",{get:function(){return 32!=(32&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsNewPlay",{get:function(){return 16==(16&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HasNewMail",{get:function(){return 8==(8&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsSlave",{get:function(){return 256==(256&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsMaster",{get:function(){return 512==(512&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsFreed",{get:function(){return!e.IsSlave&&!e.IsMaster},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsFirstCharge",{get:function(){return 1024==(1024&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsFirstChargeReward",{get:function(){return 2048==(2048&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsUnlockNinjaScene",{get:function(){return 32768==(32768&e._userStatus)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsGetNinjaGift",{get:function(){return 65536==(65536&e._userStatus)},enumerable:!0,configurable:!0}),e}();UnitStatusMgr._userStatus=0,__reflect(UnitStatusMgr.prototype,"UnitStatusMgr");var ProcessManager=function(){function e(){}return e.Init=function(){egret.Ticker.getInstance().register(e._Process,e),WindowManager.Init()},e._Process=function(t){for(var i=0;i<e._functionSet.length;i++)e._functionSet[i](t);var n=3e5;e._timer+=t,e._timer>=n&&(e._timer-=n,Facade.instance().notify({func:NetNumber.HeartBeat}))},e.AddProcess=function(t){for(var i=0;i<e._functionSet.length;i++)if(e._functionSet[i]==t)return;e._functionSet.push(t)},e.RemoveProcess=function(t){for(var i=0;i<e._functionSet.length;i++)if(e._functionSet[i]==t)return void e._functionSet.splice(i,1)},e}();ProcessManager._functionSet=[],ProcessManager._timer=0,__reflect(ProcessManager.prototype,"ProcessManager");var PromptManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.ShowGameTip=function(e,i,n){return null==WindowManager.GamePromptPage()?void WindowManager.SetWindowFunction(t._ShowGameTip,[e,i,n]):void t._ShowGameTip([e,i,n])},t._ShowGameTip=function(e){WindowManager.GamePromptPage().ShowPrompt(e[0],e[1],e[2])},t.CreatCenterTip=function(e,i,n,a,r,o,s,u,l){return void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===u&&(u=null),void 0===l&&(l=!1),Game.GameStatus?void 0:null==WindowManager.CenterPromptPage()?void WindowManager.SetWindowFunction(t._ShowCenter,[e,i,n,a,r,o,s,u,l]):void t._ShowCenter([e,i,n,a,r,o,s,u,l])},t._ShowCenter=function(e){WindowManager.CenterPromptPage().ShowPrompt(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},t.CreatTopTip=function(e,i){return void 0===e&&(e=null),void 0===i&&(i=null),Game.IsShowTopTip?null==WindowManager.TopPromptPage()?void WindowManager.SetWindowFunction(t._ShowTop,[e,i]):void t._ShowTop([e,i]):void 0},t._ShowTop=function(e){WindowManager.TopPromptPage().ShowPrompt(e[0],e[1])},t.CreatShopBuyPage=function(e,i,n,a){return null==WindowManager.ShopBuyPage()?void WindowManager.SetWindowFunction(t.ShowShopBuyPage,[e,i,n,a]):void t.ShowShopBuyPage([e,i,n,a])},t.ShowShopBuyPage=function(e){WindowManager.ShopBuyPage().Show(e[0],e[1],e[2],e[3])},t.ShowGit=function(e){if(null!=e)for(var i=t.GetBonusResData(e,!0),n=0;n<i.length;n++)"item"==i[n].type?t.CreatTopTip(StringMgr.GetText("prompttext1")+i[n].name+" X"+i[n].num,i[n].res):t.CreatTopTip(StringMgr.GetText("prompttext1")+i[n].name+" X"+i[n].num)},t.SlaveTip=function(e,i,n){if(!Game.GameStatus){var a=i;if(null!=e&&e.length>0)for(var r=t.GetBonusResData(e,!0),o=0;1>o;o++)a="item"==r[o].type?i+StringMgr.GetText("prompttext2")+r[o].name+"X"+r[o].num:i+StringMgr.GetText("prompttext2")+r[o].num+r[o].name;t.CreatCenterTip(!1,!1,a,null,null,t.SlaveShareFun.bind(t),null,n,!0)}},t.SlaveShareFun=function(e){window.shareCont=FBSDKMgr.Share(e,"",1),window.share()},t.GetBonusResData=function(e,t){void 0===t&&(t=!1);var i=null,n=[];if(null!=e)for(var a=0;a<e.length;a++){var r=e[a],o=r.type;if("M"==o)i={type:"money",res:"fenxiang_jinbi_png",num:r.num,name:StringMgr.GetText("rewardtext1")},n.push(i);else if("A"==o)i={type:"tili",res:"fenxiang_daoju_tili_png",num:r.num,name:StringMgr.GetText("rewardtext3")},n.push(i);else if("D"==o)i={type:"pinggai",res:"fenxiang_jifen_png",num:r.num,name:StringMgr.GetText("rewardtext2")},n.push(i);else if("I"==o||"C"==o){var s=ItemManager.GetItemByID(r.id);null!=s&&(i={type:"item",item:s,res:s.ImageRes,num:r.num,name:s.Name},n.push(i),t&&ItemManager.AddItem(ItemManager.GetXID(o,r.id),r.num))}}return n},t.ShowDailyActiveRewardTip=function(e){return null==WindowManager.DailyActiveRewardTip()?void WindowManager.SetWindowFunction(t._ShowDailyActiveRewardTip,[e]):void t._ShowDailyActiveRewardTip([e])},t._ShowDailyActiveRewardTip=function(e){GuideManager.IsGuide||WindowManager.DailyActiveRewardTip().Show(e[0])},t.CheckGenXin=function(){var e=Main.GonggaoJson;if(null!=e){var t=e.genxingonggao;if(null!=t||t.isshow){var i=Math.floor((new Date).getTime()/1e3),n=t.starttime,a=t.endtime;if(i>=n&&a>=i){var r=t.desc;WindowManager.NoticeDetailWindow().ShowGenxin(r)}}}},t.ShowGenXin=function(){var e=Main.GonggaoJson;if(null!=e){var t=e.genxingonggao;if(null!=t){var i=t.desc;WindowManager.NoticeDetailWindow().ShowGenxin(i)}}},t.ShowWeihu=function(){var e=Main.GonggaoJson;if(null!=e){var t=e.fuwuqiweihu;if(null!=t){var i=t.desc;WindowManager.NoticeDetailWindow().ShowWeihu(i)}}},t}(egret.DisplayObjectContainer);__reflect(PromptManager.prototype,"PromptManager");var QQSDKMgr=function(){function e(){}return e.Init=function(){Main.IsLocationDebug},e.OpenURL=function(e){Main.IsLocationDebug},e.PopPayTips=function(e){Main.IsLocationDebug||PopPayTips(e)},e.Share=function(t,i,n,a){void 0===t&&(t=""),void 0===i&&(i=""),void 0===n&&(n=0),void 0===a&&(a=null),Main.IsLocationDebug||e._Share(t,i,"",n,a)},e.ShareFriend=function(t,i,n,a){void 0===i&&(i=""),void 0===n&&(n=0),void 0===a&&(a=""),Main.IsLocationDebug||e._Share(i,a,t,n,null)},e._Share=function(t,i,n,a,r){void 0===a&&(a=0),e._shareCallback=r;var o=JSON.parse("{}");o.title=StringMgr.GetText("sharetext3"),o.desc=""!=t?t:StringMgr.GetText("sharetext4"),o.share_type=a,o.share_url="window.OPEN_DATA && window.OPEN_DATA.shareurl || window.location.href",o.image_url=""!=i?i:"https://res.cdn.173kw.com/jxd/100px.png",o.back=!0,""!=n?(o.toUin=n,o.uinType=0,e._shareCallback=null,ShareMessage(o,null)):ShareMessage(o,e._OnShareReturn)},e._OnShareReturn=function(t){Main.IsLocationDebug||("0"==t.retCode?null!=e._shareCallback&&e._shareCallback():PromptManager.CreatCenterTip(!1,!0,"分享失败"),e._shareCallback=null,WindowManager.WaitPage().IsVisibled&&ResReadyMgr.IsReady("prompt"))},e.ReportRegister=function(){Main.IsLocationDebug||ReportRegister()},e.ReportLogin=function(){Main.IsLocationDebug||ReportLogin()},e.SetPaySuccess=function(e){Main.IsLocationDebug||SetPaySuccess(e)},e.SetPayError=function(e){Main.IsLocationDebug||SetPayError(e)},e.SetPayClose=function(e){Main.IsLocationDebug||SetPayClose(e)},e.GetPF=function(){return Main.IsLocationDebug?"wanba_ts":GetPF()},e.GetPlatform=function(){return Main.IsLocationDebug?2:GetPlatform()},e.AddShortcut=function(e,t){void 0===e&&(e=""),void 0===t&&(t=""),Main.IsLocationDebug||(""==e&&(e=StringMgr.GetText("sharetext3")),""==t&&(t="http://res.cdn.173kw.com/jxd/icon100-old.png"))},Object.defineProperty(e,"AppInBackground",{get:function(){return Main.IsLocationDebug?!1:!1},enumerable:!0,configurable:!0}),e.SetOnAddShortcutHandler=function(){Main.IsLocationDebug},e.SetAppicon=function(e){void 0===e&&(e=""),Main.IsLocationDebug||""==e&&(e="http://res.cdn.173kw.com/jxd/100px.png")},e.FormatTime=function(e){var t="";0>e&&(e=0);var i=Math.floor(e/3600),n=Math.floor(e%3600/60),a=e%60|0,r=10>i?"0"+i.toString():i.toString(),o=10>n?"0"+n.toString():n.toString(),s=10>a?"0"+a.toString():a.toString();return t=r+":"+o+":"+s},e.HtmlParser=function(t){return null==e._htmlParser&&(e._htmlParser=new egret.HtmlTextParser),e._htmlParser.parse(t)},e.Login=function(){return Main.IsLocationDebug?void LoginMgr.Login():void 0},e._LoginReturn=function(t){var i=t,n=i.code;if(n!=NetManager.SuccessCode)return Main.AddDebug("登入腾讯出错，code="+n),void e.Login();var a=i.data.openid,r=i.data.openkey;e._openid=a,e._openkey=r,LoginMgr.Login()},Object.defineProperty(e,"BanBenNum",{get:function(){return e._banbenNum},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpenID",{get:function(){return Main.IsLocationDebug?"BA6EE39A439DCCA6920FCC7719A0EE7D":e._openid},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpenKey",{get:function(){return Main.IsLocationDebug?"0000000":e._openkey},enumerable:!0,configurable:!0}),e.GetOpenid=function(){return Main.IsLocationDebug?"BA6EE39A439DCCA6920FCC7719A0EE7D":GetOpenid()},e.GetOpenkey=function(){return Main.IsLocationDebug?"36C9AA1A751088761BA1D54C8DFDF0D0":GetOpenkey()},e}();QQSDKMgr._shareCallback=null,QQSDKMgr._banbenNum="",__reflect(QQSDKMgr.prototype,"QQSDKMgr");var RollingNoticeManager=function(){function e(){}return e.Init=function(){e._radioJson=RES.getRes("radiodata_json"),e._isInit=!0,e.RollingNoticeSet.length>0&&WindowManager.RollingNoticeWindow().Show()},e.ReceiveRollingNotice=function(t){e.AddRollingNotice(t.info)},Object.defineProperty(e,"RollingNoticeSet",{get:function(){return e._noticeSet},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RollingNoticeMsgSet",{get:function(){return e._radioJson},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsInit",{get:function(){return e._isInit},enumerable:!0,configurable:!0}),e.AddRollingNotice=function(t){e._noticeSet.push(t),e.IsInit&&0==WindowManager.RollingNoticeWindow().IsVisibled&&WindowManager.RollingNoticeWindow().Show()
},e}();RollingNoticeManager._noticeSet=[],RollingNoticeManager._isInit=!1,RollingNoticeManager._radioJson=null,__reflect(RollingNoticeManager.prototype,"RollingNoticeManager");var Skill=function(){function e(e){this._type=0,this._mpcost=0,this._level=0,this._jiesuoRoleSet=[],this._jiesuoRoleIdSet=[],this._id=e.id,this._name=e.name,this._imageRes=e.pic,this._effect=e.effect,this._desc=e.desc,this._type=e.type,this._mpcost=e.mpcost,this._overview=e.overview,this._gameSkillNameRes=e.skilltext}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return StringMgr.GetText(this._name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImageRes",{get:function(){return this._imageRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GameSKillNameRes",{get:function(){return this._gameSkillNameRes+StringMgr.LanguageSuffix+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Desc",{get:function(){return StringMgr.GetText(this._desc)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsInitiative",{get:function(){return 0==this._type?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MpCost",{get:function(){return this._mpcost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OverView",{get:function(){return StringMgr.GetText(this._overview)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},set:function(e){this._level=e,GameEvent.DispatchEvent(EventType.RoleUpLevel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PreRoleID",{get:function(){return this._preRole},set:function(e){this._preRole=e},enumerable:!0,configurable:!0}),e.prototype.SetjiesuoRole=function(e){if(this._unlockSet=e,""==e)this._jiesuoRoleIdSet=[this._preRole];else{for(var t=e.split(","),i=0;i<t.length;i++)this._jiesuoRoleIdSet.push(parseInt(t[i]));this._jiesuoRoleIdSet.push(this._preRole)}},Object.defineProperty(e.prototype,"JieSuoRole",{get:function(){if(0==this._jiesuoRoleSet.length)for(var e=0;e<this._jiesuoRoleIdSet.length;e++){var t=UnitManager.GetRole(this._jiesuoRoleIdSet[e]);t&&this._jiesuoRoleSet.push(t)}return this._jiesuoRoleSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsCanUp",{get:function(){for(var e=0;e<this.JieSuoRole.length;e++)if(this.JieSuoRole[e]&&this.JieSuoRole[e].Level<this.Level+1)return!1;return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsJieSuo",{get:function(){return this.Level<=0?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillValue",{get:function(){var e=0,t=UnitManager.GetRole(this._preRole),i=Math.max(1,this._level);switch(this._id){case SkillEnum_s.Defense:e=Math.floor(10*(this._GetValue("effectDefBase")+this._GetValue("effectDefUpdata")*i))/10;break;case SkillEnum_s.Life:e=Math.floor(10*(this._GetValue("effectLifeBase")+this._GetValue("effectLifeUpdata")*i))/10;break;case SkillEnum_s.Fare:e=Math.floor(10*(this._GetValue("effectLuckyBase")+this._GetValue("effectLuckyUpdata")*i))/10;break;case SkillEnum_s.Protect:e=Math.floor(10*(this._GetValue("effectInjuryFreeBase")+this._GetValue("effectInjuryFreeUpdata")*i))/10;break;case SkillEnum_s.Lucky:e=Math.floor(10*(this._GetValue("effectRealLuckyBase")+this._GetValue("effectRealLuckyUpdata")*i))/10;break;case SkillEnum_s.Score:e=Math.floor(10*(this._GetValue("effectScoreBase")+this._GetValue("effectScoreUpdata")*i))/10;break;case SkillEnum_s.Money:e=Math.floor(10*(this._GetValue("effectMoneyBase")+this._GetValue("effectMoneyUpdata")*i))/10;break;case SkillEnum_s.Bonus:e=Math.floor(10*(this._GetValue("effectDropBase")+this._GetValue("effectDropUpdata")*i))/10;break;case SkillEnum_s.Revive:e=Math.floor(this._GetValue("effectRebornBase")+Math.pow(this._GetValue("effectRebornUpdata")*(i-1),.8));break;case SkillEnum_s.FlyBoat:e=this._GetValue("effectPlaneBase")+this._GetValue("effectPlaneUpdata")*i;break;case SkillEnum_s.Jump:e=this._GetValue("effectJumpBase")+Math.floor(this._GetValue("effectJumpUpdata")*i*t.MaxLife);break;case SkillEnum_s.Shield:e=Math.floor(this._GetValue("effectShieldBase")+this._GetValue("effectShieldUpdata")*i/100*t.MaxLife);break;case SkillEnum_s.Action:e=this._GetValue("effectClearApBase")+this._GetValue("effectClearApUpdata")*i;break;case SkillEnum_s.FenShen:e=Math.floor(this._GetValue("effectFenShenBase")+this._GetValue("effectFenShenUpdata")*(i-1)+this._GetValue("effectFenShenLife")*t.MaxLife);break;case SkillEnum_s.FenShenHuiFu:e=Math.floor((this._GetValue("effectFenShenRecoverBase")+this._GetValue("effectFenShenRecoverUpdata")*(i-1)+this._GetValue("effectFenShenRecoverLife")*t.MaxLife)/4/5);break;case SkillEnum_s.FenShenQiangHua:e=this._GetValue("effectFenShenPlusBase")+this._GetValue("effectFenShenPlusUpdata")*(i-1);break;case SkillEnum_s.ZhaoHuanXuZuo:e=Math.floor(this._GetValue("effectNinjaShieldBase")+this._GetValue("effectNinjaShieldUpdata")*(i-1)+this._GetValue("effectNinjaShieldLife")*t.MaxLife);break;case SkillEnum_s.ChangeHurt:e=Math.floor(this._GetValue("effectNinjaShieldRecoverBase")+Math.pow(this._GetValue("effectNinjaShieldRecoverUpdata")*(i-1),.8));break;case SkillEnum_s.XiaoShiHuiFu:e=this._GetValue("effectNinjaShieldRecoverExBase")+this._GetValue("effectNinjaShieldRecoverExUpdata")*i;break;case SkillEnum_s.ZhiHuoZaiSheng:e=Math.floor(this._GetValue("effectNinjaRecoverFixedValue")+Math.floor(this._GetValue("effectNinjaRecoverBase")+this._GetValue("effectNinjaRecoverUpdata")*(i-1))*t.MaxLife/100);break;case SkillEnum_s.AllItemHuiFu:e=Math.floor(this._GetValue("effectNinjaItemRecoverBase")+this._GetValue("effectNinjaItemRecoverUpdata")*i/100*t.MaxLife);break;case SkillEnum_s.AddHuiFu:e=Math.floor(this._GetValue("effectNinjaRecoverPlusBase")+this._GetValue("effectNinjaRecoverPlusUpdata")*i)}return e},enumerable:!0,configurable:!0}),e.prototype._GetValue=function(e){return GameConstData.GetValue(e)},e}();__reflect(Skill.prototype,"Skill");var SkillManager=function(){function e(){}return e.Init=function(){var t=RES.getRes("skilldata_json");Object.keys(t).map(function(i){var n=t[i];e._skillDataSet[i]=n}),ProcessManager.AddProcess(e._Process.bind(e))},e.creatSkill=function(t,i,n){var a=e.GetSkillDataByID(t),r=new Skill(a);return r.PreRoleID=i,r.SetjiesuoRole(n),e._allSkillSet.push(r),r},e.GetSkillByID=function(t,i){for(var n=0;n<e._allSkillSet.length;n++)if(t==e._allSkillSet[n].ID&&e._allSkillSet[n].PreRoleID==i)return e._allSkillSet[n];return null},e.GetSkill=function(t){for(var i=0;i<e._allSkillSet.length;i++)if(t==e._allSkillSet[i].ID)return e._allSkillSet[i];return null},e.GetSkillDataByID=function(t){return e._skillDataSet[t]?e._skillDataSet[t]:null},e.GetSkillRunner=function(t){var i=new SkillRunner_s(t);return e._skillRunner=i,i},e._Process=function(t){null!=e._skillRunner&&e._skillRunner.Process(t)},e.StartGame=function(){e._skillRunner=UnitManager.CurrentRole.SkillRunner},e}();SkillManager.HurtBlood=0,SkillManager._skillDataSet=[],SkillManager._allSkillSet=[],__reflect(SkillManager.prototype,"SkillManager");var SkillEnum_s={Duration:0,Defense:1,Life:2,Fare:3,Protect:4,Lucky:12,Score:5,Money:6,Bonus:10,Revive:7,FlyBoat:8,Jump:9,Shield:11,Action:13,FenShenHuiFu:15,FenShenQiangHua:16,ChangeHurt:18,XiaoShiHuiFu:19,AllItemHuiFu:21,AddHuiFu:22,FenShen:14,ZhaoHuanXuZuo:17,ZhiHuoZaiSheng:20},ActionEnum_s={FlyBoat:1,Recover:2,Shield:3,Revive:4,GetAction:5,Release:6,FSRecover:7,HurtRecover:8,SkillEnd:9},NotifyEnum_s={Start:1,Hurt:2,Jump:4,Dead:8,Victory:16,Release:32,GameInit:64},ActionObj_s=function(){function e(e,t){void 0===t&&(t=null),this.type=e,this.param=t?t:0}return e}();__reflect(ActionObj_s.prototype,"ActionObj_s");var SkillFunction_s=function(){function e(e,t,i,n,a,r){this._cd=-1,this._maxTimes=0,this._threshold=-1,this._duration=-1,this._durationValue=0,this._timer=0,this._fenshen=-1,this._fsHuifu=-1,this._fsDikan=-1,this._affectSkill=-1,this._skillEndRecover=0,this._hurtRecover=0,this._recoverAdd=0,this._itemRecover=0,this._immuneHurt=!1,this._fsCount=0,this._oneFSDiKou=0,this._id=e,this._notify=new Indicator_s(t),this._runner=i,this._role=n,this._level=a,this._params=r}return Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype.Execute=function(e){void 0===e&&(e=null);var t=[];if(this._params.threshold){if(-1==this._threshold&&(this._threshold=0),this._threshold+=1,this._threshold<this._params.threshold)return t;this._threshold=0}if(this._params.rate&&Math.random()>this._params.rate)return t;if(this._params.max){if(this._maxTimes>=this._params.max)return t;this._maxTimes+=1}if(this._params.cd){if(this._cd>0)return t;this._cd<=0&&(this._cd=this._params.cd)}if(this._params&&this._params.fenshencount&&-1==this._fenshen&&(this._fenshen=this._params.fenshencount),this._params&&this._params.fshuifu&&-1==this._fsHuifu&&(this._fenshen=this._params.fshuifu),this._params&&this._params.fsdikan&&-1==this._fsDikan&&(this._fenshen=this._params.fsdikan),this._params&&this._params.skill&&-1==this._affectSkill&&(this._affectSkill=this._params.skill),this._params.duration){if(this._duration>0)return t;this._duration<=0&&(this._duration=this._params.duration)}var i=0;switch(this._id){case SkillEnum_s.Duration:this._duration>0&&this._durationValue>0&&e&&e.value&&(t=t.concat(this.CheckHurt(e.value)));break;case SkillEnum_s.Defense:i=Math.floor(10*(this._GetValue("effectDefBase")+this._GetValue("effectDefUpdata")*this._level))/1e3,this._runner.Properties.defense=i;break;case SkillEnum_s.Life:i=Math.floor(10*(this._GetValue("effectLifeBase")+this._GetValue("effectLifeUpdata")*this._level))/1e3,this._runner.Properties.life=i;break;case SkillEnum_s.Fare:i=Math.floor(10*(this._GetValue("effectLuckyBase")+this._GetValue("effectLuckyUpdata")*this._level))/1e3,this._runner.Properties.fare=i;break;case SkillEnum_s.Protect:i=Math.floor(10*(this._GetValue("effectInjuryFreeBase")+this._GetValue("effectInjuryFreeUpdata")*this._level))/1e3,this._runner.Properties.protect=i;break;case SkillEnum_s.Lucky:i=Math.floor(10*(this._GetValue("effectRealLuckyBase")+this._GetValue("effectRealLuckyUpdata")*this._level))/1e3,this._runner.Properties.lucky=i;break;case SkillEnum_s.Score:i=Math.floor(10*(this._GetValue("effectScoreBase")+this._GetValue("effectScoreUpdata")*this._level))/1e3,this._runner.Properties.score=i;break;case SkillEnum_s.Money:i=Math.floor(10*(this._GetValue("effectMoneyBase")+this._GetValue("effectMoneyUpdata")*this._level))/1e3,this._runner.Properties.money=i;break;case SkillEnum_s.Bonus:i=Math.floor(10*(this._GetValue("effectDropBase")+this._GetValue("effectDropUpdata")*this._level))/1e3,this._runner.Properties.bonus=i;break;case SkillEnum_s.Revive:i=Math.floor(this._GetValue("effectRebornBase")+Math.pow(this._GetValue("effectRebornUpdata")*(this._level-1),.8)),t.push(new ActionObj_s(ActionEnum_s.Revive,i));break;case SkillEnum_s.FlyBoat:var n=(this._GetValue("effectPlaneBase")+this._GetValue("effectPlaneUpdata")*this._level)/100;Math.random()<=n&&t.push(new ActionObj_s(ActionEnum_s.FlyBoat));break;case SkillEnum_s.Jump:i=this._GetValue("effectJumpBase")+Math.floor(this._GetValue("effectJumpUpdata")*this._level*this._role.MaxLife),t.push(new ActionObj_s(ActionEnum_s.Recover,i));break;case SkillEnum_s.Shield:this._duration<=0&&(i=Math.floor(this._GetValue("effectShieldBase")+this._GetValue("effectShieldUpdata")*this._level/100*this._role.MaxLife),this._durationValue=i,t.push(new ActionObj_s(ActionEnum_s.Shield,{duration:this._duration,value:i})));break;case SkillEnum_s.Action:var n=(this._GetValue("effectClearApBase")+this._GetValue("effectClearApUpdata")*this._level)/100;Math.random()<=n&&t.push(new ActionObj_s(ActionEnum_s.GetAction,1));break;case SkillEnum_s.FenShen:t.push(new ActionObj_s(ActionEnum_s.Release,{id:this._id,value:this._fenshen})),i=Math.floor(this._GetValue("effectFenShenBase")+this._GetValue("effectFenShenUpdata")*(this._level-1)+this._GetValue("effectFenShenLife")*this._role.MaxLife),this._oneFSDiKou=i,this._durationValue=i*this._fenshen,this._fsCount=this._fenshen,this._fsDikan>0&&(this._durationValue=Math.floor(this._durationValue*(1+this._fsDikan))),this._fsHuifu>0&&t.push(new ActionObj_s(ActionEnum_s.FSRecover,{value:this._fsHuifu*this._fsCount}));break;case SkillEnum_s.FenShenHuiFu:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(a.FenShenCount+=1,i=Math.floor((this._GetValue("effectFenShenRecoverBase")+this._GetValue("effectFenShenRecoverUpdata")*(this._level-1)+this._GetValue("effectFenShenRecoverLife")*this._role.MaxLife)/4/5),a.FenShenHuiFu=i);break;case SkillEnum_s.FenShenQiangHua:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(a.FenShenCount+=1,i=(this._GetValue("effectFenShenPlusBase")+this._GetValue("effectFenShenPlusUpdata")*(this._level-1))/100,a.FenShenDikan=i);break;case SkillEnum_s.ZhaoHuanXuZuo:i=this._GetValue("effectNinjaShieldBase")+this._GetValue("effectNinjaShieldUpdata")*(this._level-1)+this._GetValue("effectNinjaShieldLife")*this._role.MaxLife,this._durationValue=Math.floor(i),t.push(new ActionObj_s(ActionEnum_s.Release,{id:this._id,value:this._fenshen}));break;case SkillEnum_s.ChangeHurt:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(i=Math.floor(this._GetValue("effectNinjaShieldRecoverBase")+Math.pow(this._GetValue("effectNinjaShieldRecoverUpdata")*(this._level-1),.8))/100,a.HurtRecover=i);break;case SkillEnum_s.XiaoShiHuiFu:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(i=(this._GetValue("effectNinjaShieldRecoverExBase")+this._GetValue("effectNinjaShieldRecoverExUpdata")*this._level)/100,a.SkillEndRecover=i);break;case SkillEnum_s.ZhiHuoZaiSheng:var r=this._GetValue("effectNinjaRecoverBase"),o=this._GetValue("effectNinjaRecoverUpdata"),s=Math.floor(r+o*(this._level-1))/100,u=this._role.MaxLife;i=Math.floor(this._GetValue("effectNinjaRecoverFixedValue")+s*u),this.RecoverAdd>0?(i=Math.floor(i*(this.RecoverAdd+1)),t.push(new ActionObj_s(ActionEnum_s.Release,{id:this._id,isshow:!0}))):t.push(new ActionObj_s(ActionEnum_s.Release,{id:this._id,isshow:!1})),this.ItemRecover>0&&(this._role.SkillStatus=!0,this._role.ItemRecoverLife=Math.floor(this.ItemRecover*(1+this.RecoverAdd))),this._role.ImmuneHurt=this.ImmuneHurt,t.push(new ActionObj_s(ActionEnum_s.Recover,i));break;case SkillEnum_s.AllItemHuiFu:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(i=Math.floor(this._GetValue("effectNinjaItemRecoverBase")+this._GetValue("effectNinjaItemRecoverUpdata")*this._level/100*this._role.MaxLife),a.ItemRecover=i);break;case SkillEnum_s.AddHuiFu:var a=this._runner.GetSkill(this._affectSkill);null!=a&&(i=Math.floor(this._GetValue("effectNinjaRecoverPlusBase")+this._GetValue("effectNinjaRecoverPlusUpdata")*this._level)/100,a.RecoverAdd=i,a.ImmuneHurt=!0)}return t},e.prototype.CheckHurt=function(e){var t=[];if(this._duration>0&&this._durationValue>0){var i=Math.min(this._durationValue,e);if(SkillManager.HurtBlood=Math.max(SkillManager.HurtBlood-i,0),this._id==SkillEnum_s.ZhaoHuanXuZuo&&this._hurtRecover>0){var n=Math.floor(e*this._hurtRecover);t.push(new ActionObj_s(ActionEnum_s.HurtRecover,{id:this._id,value:n}))}this._durationValue=Math.max(this._durationValue-i,0);var a=this._fsCount;if(this._id==SkillEnum_s.FenShen&&(this._fsCount=Math.ceil(this._durationValue/this._oneFSDiKou),a-this._fsCount>0))for(var r=0;r<a-this._fsCount;r++)Game.Instance.clearOneSkillAni()}return t},e.prototype._GetValue=function(e){return GameConstData.GetValue(e)},Object.defineProperty(e.prototype,"Notify",{get:function(){return this._notify},enumerable:!0,configurable:!0}),e.prototype.Init=function(){this._duration=0,this._durationValue=0,this._maxTimes=0,this._params&&this._params.fenshencount&&(this._fenshen=this._params.fenshencount),this._params&&this._params.fshuifu&&(this._fsHuifu=this._params.fshuifu),this._params&&this._params.fsdikan&&(this._fsDikan=this._params.fsdikan)},e.prototype.Process=function(e){if(null==Game.Instance||!Game.Instance.IsGamePause){this._timer+=e;var t=1e3;if(this._timer>=t&&(this._timer-=1e3,this._cd>0&&(this._cd-=1),this._duration>0)){if(this._duration-=1,0==this._duration){this._durationValue=0;var i=this._SkillEnd();this._role.HandleAction({1:i})}this._id==SkillEnum_s.FenShen&&this._fsHuifu>0&&this._role.HandleAction({1:[new ActionObj_s(ActionEnum_s.FSRecover,{value:this._fsHuifu*this._fsCount})]})}if(this._duration>0&&this._durationValue<=0){this._duration=0,this._durationValue=0;var n=this._SkillEnd();n.length>0&&this._role.HandleAction({1:n})}}},e.prototype._SkillEnd=function(){var e=[];if(this._skillEndRecover>0){if(this._id==SkillEnum_s.ZhaoHuanXuZuo){var t=Math.floor(this._skillEndRecover*this._role.MaxLife);e.push(new ActionObj_s(ActionEnum_s.SkillEnd,{id:this._id,value:t}))}this._role.ItemRecoverLife=0}return this._role.SkillStatus=!1,this._role.ImmuneHurt=!1,Game.Instance.clearSkillAni(),e},Object.defineProperty(e.prototype,"FenShenCount",{get:function(){return this._fenshen},set:function(e){this._fenshen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FenShenDikan",{get:function(){return this._fsDikan},set:function(e){this._fsDikan=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FenShenHuiFu",{get:function(){return this._fsHuifu},set:function(e){this._fsHuifu=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AffectSkillID",{get:function(){return this._affectSkill},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillEndRecover",{get:function(){return this._skillEndRecover},set:function(e){this._skillEndRecover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HurtRecover",{get:function(){return this._hurtRecover},set:function(e){this._hurtRecover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RecoverAdd",{get:function(){return this._recoverAdd},set:function(e){this._recoverAdd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemRecover",{get:function(){return this._itemRecover},set:function(e){this._itemRecover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImmuneHurt",{get:function(){return this._immuneHurt},set:function(e){this._immuneHurt=e},enumerable:!0,configurable:!0}),e}();__reflect(SkillFunction_s.prototype,"SkillFunction_s");var SkillRunner_s=function(){function e(e){this._skillList=[],this._role=e,this.Properties={defense:0,life:0,fare:0,protect:0,lucky:0,score:0,money:0,bonus:0},this._InitSkill(),this.Notify(NotifyEnum_s.Start)}return e.prototype._InitSkill=function(){var e=this._role.UseSkillSet;if(null!=e&&0!=e.length){this._skillList=[];for(var t=0;t<e.length;t++){var i=e[t].ID;switch(i){case SkillEnum_s.Defense:case SkillEnum_s.Life:case SkillEnum_s.Fare:case SkillEnum_s.Protect:case SkillEnum_s.Lucky:case SkillEnum_s.Score:case SkillEnum_s.Money:case SkillEnum_s.Bonus:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Start,this,this._role,e[t].Level,{}));break;case SkillEnum_s.Revive:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Dead,this,this._role,e[t].Level,{max:1,value:.5}));break;case SkillEnum_s.FlyBoat:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Hurt,this,this._role,e[t].Level,{rate:1}));break;case SkillEnum_s.Jump:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Jump,this,this._role,e[t].Level,{threshold:5,cd:30}));break;case SkillEnum_s.Shield:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Hurt,this,this._role,e[t].Level,{rate:.3,duration:5}));break;case SkillEnum_s.Action:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Victory,this,this._role,e[t].Level,{rate:.3}));break;case SkillEnum_s.FenShen:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Release,this,this._role,e[t].Level,{duration:5,fenshencount:2,fshuifu:0,fsdikan:1}));break;case SkillEnum_s.FenShenHuiFu:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.FenShen}));break;case SkillEnum_s.FenShenQiangHua:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.FenShen}));break;case SkillEnum_s.ZhaoHuanXuZuo:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Release,this,this._role,e[t].Level,{duration:5}));break;case SkillEnum_s.ChangeHurt:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.ZhaoHuanXuZuo}));break;case SkillEnum_s.XiaoShiHuiFu:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.ZhaoHuanXuZuo}));break;case SkillEnum_s.ZhiHuoZaiSheng:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.Release,this,this._role,e[t].Level,{duration:5}));break;case SkillEnum_s.AllItemHuiFu:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.ZhiHuoZaiSheng}));break;case SkillEnum_s.AddHuiFu:this._skillList.push(new SkillFunction_s(i,NotifyEnum_s.GameInit,this,this._role,e[t].Level,{skill:SkillEnum_s.ZhiHuoZaiSheng}))}}}},e.prototype.Notify=function(e,t){void 0===t&&(t=null);var i={};if(this._skillList.filter(function(t){return t.Notify.Check(e)}).map(function(e){var n=e.Execute(t);n.length>0&&(i[e.ID]=n)}),e==NotifyEnum_s.Hurt)for(var n=0;n<this._skillList.length;n++)if(!this._skillList[n].Notify.Check(e)){var a=this._skillList[n].CheckHurt(t.value);a.length>0&&(i[this._skillList[n].ID]=a)}return i},e.prototype.GetSkill=function(e){for(var t=0;t<this._skillList.length;t++)if(this._skillList[t].ID==e)return this._skillList[t];return null},e.prototype.ReleaseSkill=function(e){for(var t={},i=0;i<this._skillList.length;i++)if(e==this._skillList[i].ID){t[this._skillList[i].ID]=this._skillList[i].Execute();break}return t},Object.defineProperty(e.prototype,"Role",{get:function(){return this._role},enumerable:!0,configurable:!0}),e.prototype.Init=function(){for(var e=0;e<this._skillList.length;e++)this._skillList[e].Init();this.Notify(NotifyEnum_s.Start),this.Notify(NotifyEnum_s.GameInit)},e.prototype.Process=function(e){for(var t=0;t<this._skillList.length;t++)this._skillList[t].Notify.Check(NotifyEnum_s.Release)&&this._skillList[t].Process(e)},e}();__reflect(SkillRunner_s.prototype,"SkillRunner_s");var Indicator_s=function(){function e(e){void 0===e&&(e=0),this._indecate=e?e:0}return Object.defineProperty(e.prototype,"Indicate",{get:function(){return this._indecate},set:function(e){this._indecate|=e},enumerable:!0,configurable:!0}),e.prototype.Check=function(e,t){return void 0===t&&(t=null),t&&(this._indecate=t),(this._indecate&e)==e},e}();__reflect(Indicator_s.prototype,"Indicator_s");var SkinCreateMgr=function(){function e(){}return e.CreateCheckBox=function(e,t,i){void 0===i&&(i="");var n='<?xml version="1.0" encoding="utf-8"?><e:Skin class="skins.CheckBoxSkin" states="up,down,disabled,upAndSelected,downAndSelected,disabledAndSelected" xmlns:e="http://ns.egret.com/eui">    <e:Group width="100%" height="100%">        <e:layout>            <e:HorizontalLayout verticalAlign="middle"/>        </e:layout><e:Image fillMode="scale" alpha="1" alpha.disabled="1" alpha.down="1" source="'+e+'" source.down="'+e+'" source.upAndSelected="'+t+'" source.downAndSelected="'+t+'" source.disabled="'+i+'" source.disabledAndSelected="'+i+'"/><e:Label id="labelDisplay" size="20" textColor="0x707070"                 textAlign="center" verticalAlign="middle"                 fontFamily="Tahoma"/>   </e:Group></e:Skin>',a=EXML.parse(n);return a},e.CreateRadioButton=function(e,t,i){void 0===i&&(i="");var n='<?xml version="1.0" encoding="utf-8"?><e:Skin class="skins.RadioButtonSkin" states="up,down,disabled,upAndSelected,downAndSelected,disabledAndSelected" xmlns:e="http://ns.egret.com/eui">    <e:Group width="100%" height="100%">        <e:layout>            <e:HorizontalLayout verticalAlign="middle"/>        </e:layout><e:Image fillMode="scale" alpha="1" alpha.disabled="1" alpha.down="1" source="'+t+'" source.down="'+t+'" source.upAndSelected="'+e+'" source.downAndSelected="'+e+'" source.disabled="'+i+'" source.disabledAndSelected="'+i+'"/><e:Label id="labelDisplay" size="20" textColor="0x707070"                 textAlign="center" verticalAlign="middle"                 fontFamily="Tahoma"/>   </e:Group></e:Skin>',a=EXML.parse(n);return a},e.CreateButton=function(e,t,i){void 0===i&&(i="");var n='<?xml version="1.0" encoding="utf-8" ?><e:Skin class="skins.ButtonSkin" states="up,down,disabled" minHeight="50" minWidth="100" xmlns:e="http://ns.egret.com/eui">  <e:Image width="100%" height="100%" scale9Grid="1,3,8,8" alpha.disabled="1" source.up="'+e+'" source.down="'+t+'" source.disabled="'+i+'"/> <e:Label id="labelDisplay" top="8" bottom="8" left="8" right="8" size="20" textColor="0xFFFFFF" verticalAlign="middle" textAlign="center"/> <e:Image id="iconDisplay" horizontalCenter="0" verticalCenter="0"/></e:Skin>',a=EXML.parse(n);return a},e}();__reflect(SkinCreateMgr.prototype,"SkinCreateMgr");var SlaveManager=function(){function e(){}return e.InitWatch=function(){ProcessManager.AddProcess(e._Process.bind(e)),Facade.instance().watch(e._ReceiveList,NetNumber.SlaveList),Facade.instance().watch(e._CatchReturn,NetNumber.SlaveCatch),Facade.instance().watch(e._ReceiveSlaveCatch,NetNumber.SlaveCatchEnd),Facade.instance().watch(e._EscapeReturn,NetNumber.SlaveEscape),Facade.instance().watch(e._ReceiveSlaveEscape,NetNumber.SlaveEscapeEnd),Facade.instance().watch(e._ReceiveSlaveRansom,NetNumber.SlaveRansom),Facade.instance().watch(e._ReceiveSlaveRelease,NetNumber.SlaveRelease),Facade.instance().watch(e.SlaveFawnWatch,NetNumber.SlaveFawnWatch)},e.SlaveFawnWatch=function(t){if(t.info.code==NetManager.SuccessCode){var i=(t.info.src,t.info.dst),n=t.info.time;if(UnitStatusMgr.IsMaster){for(var a=0;a<e._slaveSet.length;a++)if(e._slaveSet[a].openid==i){e._slaveSet[a].time=n,GameEvent.DispatchEvent(EventType.SlaveInfoChange);break}}else UnitStatusMgr.IsSlave&&(e.Master.time=n,GameEvent.DispatchEvent(EventType.SlaveInfoChange))}},e._CatchReturn=function(t){WindowManager.WaitPage().IsVisibled=!1;var i=t.info.code;if(i!=NetManager.SuccessCode)return void Main.AddDebug("抓捕消息错误，code="+i);WindowManager.SlaveCatchWindow().IsVisibled=!1;var n=t.info.gid;return CheckpointManager.CurrentCheckpointID=Math.max(n-1,1),CheckpointManager.IsCatch=!0,null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(e._OpenRoleSelect.bind(e)):void e._OpenRoleSelect()},e._OpenRoleSelect=function(){WindowManager.RoleSelectWindow().IsVisibled=!0},e._ReceiveSlaveRansom=function(t){WindowManager.WaitPage().IsVisibled=!1;var i=(t.type,t.info.src,t.info.dst);t.info.time;if(UnitManager.PlayerID==i)e._masterSet=[];else for(var n=0;n<e._slaveSet.length;n++)if(e._slaveSet[n].openid==i){e._slaveSet.splice(n,1);break}GameEvent.DispatchEvent(EventType.SlaveInfoChange),GameEvent.DispatchEvent(EventType.UserStatusChange)},e._ReceiveSlaveRelease=function(t){null!=WindowManager.WaitPage()&&(WindowManager.WaitPage().IsVisibled=!1);var i=(t.type,t.info.src,t.info.dst);t.info.time;if(UnitManager.PlayerID==i)e._masterSet=[];else for(var n=0;n<e._slaveSet.length;n++)if(e._slaveSet[n].openid==i){e._slaveSet.splice(n,1);var a=FriendManager.GetFriendByID(i);null!=a&&a.SetValue(256,!1);break}GameEvent.DispatchEvent(EventType.SlaveInfoChange),GameEvent.DispatchEvent(EventType.UserStatusChange)},e._ReceiveList=function(t){var i=t.info.master,n=t.info.slave;null!=i&&(e._masterSet=i),null!=n&&(e._slaveSet=n),GameEvent.DispatchEvent(EventType.UserStatusChange)},e._ReceiveSlaveCatch=function(t){WindowManager.WaitPage().IsVisibled=!1;var i=t.info.code,n=i==NetManager.SuccessCode,a=!0;if(n){var r=t.info.src,o=t.info.dst,s=t.info.time;if(r==UnitManager.PlayerID){var u={};u.openid=o,u.time=s,e._slaveSet.push(u),a=!0;var l=FriendManager.GetFriendByID(o);null!=l&&l.SetValue(256,!0)}else{var h={};h.openid=r,h.time=s,e._masterSet.push(h),e._slaveSet=[],a=!1;var l=FriendManager.GetFriendByID(o);null!=l&&l.SetValue(512,!0)}}if(GameEvent.DispatchEvent(EventType.SlaveInfoChange),a){var c=1;CheckpointManager.IsCatch&&(c=1,CheckpointManager.IsCatch=!1),WindowManager.StarWindow().IsVisibled=!0,Main.Instance.BattleEnd(),SoundManager.PlayBackgroundMusic(),WindowManager.SlaveEndWindow().ShowWindow(c,n)}else!Game.GameStatus&&null!=Game.Instance&&Main.Instance.GameLayer.contains(Game.Instance)&&(WindowManager.StarWindow().IsVisibled=!0,Main.Instance.BattleEnd());GameEvent.DispatchEvent(EventType.UserStatusChange)},e._EscapeReturn=function(t){WindowManager.WaitPage().IsVisibled=!1;var i=t.info.code;if(i!=NetManager.SuccessCode)return void Main.AddDebug("反抗消息错误，code="+i);var n=t.info.gid;return CheckpointManager.CurrentCheckpointID=Math.max(n-1,1),CheckpointManager.IsRunaway=!0,null==WindowManager.RoleSelectWindow()?void WindowManager.SetWindowFunction(e._OpenRoleSelect.bind(e)):void e._OpenRoleSelect()},e._ReceiveSlaveEscape=function(t){WindowManager.WaitPage().IsVisibled=!1;var i=t.info.code,n=i==NetManager.SuccessCode,a=!0;if(n){var r=t.info.src,o=t.info.dst;t.info.time;if(r==UnitManager.Player.ID){for(var s=0;s<e._slaveSet.length;s++)if(e._slaveSet[s].openid==o){e._slaveSet.splice(s,1);break}a=!1}else e._masterSet=[],a=!0;GameEvent.DispatchEvent(EventType.SlaveInfoChange)}if(a){var u=2;CheckpointManager.IsRunaway&&(u=2,CheckpointManager.IsRunaway=!1),WindowManager.StarWindow().IsVisibled=!0,Main.Instance.BattleEnd(),SoundManager.PlayBackgroundMusic(),WindowManager.SlaveEndWindow().ShowWindow(u,n)}else!Game.GameStatus&&null!=Game.Instance&&Main.Instance.GameLayer.contains(Game.Instance)&&(WindowManager.StarWindow().IsVisibled=!0,Main.Instance.BattleEnd());GameEvent.DispatchEvent(EventType.UserStatusChange)},Object.defineProperty(e,"Master",{get:function(){var t=null;return e._masterSet.length>0?e._masterSet[0]:t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SlaveList",{get:function(){return e._slaveSet},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CanCatch",{get:function(){var e=FrequencyManager.GetFrequency(5);return null==e?(Main.AddDebug("获取不到次数信息，type=5"),!1):e.Value<e.ExtValue+e.MaxValue},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CanEsvape",{get:function(){var e=FrequencyManager.GetFrequency(6);return null==e?(Main.AddDebug("获取不到次数信息，type=6"),!1):e.Value<e.ExtValue+e.MaxValue},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Level",{get:function(){for(var e=1,t=[50,35,20,5],i=[4,3,2,1],n=CheckpointManager.MaxCheckpointID,a=0;a<t.length;a++)if(n>=t[a]){e=i[a];break}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HasSpace",{get:function(){if(UnitStatusMgr.IsSlave)return!1;var t=e.Level,i=[2,4,6,8],n=i[t-1];return e._slaveSet.length<n?!0:!1},enumerable:!0,configurable:!0}),e._Process=function(t){e._timer+=t;var i=1e3,n=!1;if(e._timer>=i){e._timer-=i;for(var a=0;a<e._masterSet.length;a++)e._masterSet[a].time-=1,n=!0;for(var a=0;a<e._slaveSet.length;a++)e._slaveSet[a].time-=1,n=!0;n&&GameEvent.DispatchEvent(EventType.SlaveTimeChange)}},e}();SlaveManager._masterSet=[],SlaveManager._slaveSet=[],SlaveManager._timer=5,__reflect(SlaveManager.prototype,"SlaveManager");var SoundManager=function(){function e(){}return Object.defineProperty(e,"BattleBG_Music",{get:function(){return"diebg_music"+e.Music_Suffix},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Button_Music",{get:function(){return"button_music"+e.Music_Suffix},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Door_Music",{get:function(){return"door_music"+e.Music_Suffix},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Gold_Music",{get:function(){return"gold_music"+e.Music_Suffix},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BG_Music",{get:function(){return"bg_music"+e.Music_Suffix
},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FailBG_Music",{get:function(){return"failbg_music"+e.Music_Suffix},enumerable:!0,configurable:!0}),e.PlayMusic=function(t,i){if(void 0===i&&(i=1),!Main.IsPlayMusic)return null;if(!e._isPlayYinyue)return null;if((t!=e.BattleBG_Music||null==e._battleBgSoundC)&&!(t==e.BG_Music&&null!=e._bgSoundC||t==e.FailBG_Music&&null!=e._failBgSoundC)){var n=RES.getRes(t);return null==n?(Main.AddDebug("获取音效资源失败："+t),null):(t!=e.BattleBG_Music&&t!=e.BG_Music&&t!=e.FailBG_Music&&n.play(0,i),n)}},e.PlayBackgroundMusic=function(){if(ResReadyMgr.IsReady("startsound")){if(e._isPlayBG=!0,e._isPlayDieBG=!1,e._isPlayFailBG=!1,null!=e._battleBgSoundC&&e._battleBgSoundC.stop(),null!=e._failBgSoundC&&e._failBgSoundC.stop(),null!=e._bgSoundC&&e._bgSoundC.stop(),null!=e._bgSound)return e._bgSoundC=e._bgSound.play(0,0),void(e._bgSoundC.volume=e._isPlayBGYinyue?1:0);var t=e.PlayMusic(e.BG_Music,0);null!=t&&(e._bgSound=t,e._bgSoundC=t.play(0,0),e._bgSoundC.volume=e._isPlayBGYinyue?1:0)}},e.PlayBattleBGMusic=function(){if(e._isPlayBG=!1,e._isPlayDieBG=!0,e._isPlayFailBG=!1,null!=e._bgSoundC&&e._bgSoundC.stop(),null!=e._failBgSoundC&&e._failBgSoundC.stop(),null!=e._battleBgSoundC&&e._battleBgSoundC.stop(),null!=e._battleBgSound)return e._battleBgSoundC=e._battleBgSound.play(0,0),void(e._battleBgSoundC.volume=e._isPlayBGYinyue?1:0);var t=e.PlayMusic(e.BattleBG_Music,0);null!=t&&(e._battleBgSound=t,e._battleBgSoundC=t.play(0,0),e._battleBgSoundC.volume=e._isPlayBGYinyue?1:0)},e.PlayFailBGMusic=function(){if(e._isPlayBG=!1,e._isPlayDieBG=!1,e._isPlayFailBG=!0,null!=e._battleBgSoundC&&e._battleBgSoundC.stop(),null!=e._failBgSoundC&&e._failBgSoundC.stop(),null!=e._bgSoundC&&e._bgSoundC.stop(),null!=e._failBgSound)return e._failBgSoundC=e._failBgSound.play(0,0),void(e._failBgSoundC.volume=e._isPlayBGYinyue?1:0);var t=e.PlayMusic(e.FailBG_Music,0);null!=t&&(e._failBgSound=t,e._failBgSoundC=t.play(0,0),e._failBgSoundC.volume=e._isPlayBGYinyue?1:0)},e.PlayButtonMusic=function(){if(e._isPlayYinyue&&ResReadyMgr.IsReady("startsound")){e.PlayMusic(e.Button_Music)}},e.PlayGoldMusic=function(){if(e._isPlayYinyue){e.PlayMusic(e.Gold_Music)}},Object.defineProperty(e,"YinYue",{get:function(){return e._isPlayYinyue},set:function(t){e._isPlayYinyue!=t&&(e._isPlayYinyue=t,e._isPlayBGYinyue=t,null!=e._bgSoundC&&(t?(e._isPlayBG&&(e._bgSoundC.volume=1),null!=e._battleBgSoundC&&e._isPlayDieBG&&(e._battleBgSoundC.volume=1),null!=e._failBgSoundC&&e._isPlayFailBG&&(e._failBgSoundC.volume=1)):(e._isPlayBG&&(e._bgSoundC.volume=0),null!=e._battleBgSoundC&&e._isPlayDieBG&&(e._battleBgSoundC.volume=0),null!=e._failBgSoundC&&e._isPlayFailBG&&(e._failBgSoundC.volume=0))))},enumerable:!0,configurable:!0}),e}();SoundManager.Music_Suffix="_mp3",SoundManager._isPlayBG=!1,SoundManager._isPlayDieBG=!1,SoundManager._isPlayFailBG=!1,SoundManager._isPlayYinyue=!1,SoundManager._isPlayBGYinyue=!1,__reflect(SoundManager.prototype,"SoundManager");var StringMgr=function(){function e(){}return Object.defineProperty(e,"Language",{get:function(){return e._type},set:function(t){e._type!=t&&(e._data=null,e._type=t,e._JsonData,GameEvent.DispatchEvent(EventType.LanguageChange))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LanguageSuffix",{get:function(){var t="_"+e.Language;return e.Language!=e.EN&&(t=""),t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"_JsonData",{get:function(){return null==e._data&&(e._data=RES.getRes("textcfg_"+e._type+"_json")),e._data},enumerable:!0,configurable:!0}),e.GetText=function(t){var i=e._JsonData[t];return null!=i?i.text:""},e}();StringMgr.CN="cn",StringMgr.TCN="tcn",StringMgr.EN="en",StringMgr._type=StringMgr.CN,__reflect(StringMgr.prototype,"StringMgr");var WeatherManager=function(){function e(){}return e.Start=function(t,i,n){if(void 0===i&&(i=-1),void 0===n&&(n=200),!e.IsPlayParticle){var a=RES.getRes(t+"_png"),r=RES.getRes(t+"_json");r.maxParticles=n,e._particleSys=new particle.GravityParticleSystem(a,r),e._particleSys.addEventListener(egret.Event.COMPLETE,e.Stop,e),Game.Instance.WeatherLayer.addChild(e._particleSys),e._particleSys.start(i)}},e.Stop=function(){null!=e._particleSys&&(Game.Instance.WeatherLayer.removeChild(e._particleSys),e._particleSys=null)},Object.defineProperty(e,"IsPlayParticle",{get:function(){return null!=e._particleSys},enumerable:!0,configurable:!0}),e}();WeatherManager.Snow="snow",WeatherManager.Rain="rain",__reflect(WeatherManager.prototype,"WeatherManager");var WindowManager=function(){function e(){}return e.Init=function(){ProcessManager.AddProcess(e._Process)},e.StarWindow=function(){return null==e._starWindow&&(e._starWindow=new StarWindow),e._starWindow},e.EndWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("endwindow")?(null==e._endWindow&&(e._endWindow=new EndWindow),e._endWindow):(t&&(e._currentOpenWindow=e.EndWindow),null)},e.CenterPromptPage=function(){return ResReadyMgr.IsReady("prompt")?(null==e._centerPromptPage&&(e._centerPromptPage=new CenterPromptPage),e._centerPromptPage):(e._currentOpenWindow=e.CenterPromptPage,null)},e.ShopBuyPage=function(){return ResReadyMgr.IsReady("prompt")?(null==e._shopBuyPage&&(e._shopBuyPage=new ShopBuyPage),e._shopBuyPage):(e._currentOpenWindow=e.ShopBuyPage,null)},e.TopPromptPage=function(){return ResReadyMgr.IsReady("prompt")?(null==e._topPromptPage&&(e._topPromptPage=new TopPromptPage),e._topPromptPage):(e._currentOpenWindow=e.TopPromptPage,null)},e.GamePromptPage=function(){return ResReadyMgr.IsReady("game")?(null==e._gamePromptPage&&(e._gamePromptPage=new CheckpointTip),e._gamePromptPage):(e._currentOpenWindow=e.GamePromptPage,null)},e.ShopWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("shopwindow")?(null==e._shopWindow&&(e._shopWindow=new ShopWindow),e._shopWindow):(t&&(e._currentOpenWindow=e.ShopWindow),null)},e.RankWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("rankwindow")?(null==e._rankWindow&&(e._rankWindow=new RankWindow),e._rankWindow):(t&&(e._currentOpenWindow=e.RankWindow),null)},e.ReviveWindow=function(){return null==e._reviveWindow&&(e._reviveWindow=new ReviveWindow),e._reviveWindow},e.SuccFailWindow=function(){return ResReadyMgr.IsReady("game")?(null==e._succFailWindow&&(e._succFailWindow=new SuccFailPage),e._succFailWindow):(e._currentOpenWindow=e.SuccFailWindow,null)},e.GetItemTip=function(){return ResReadyMgr.IsReady("prompt")?(null==e._getItemTip&&(e._getItemTip=new GetItemTip),e._getItemTip):(e._currentOpenWindow=e.GetItemTip,null)},e.WaitPage=function(){return null==e._waitPage&&(e._waitPage=new WaitPage),e._waitPage},e.RoleGetPage=function(){return ResReadyMgr.IsReady("rolewindow")?(null==e._roleGetPage&&(e._roleGetPage=new RoleGetWindow),e._roleGetPage):(e._currentOpenWindow=e.RoleGetPage,null)},e.AchievementWindow=function(){return ResReadyMgr.IsReady("achievemenwindow")?(null==e._achievementWindow&&(e._achievementWindow=new AchievementWindow),e._achievementWindow):(e._currentOpenWindow=e.AchievementWindow,null)},e.AchievementTip=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("achievemenwindow")?(null==e._achievementTip&&(e._achievementTip=new AchievementTip),e._achievementTip):(t&&(e._currentOpenWindow=e.AchievementTip),null)},e.AchievementDetailPage=function(){return ResReadyMgr.IsReady("achievemenwindow")?(null==e._achievementDetailPage&&(e._achievementDetailPage=new AchievementDetailPage),e._achievementDetailPage):(e._currentOpenWindow=e.AchievementDetailPage,null)},e.NoticeWindow=function(){return ResReadyMgr.IsReady("noticewindow")?(null==e._noticeWindow&&(e._noticeWindow=new NoticePage),e._noticeWindow):(e._currentOpenWindow=e.NoticeWindow,null)},e.FriendWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("friendwindow")?(null==e._friendWindow&&(e._friendWindow=new FriendPage),e._friendWindow):(t&&(e._currentOpenWindow=e.FriendWindow),null)},e.RoleWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("rolewindow")?(null==e._roleWindow&&(e._roleWindow=new RolePage),e._roleWindow):(t&&(e._currentOpenWindow=e.RoleWindow),null)},e.RoleDetailWindow=function(){return null==e._roleDetailPage&&(e._roleDetailPage=new RoleDetail),e._roleDetailPage},e.NoticeDetailWindow=function(){return null==e._noticeDetailPage&&(e._noticeDetailPage=new NoticeDetailPage),e._noticeDetailPage},e.RollingNoticeWindow=function(){return null==e._rollingNoticeWindow&&(e._rollingNoticeWindow=new RollingNoticeWindow),e._rollingNoticeWindow},e.GameUI=function(){return null==e._gameUI&&(e._gameUI=new GameUI),e._gameUI},e.RoleSelectWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("roleselect")?(null==e._roleSelectWindow&&(e._roleSelectWindow=new RoleSelectWindow),e._roleSelectWindow):(t&&(e._currentOpenWindow=e.RoleSelectWindow),null)},e.RaidEndWindow=function(){return ResReadyMgr.IsReady("raidendwindow")?(null==e._raidEndWindow&&(e._raidEndWindow=new RaidEndWindow),e._raidEndWindow):(e._currentOpenWindow=e.RaidEndWindow,null)},e.GuideWindow=function(){return ResReadyMgr.IsReady("guidewindow")?(null==e._guideWindow&&(e._guideWindow=new GuideWindow),e._guideWindow):(-1==e._waitWindowSet.indexOf(e.GuideWindow)&&e._waitWindowSet.push(e.GuideWindow),null)},e.VIPWindow=function(){return ResReadyMgr.IsReady("vipwindow")?(null==e._vipWindow&&(e._vipWindow=new VIPWindow),e._vipWindow):(e._currentOpenWindow=e.VIPWindow,null)},e.DailyActiveYuReWindow=function(){return ResReadyMgr.IsReady("dailyactive")?(null==e._dailyActiveYuReWindow&&(e._dailyActiveYuReWindow=new DailyActiveYuReWindow),e._dailyActiveYuReWindow):(e._currentOpenWindow=e.DailyActiveYuReWindow,null)},e.DailyActiveRewardTip=function(){return ResReadyMgr.IsReady("prompt")?(null==e._dailyActiveRewardTip&&(e._dailyActiveRewardTip=new DailyActiveRewardTip),e._dailyActiveRewardTip):(e._currentOpenWindow=e.DailyActiveRewardTip,null)},e.DailyActiveStartWindow=function(){return ResReadyMgr.IsReady("dailyactive")?(null==e._dailyActivestartWindow&&(e._dailyActivestartWindow=new DailyActiveStartWindow),e._dailyActivestartWindow):(e._currentOpenWindow=e.DailyActiveStartWindow,null)},e.DailyActiveRankWindow=function(){return ResReadyMgr.IsReady("prompt")?(null==e._dailyActiveRankWindow&&(e._dailyActiveRankWindow=new DailyActiveRankWindow),e._dailyActiveRankWindow):(e._currentOpenWindow=e.DailyActiveRankWindow,null)},e.IntegralWindow=function(){return ResReadyMgr.IsReady("integralwindow")?(null==e._integralWindow&&(e._integralWindow=new IntegralWindow),e._integralWindow):(e._currentOpenWindow=e.IntegralWindow,null)},e.IntegralRuleWindow=function(){return ResReadyMgr.IsReady("prompt")?(null==e._integralRuleWindow&&(e._integralRuleWindow=new IntegralRuleWindow),e._integralRuleWindow):(e._currentOpenWindow=e.IntegralRuleWindow,null)},e.GiftWindow=function(){return ResReadyMgr.IsReady("giftwindow")?(null==e._giftWindow&&(e._giftWindow=new GiftWindow),e._giftWindow):(-1==e._waitWindowSet.indexOf(e.GiftWindow)&&e._waitWindowSet.push(e.GiftWindow),null)},e.PlayGiftWindow=function(){return ResReadyMgr.IsReady("giftwindow")?(null==e._playGiftWindow&&(e._playGiftWindow=new PlayGiftWindow),e._playGiftWindow):(-1==e._waitWindowSet.indexOf(e.PlayGiftWindow)&&e._waitWindowSet.push(e.PlayGiftWindow),null)},e.BagWindow=function(){return ResReadyMgr.IsReady("bagwindow")?(null==e._bagWindow&&(e._bagWindow=new BagWindow),e._bagWindow):(e._currentOpenWindow=e.BagWindow,null)},e.UseItemTip=function(){return null==e._useItemTip&&(e._useItemTip=new UseItemTip),e._useItemTip},e.SlaveWindow=function(t){return void 0===t&&(t=!0),ResReadyMgr.IsReady("slavewindow")?(null==e._slaveWindow&&(e._slaveWindow=new SlaveWindow),e._slaveWindow):(t&&(e._currentOpenWindow=e.SlaveWindow),null)},e.SlaveCatchWindow=function(){return null==e._slaveCatchWindow&&(e._slaveCatchWindow=new SlaveCatchWindow),e._slaveCatchWindow},e.SlaveEndWindow=function(){return null==e._slaveEndWindow&&(e._slaveEndWindow=new SlaveEndWindow),e._slaveEndWindow},e.SlaveHDWindow=function(){return ResReadyMgr.IsReady("slavewindow")?(null==e._slaveHDWindow&&(e._slaveHDWindow=new SlaveHDWindow),e._slaveHDWindow):null},e.FirstChargeWindow=function(){return ResReadyMgr.IsReady("vipwindow")?(null==e._firstChargeWindow&&(e._firstChargeWindow=new FirstChargeWindow),e._firstChargeWindow):(e._currentOpenWindow=e.FirstChargeWindow,null)},e.KeepRewardTip=function(){return null==e._keepRewardTip&&(e._keepRewardTip=new KeepRewardTip),e._currentOpenWindow=e.KeepRewardTip,e._keepRewardTip},e.GuoQingActiveWindow=function(){return ResReadyMgr.IsReady("active")?(null==e._guoqingActiveWindow&&(e._guoqingActiveWindow=new GuoQingActiveWindow),e._guoqingActiveWindow):(e._currentOpenWindow=e.GuoQingActiveWindow,null)},e.GuoQingSceneWindow=function(){return ResReadyMgr.IsReady("active")?(null==e._guoqingSceneWindow&&(e._guoqingSceneWindow=new GuoQingSceneWindow),e._guoqingSceneWindow):(e._currentOpenWindow=e.GuoQingSceneWindow,null)},e.ActiveBonusWindow=function(){return ResReadyMgr.IsReady("giftwindow")?(null==e._activeBonusWindow&&(e._activeBonusWindow=new ActiveBonusWindow),e._activeBonusWindow):(-1==e._waitWindowSet.indexOf(e.ActiveBonusWindow)&&e._waitWindowSet.push(e.ActiveBonusWindow),null)},e.SetWindow=function(){return ResReadyMgr.IsReady("setwindow")?(null==e._setWindow&&(e._setWindow=new SetWindow),e._setWindow):(e._currentOpenWindow=e.SetWindow,null)},e.SetWindowFunction=function(t,i,n){void 0===i&&(i=null),void 0===n&&(n=null),null==n?(e._windowCompleteFunction=t,e._functionParamSet=i):(e.WaitPage().IsVisibled=!0,e._completedFunSet[n]=t,e._paramSet[n]=i)},e.ResLoadEnd=function(){for(var t=0;t<e._waitWindowSet.length;t++)if(null!=e._waitWindowSet[t]()){var i=e._waitWindowSet[t],n=e._completedFunSet[i],a=e._paramSet[i];null!=n&&(n(a),delete e._completedFunSet[i]),null!=a&&delete e._paramSet[i],e._waitWindowSet.splice(t,1),t-=1}0==e._waitWindowSet.length&&null==e._currentOpenWindow&&(e.WaitPage().IsVisibled=!1)},e._Process=function(t){null!=e._currentOpenWindow&&(null!=e._currentOpenWindow()?(null!=e._windowCompleteFunction&&(e._windowCompleteFunction(e._functionParamSet),e._windowCompleteFunction=null,e._functionParamSet=null),e._currentOpenWindow=null,null==e._currentOpenWindow&&0==e._waitWindowSet.length&&(e.WaitPage().IsVisibled=!1)):(!e.WaitPage().IsVisibled,e.WaitPage().IsVisibled=!0))},e}();WindowManager._currentOpenWindow=null,WindowManager._completedFunSet=[],WindowManager._paramSet=[],WindowManager._waitWindowSet=[],__reflect(WindowManager.prototype,"WindowManager");